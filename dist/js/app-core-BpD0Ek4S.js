const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/pages-B-uaxJKn.js","js/vendor-react-CCyPXtHz.js","js/vendor-misc-C4KpkjDR.js","js/vendor-db-CTXq6Blq.js","js/components-product-rc1WqevH.js","js/vendor-animations-DmABdwqh.js","js/components-home-JfmSOzua.js","js/components-dashboard-C4LaA3BR.js"])))=>i.map(i=>d[i]);
var e,t=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(e,s,r)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,l=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&n(e,s,t[s]);if(i)for(var s of i(t))o.call(t,s)&&n(e,s,t[s]);return e},c=(e,t)=>s(e,r(t)),d=(e,t)=>{var s={};for(var r in e)a.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&o.call(e,r)&&(s[r]=e[r]);return s},u=(e,t,s)=>n(e,"symbol"!=typeof t?t+"":t,s),m=(e,t,s)=>new Promise((r,i)=>{var a=e=>{try{n(s.next(e))}catch(t){i(t)}},o=e=>{try{n(s.throw(e))}catch(t){i(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);n((s=s.apply(e,t)).next())});import{r as h,j as p,A as g,X as f,M as y,H as w,S as b,B as v,a as x,G as k,L as j,b as S,C,c as E,d as N,E as P,e as A,U as I,P as D,f as R,g as T,h as q,F as M,i as _,I as O,T as B,k as F,l as L,m as U,R as $}from"./vendor-react-CCyPXtHz.js";import{s as z,a as V,g as H,c as W,u as Q,r as J,b as G,d as Y,e as Z,f as K,h as X,i as ee,j as te,k as se,l as re,m as ie,n as ae,o as oe,p as ne,q as le,t as ce,v as de,w as ue,x as me}from"./vendor-db-CTXq6Blq.js";const he={},pe=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),i=(null==s?void 0:s.nonce)||(null==s?void 0:s.getAttribute("nonce"));r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in he)return;he[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,i&&r.setAttribute("nonce",i),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})},ge=h.createContext(void 0),fe=()=>{const e=h.useContext(ge);if(!e)throw new Error("useError must be used within an ErrorProvider");return e},ye=({children:e})=>{const[t,s]=h.useState(null);return p.jsx(ge.Provider,{value:{error:t,setError:s,clearError:()=>s(null)},children:e})};class we extends Error{constructor(e,t,s,r){super(t),this.code=e,this.details=s,this.originalError=r,this.name="AppError"}}class be extends we{constructor(e,t){super("VALIDATION_ERROR",e,t),this.name="ValidationError"}}class ve extends we{constructor(e,t,s){super("DATABASE_ERROR",e,t,s),this.name="DatabaseError"}}class xe extends we{constructor(e,t,s){super("NETWORK_ERROR",e,t,s),this.name="NetworkError"}}class ke extends we{constructor(e,t){super("AUTHENTICATION_ERROR",e,t),this.name="AuthenticationError"}}class je{static handle(e){return e instanceof we?e:"ValidationError"===e.name?new be(e.message,e.details):"DatabaseError"===e.name||"PostgrestError"===e.name?new ve(e.message,e.details,e):"NetworkError"===e.name||"FetchError"===e.name?new xe(e.message,e.details,e):"AuthError"===e.name?new ke(e.message,e.details):new we("INTERNAL_ERROR",e.message||"An unexpected error occurred",void 0,e)}static formatError(e){return{success:!1,error:{code:e.code,message:e.message,details:e.details}}}}class Se{static required(e,t){const s=t.filter(t=>{const s=this.getNestedValue(e,t);return null==s||""===s});if(s.length>0)throw new be(`Required fields missing: ${s.join(", ")}`,{missingFields:s})}static email(e){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))throw new be("Invalid email format",{email:e})}static positiveNumber(e,t){if("number"!=typeof e||e<=0)throw new be(`${t} must be a positive number`,{fieldName:t,value:e})}static nonNegativeNumber(e,t){if("number"!=typeof e||e<0)throw new be(`${t} must be a non-negative number`,{fieldName:t,value:e})}static stringLength(e,t,s,r){if(void 0!==s&&e.length<s)throw new be(`${t} must be at least ${s} characters long`,{fieldName:t,value:e,min:s});if(void 0!==r&&e.length>r)throw new be(`${t} must be no more than ${r} characters long`,{fieldName:t,value:e,max:r})}static url(e){try{new URL(e)}catch(t){throw new be("Invalid URL format",{url:e})}}static arrayMinLength(e,t,s){if(!Array.isArray(e)||e.length<s)throw new be(`${t} must have at least ${s} items`,{fieldName:t,arrayLength:null==e?void 0:e.length,minLength:s})}static enumValue(e,t,s){if(!s.includes(e))throw new be(`${t} must be one of: ${s.join(", ")}`,{fieldName:t,value:e,validValues:s})}static getNestedValue(e,t){return t.split(".").reduce((e,t)=>null==e?void 0:e[t],e)}}function Ce(e){if(!e||!e.message)return!1;const t=e.message.toLowerCase();return["infinite recursion","recursive reference","row-level security policy","rls recursion","policy recursion"].some(e=>t.includes(e))}class Ee{constructor(){u(this,"supabase",z)}handleError(e,t){throw je.handle(e)}validateRequired(e,t){Se.required(e,t)}validateEmail(e){Se.email(e)}validatePositiveNumber(e,t){Se.positiveNumber(e,t)}validateNonNegativeNumber(e,t){Se.nonNegativeNumber(e,t)}generateSlug(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}getCurrentUser(){return m(this,null,function*(){const{data:{user:e},error:t}=yield this.supabase.auth.getUser();if(t)throw t;return e})}formatImagesForDB(e){return Array.isArray(e)?e:"string"==typeof e?[e]:[]}formatImagesFromDB(e){return Array.isArray(e)?e:"string"==typeof e?[e]:[]}}const Ne=new Map,Pe=3e5,Ae=100;class Ie{static get(e){const t=Ne.get(e);return t?Date.now()-t.timestamp>t.ttl?(Ne.delete(e),null):t.data:null}static set(e,t,s=Pe){if(this.cleanup(),Ne.set(e,{data:t,timestamp:Date.now(),ttl:s}),Ne.size>Ae){const e=Array.from(Ne.entries()).sort((e,t)=>e[1].timestamp-t[1].timestamp);for(;Ne.size>Ae;)Ne.delete(e.shift()[0])}}static delete(e){Ne.delete(e)}static clear(){Ne.clear()}static cleanup(){const e=Date.now();for(const[t,s]of Ne.entries())e-s.timestamp>s.ttl&&Ne.delete(t)}static invalidatePattern(e){const t=[],s=e.replace(/\*/g,".*"),r=new RegExp(`^${s}$`);for(const i of Ne.keys())r.test(i)&&t.push(i);t.forEach(e=>Ne.delete(e))}}class De{static invalidateProducts(){Ie.invalidatePattern("products*"),Ie.invalidatePattern("featured_products*");try{Object.keys(sessionStorage).forEach(e=>{(e.startsWith(this.PREFIX+"products:")||e.startsWith(this.PREFIX+"featured_products"))&&sessionStorage.removeItem(e)})}catch(e){}}static invalidateProduct(e){Ie.invalidatePattern(`products:${e}`),Ie.invalidatePattern("featured_products*");try{Object.keys(sessionStorage).forEach(t=>{(t.startsWith(this.PREFIX+"products:")&&t.includes(e)||t.startsWith(this.PREFIX+"featured_products"))&&sessionStorage.removeItem(t)})}catch(t){}}static invalidateCategories(){Ie.invalidatePattern("categories*");try{Object.keys(sessionStorage).forEach(e=>{e.startsWith(this.PREFIX+"categories:")&&sessionStorage.removeItem(e)})}catch(e){}}static invalidateCategory(e){Ie.invalidatePattern(`categories:${e}`);try{Object.keys(sessionStorage).forEach(t=>{t.startsWith(this.PREFIX+"categories:")&&t.includes(e)&&sessionStorage.removeItem(t)})}catch(t){}}static invalidateOrders(){Ie.invalidatePattern("orders*");try{Object.keys(sessionStorage).forEach(e=>{e.startsWith(this.PREFIX+"orders:")&&sessionStorage.removeItem(e)})}catch(e){}}static invalidateOrder(e){Ie.invalidatePattern(`orders:${e}`);try{Object.keys(sessionStorage).forEach(t=>{t.startsWith(this.PREFIX+"orders:")&&t.includes(e)&&sessionStorage.removeItem(t)})}catch(t){}}static invalidateUsers(){Ie.invalidatePattern("users*");try{Object.keys(sessionStorage).forEach(e=>{e.startsWith(this.PREFIX+"users:")&&sessionStorage.removeItem(e)})}catch(e){}}static invalidateUser(e){Ie.invalidatePattern(`users:${e}`);try{Object.keys(sessionStorage).forEach(t=>{t.startsWith(this.PREFIX+"users:")&&t.includes(e)&&sessionStorage.removeItem(t)})}catch(t){}}}u(De,"PREFIX","perfume_cache_");const Re=({isOpen:e,onClose:t,initialMode:s="login"})=>{const[r,i]=h.useState(s),[a,o]=h.useState(!1),[n,d]=h.useState(!1),[u,O]=h.useState(!1),[B,F]=h.useState(1),[L,U]=h.useState(!1),{user:$,signIn:z,signUp:V,logout:H}=Me(),[W,Q]=h.useState({email:"",password:"",confirmPassword:"",fullName:"",phone:"",dateOfBirth:""}),[J,G]=h.useState({}),Y=(e,t)=>{Q(s=>c(l({},s),{[e]:t})),J[e]&&G(t=>c(l({},t),{[e]:""}))};return e?p.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999},children:[p.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t,style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)"}}),p.jsxs("div",{className:"absolute inset-0 bg-white flex flex-col",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"white",display:"flex",flexDirection:"column"},children:[p.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:["login"!==r&&"profile"!==r&&p.jsx("button",{onClick:()=>{"signup"===r&&2===B?F(1):i("login")},className:"p-2 rounded-full hover:bg-white hover:bg-opacity-20",children:p.jsx(g,{className:"h-6 w-6"})}),p.jsx("div",{className:"flex-1 text-center",children:p.jsxs("h2",{className:"text-xl font-bold",children:["login"===r&&"Welcome to Aligarh Attar House","signup"===r&&(1===B?"Create Account":"Complete Profile"),"forgot"===r&&"Reset Password","verify"===r&&"Verify Email","profile"===r&&"My Account"]})}),p.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-white hover:bg-opacity-20",children:p.jsx(f,{className:"h-6 w-6"})})]})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:"verify"===r?p.jsxs("div",{className:"text-center space-y-6 py-8",children:[p.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:p.jsx(y,{className:"h-10 w-10 text-green-600"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Verification Email Sent"}),p.jsxs("p",{className:"text-gray-600 mt-2",children:["We've sent a verification link to ",p.jsx("strong",{children:W.email})]}),p.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Didn't receive the email? Check your spam folder or"," ",p.jsx("button",{className:"text-indigo-600 hover:text-indigo-700 font-medium",children:"resend verification email"})]})]}),p.jsx("button",{onClick:()=>i("login"),className:"w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Back to Login"})]}):"profile"===r&&$?p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-6 text-center",children:[p.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx("span",{className:"text-2xl font-bold text-white",children:$.name.charAt(0)})}),p.jsx("h3",{className:"text-xl font-bold text-gray-900",children:$.name}),p.jsx("p",{className:"text-gray-600",children:$.email}),p.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full capitalize",children:$.role})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[p.jsxs("button",{className:"flex flex-col items-center p-4 bg-white rounded-xl shadow-sm border border-gray-100",children:[p.jsx(w,{className:"h-6 w-6 text-red-500 mb-2"}),p.jsx("span",{className:"text-xs text-gray-700",children:"Wishlist"})]}),p.jsxs("button",{className:"flex flex-col items-center p-4 bg-white rounded-xl shadow-sm border border-gray-100",children:[p.jsx(b,{className:"h-6 w-6 text-green-500 mb-2"}),p.jsx("span",{className:"text-xs text-gray-700",children:"Cart"})]}),p.jsxs("button",{className:"flex flex-col items-center p-4 bg-white rounded-xl shadow-sm border border-gray-100",children:[p.jsx(v,{className:"h-6 w-6 text-blue-500 mb-2"}),p.jsx("span",{className:"text-xs text-gray-700",children:"Notifications"})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("button",{className:"w-full flex items-center p-4 bg-white rounded-xl shadow-sm border border-gray-100",children:[p.jsx(x,{className:"h-5 w-5 text-gray-500 mr-3"}),p.jsx("span",{className:"text-gray-700",children:"Account Settings"})]}),p.jsxs("button",{className:"w-full flex items-center p-4 bg-white rounded-xl shadow-sm border border-gray-100",children:[p.jsx(k,{className:"h-5 w-5 text-gray-500 mr-3"}),p.jsx("span",{className:"text-gray-700",children:"My Orders"})]}),p.jsxs("button",{onClick:H,className:"w-full flex items-center p-4 bg-white rounded-xl shadow-sm border border-gray-100 text-red-600",children:[p.jsx(j,{className:"h-5 w-5 mr-3"}),p.jsx("span",{children:"Sign Out"})]})]})]}):p.jsxs("form",{onSubmit:e=>m(null,null,function*(){if(e.preventDefault(),(()=>{const e={};var t;return W.email?(t=W.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||(e.email="Please enter a valid email")):e.email="Email is required",W.password?W.password.length>=8||(e.password="Password must be at least 8 characters"):e.password="Password is required","signup"===r&&1===B&&W.password!==W.confirmPassword&&(e.confirmPassword="Passwords do not match"),"signup"!==r||2!==B||W.fullName.trim()||(e.fullName="Full name is required"),G(e),0===Object.keys(e).length})()){O(!0);try{"login"===r?(yield z(W.email,W.password),t()):"signup"===r&&(1===B?F(2):(yield V(W.email,W.password,{fullName:W.fullName,phone:W.phone,dateOfBirth:W.dateOfBirth}),i("verify")))}catch(s){G({general:"Authentication failed. Please try again."})}finally{O(!1)}}}),className:"space-y-5",children:[("login"===r||"signup"===r&&1===B)&&p.jsxs("div",{className:"text-center mb-2",children:[p.jsxs("div",{className:"inline-flex items-center justify-center space-x-2 bg-gradient-to-r from-purple-100 to-indigo-100 rounded-full px-4 py-2 mb-3",children:[p.jsx(S,{className:"h-4 w-4 text-purple-600"}),p.jsx("span",{className:"text-xs font-semibold text-purple-800",children:"Premium Attar Collection"}),p.jsx(C,{className:"h-4 w-4 text-amber-500"})]}),p.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"login"===r?"Sign in to discover premium attars":"Join our community of fragrance lovers"})]}),J.general&&p.jsxs("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg text-sm flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-2 flex-shrink-0"}),J.general]}),("login"===r||"forgot"===r||"signup"===r&&1===B)&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),p.jsxs("div",{className:"relative",children:[p.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),p.jsx("input",{type:"email",value:W.email,onChange:e=>Y("email",e.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 "+(J.email?"border-red-300":"border-gray-300"),placeholder:"Enter your email",disabled:u})]}),J.email&&p.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),J.email]})]}),("login"===r||"forgot"===r||"signup"===r&&1===B)&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),p.jsxs("div",{className:"relative",children:[p.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),p.jsx("input",{type:a?"text":"password",value:W.password,onChange:e=>Y("password",e.target.value),className:"w-full pl-10 pr-12 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 "+(J.password?"border-red-300":"border-gray-300"),placeholder:"Enter your password",disabled:u}),p.jsx("button",{type:"button",onClick:()=>o(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?p.jsx(P,{className:"h-5 w-5"}):p.jsx(A,{className:"h-5 w-5"})})]}),J.password&&p.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),J.password]})]}),"signup"===r&&1===B&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),p.jsxs("div",{className:"relative",children:[p.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),p.jsx("input",{type:n?"text":"password",value:W.confirmPassword,onChange:e=>Y("confirmPassword",e.target.value),className:"w-full pl-10 pr-12 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 "+(J.confirmPassword?"border-red-300":"border-gray-300"),placeholder:"Confirm your password",disabled:u}),p.jsx("button",{type:"button",onClick:()=>d(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?p.jsx(P,{className:"h-5 w-5"}):p.jsx(A,{className:"h-5 w-5"})})]}),J.confirmPassword&&p.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),J.confirmPassword]})]}),"signup"===r&&2===B&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),p.jsxs("div",{className:"relative",children:[p.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),p.jsx("input",{type:"text",value:W.fullName,onChange:e=>Y("fullName",e.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 "+(J.fullName?"border-red-300":"border-gray-300"),placeholder:"Enter your full name",disabled:u})]}),J.fullName&&p.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),J.fullName]})]}),"signup"===r&&2===B&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),p.jsxs("div",{className:"relative",children:[p.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),p.jsx("input",{type:"tel",value:W.phone,onChange:e=>Y("phone",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter your phone number",disabled:u})]})]}),"signup"===r&&2===B&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),p.jsxs("div",{className:"relative",children:[p.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),p.jsx("input",{type:"date",value:W.dateOfBirth,onChange:e=>Y("dateOfBirth",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",disabled:u})]})]}),"login"===r&&p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("input",{id:"remember-me-mobile",name:"remember-me-mobile",type:"checkbox",checked:L,onChange:e=>U(e.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",disabled:u}),p.jsx("label",{htmlFor:"remember-me-mobile",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),p.jsx("button",{type:"button",onClick:()=>i("forgot"),className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Forgot?"})]}),p.jsx("div",{children:p.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:u?p.jsxs(p.Fragment,{children:[p.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"login"===r?"Sign In":"signup"===r&&1===B?"Continue":"signup"===r&&2===B?"Create Account":"forgot"===r?"Send Reset Link":"Submit"})}),p.jsx("div",{className:"text-center text-sm text-gray-600",children:"login"===r?p.jsxs("p",{children:["Don't have an account?"," ",p.jsx("button",{type:"button",onClick:()=>i("signup"),className:"font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Sign up"})]}):"signup"===r?p.jsxs("p",{children:["Already have an account?"," ",p.jsx("button",{type:"button",onClick:()=>i("login"),className:"font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Sign in"})]}):"forgot"===r?p.jsxs("p",{children:["Remember your password?"," ",p.jsx("button",{type:"button",onClick:()=>i("login"),className:"font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Sign in"})]}):null}),("login"===r||"signup"===r&&1===B)&&p.jsx("div",{className:"pt-4 border-t border-gray-200",children:p.jsxs("div",{className:"flex items-center justify-center space-x-4 text-xs text-gray-500",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx(q,{className:"h-4 w-4 mr-1 text-green-500"}),p.jsx("span",{children:"Secure"})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(M,{className:"h-4 w-4 mr-1 text-blue-500"}),p.jsx("span",{children:"Private"})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(_,{className:"h-4 w-4 mr-1 text-purple-500"}),p.jsx("span",{children:"Trusted"})]})]})})]})})]})]}):null},Te=new class extends Ee{getUserById(e){return m(this,null,function*(){try{if(!e)throw new Error("User ID is required");const t=`users:${e}`,s=Ie.get(t);if(s)return s;const{data:r,error:i}=yield this.supabase.from("profiles").select("*").eq("id",e).single();if(i){if("PGRST116"===i.code)return null;throw i}if(!r)return null;const a={id:r.id,email:r.email,name:r.full_name,role:r.role,phone:r.phone,dateOfBirth:r.date_of_birth,isActive:r.is_active,emailVerified:r.email_verified||!1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)};return Ie.set(t,a,6e5),a}catch(t){return this.handleError(t,"Get User By ID")}})}updateUser(e,t){return m(this,null,function*(){try{if(!e)throw new Error("User ID is required");t.email&&this.validateEmail(t.email);const s={updated_at:(new Date).toISOString()};void 0!==t.name&&(s.full_name=t.name),void 0!==t.email&&(s.email=t.email),void 0!==t.role&&(s.role=t.role),void 0!==t.phone&&(s.phone=t.phone),void 0!==t.dateOfBirth&&(s.date_of_birth=t.dateOfBirth),void 0!==t.isActive&&(s.is_active=t.isActive);const{data:r,error:i}=yield this.supabase.from("profiles").update(s).eq("id",e).select().single();if(i)throw i;const a={id:r.id,email:r.email,name:r.full_name,role:r.role,phone:r.phone,dateOfBirth:r.date_of_birth,isActive:r.is_active,emailVerified:r.email_verified||!1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)};return De.invalidateUser(e),a}catch(s){return this.handleError(s,"Update User")}})}deleteUser(e){return m(this,null,function*(){try{if(!e)throw new Error("User ID is required");const{data:t,error:s}=yield this.supabase.from("profiles").select("id").eq("id",e).single();if(s)throw s;if(!t)throw new Error("User not found");const r=["addresses","cart_items","wishlist_items","reviews"];for(const a of r){const{error:t}=yield this.supabase.from(a).delete().eq("user_id",e)}const{error:i}=yield this.supabase.from("profiles").delete().eq("id",e);if(i)throw i;return De.invalidateUser(e),!0}catch(t){return this.handleError(t,"Delete User"),!1}})}createUser(e){return m(this,null,function*(){try{this.validateRequired(e,["email","name","role"]),this.validateEmail(e.email);const{data:t,error:s}=yield this.supabase.from("profiles").select("id").eq("email",e.email).single();if(s&&"PGRST116"!==s.code)throw s;if(t)throw new Error("User with this email already exists");const{data:r,error:i}=yield this.supabase.rpc("create_user_profile",{p_email:e.email,p_full_name:e.name,p_role:e.role,p_phone:e.phone||null,p_date_of_birth:e.dateOfBirth||null,p_is_active:void 0===e.isActive||e.isActive});if(i)throw new Error(`Failed to create user: ${i.message}`);const{data:a,error:o}=yield this.supabase.from("profiles").select("*").eq("id",r).single();if(o)throw o;const n={id:a.id,email:a.email,name:a.full_name,role:a.role,phone:a.phone,dateOfBirth:a.date_of_birth,isActive:a.is_active,emailVerified:a.email_verified||!0,createdAt:new Date(a.created_at),updatedAt:new Date(a.updated_at)};return De.invalidateUsers(),n}catch(t){return this.handleError(t,"Create User")}})}},qe=h.createContext(void 0),Me=()=>{const e=h.useContext(qe);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},_e=({children:e})=>{const[t,s]=h.useState(null),[r,i]=h.useState(!0),[a,o]=h.useState(!1),[n,d]=h.useState("login"),{setError:u}=fe();h.useEffect(()=>{m(null,null,function*(){try{const e=z.auth.getSession(),t=new Promise((e,t)=>{setTimeout(()=>t(new Error("Session retrieval timed out")),15e3)}),{data:{session:s}}=yield Promise.race([e,t]);(null==s?void 0:s.user)&&(yield g(s.user))}catch(e){u("Authentication initialization failed. Please refresh the page.")}finally{i(!1)}})},[]),h.useEffect(()=>{const{data:{subscription:e}}=z.auth.onAuthStateChange((e,t)=>m(null,null,function*(){try{i(!0),(null==t?void 0:t.user)?yield g(t.user):(s(null),u(null),localStorage.removeItem("user_preferences"),localStorage.removeItem("cart_items"))}catch(e){u("Authentication error occurred. Please try refreshing the page.")}finally{i(!1)}}));return()=>null==e?void 0:e.unsubscribe()},[]);const g=e=>m(null,null,function*(){var t,r,i,a;try{const o=yield Te.getUserById(e.id);if(o){const t=c(l({},o),{email:e.email});s(t),u(null)}else{const o=yield Te.createUser({email:e.email,name:(null==(t=e.user_metadata)?void 0:t.full_name)||"",role:(null==(r=e.user_metadata)?void 0:r.role)||"customer",phone:(null==(i=e.user_metadata)?void 0:i.phone)||"",dateOfBirth:(null==(a=e.user_metadata)?void 0:a.date_of_birth)||"",isActive:!0});o?s(o):(s(null),u("Failed to create user profile"))}}catch(o){u(o instanceof Error?o.message:"Authentication error"),s(null)}}),f=(e,t)=>m(null,null,function*(){try{const s=z.auth.signInWithPassword({email:e,password:t}),r=new Promise((e,t)=>{setTimeout(()=>t(new Error("Authentication request timed out")),15e3)}),{error:i}=yield Promise.race([s,r]);if(i)throw i.message.includes("Invalid login credentials")?new Error("Invalid credentials. Please check your email and password."):i.message.includes("Email not confirmed")?new Error("Please confirm your email address before signing in."):i.message.includes("Too many requests")?new Error("Too many login attempts. Please wait a moment and try again."):i.message.includes("Account is temporarily locked")?new Error("Account is temporarily locked due to too many failed attempts. Please try again later."):i.message.includes("timed out")||i.message.includes("aborted")?new Error("Connection timeout. Please check your internet connection and try again."):new Error(i.message)}catch(s){if(s instanceof Error){if(s.message.includes("timed out")||s.message.includes("aborted"))throw new Error("Connection timeout. Please check your internet connection and try again.");throw s}throw new Error("An unexpected error occurred during sign in.")}}),y=(e,t,s)=>m(null,null,function*(){const{error:r}=yield z.auth.signUp({email:e,password:t,options:{data:{full_name:(null==s?void 0:s.fullName)||"",phone:(null==s?void 0:s.phone)||"",date_of_birth:(null==s?void 0:s.dateOfBirth)||"",subscribe_newsletter:(null==s?void 0:s.subscribeNewsletter)||!1,role:"customer"}}});if(r)throw new Error(r.message);try{const{emailService:t}=yield pe(()=>m(null,null,function*(){const{emailService:e}=yield import("./pages-B-uaxJKn.js").then(e=>e.e);return{emailService:e}}),__vite__mapDeps([0,1,2,3,4,5,6,7]));yield t.sendWelcomeEmail({email:e,name:(null==s?void 0:s.fullName)||"Customer"})}catch(i){}}),w=()=>m(null,null,function*(){const{error:e}=yield z.auth.signOut();if(e)throw new Error(e.message);s(null),localStorage.removeItem("user_preferences"),localStorage.removeItem("cart_items")}),b={user:t,loading:r,login:(e,t)=>m(null,null,function*(){try{return yield f(e,t),null}catch(s){return s instanceof Error?s.message:"Login failed"}}),logout:()=>m(null,null,function*(){yield w()}),register:e=>m(null,null,function*(){try{return yield y(e.email,e.password,{fullName:e.name,phone:e.phone,dateOfBirth:e.dateOfBirth}),!0}catch(t){return!1}}),signIn:f,signUp:y,signOut:w,resetPassword:e=>m(null,null,function*(){const{error:t}=yield z.auth.resetPasswordForEmail(e);if(t)throw new Error(t.message)}),updatePassword:e=>m(null,null,function*(){const{error:t}=yield z.auth.updateUser({password:e});if(t)throw new Error(t.message)}),resendVerification:()=>m(null,null,function*(){if(!(null==t?void 0:t.email))throw new Error("No email available");const{error:e}=yield z.auth.resend({type:"signup",email:t.email});if(e)throw new Error(e.message)}),updateProfile:e=>m(null,null,function*(){try{if(!t)throw new Error("No user is currently authenticated");const r=yield Te.updateUser(t.id,e);s(r)}catch(r){throw r}}),openMobileAuth:(e="login")=>{d(e),o(!0)},closeMobileAuth:()=>{o(!1)},isMobileAuthOpen:a,mobileAuthMode:n};return p.jsxs(qe.Provider,{value:b,children:[e,p.jsx(Re,{isOpen:a,onClose:()=>o(!1),initialMode:"profile"===n?"login":n})]})},Oe=h.createContext(void 0),Be=()=>{const e=h.useContext(Oe);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e},Fe=({children:e})=>{const[t,s]=h.useState([]),r=h.useRef(new Map),i=e=>{const i=Date.now(),o=`${i}-${Math.random().toString(36).substring(2,9)}`,n=e.duration||5e3;if(t.some(t=>t.type===e.type&&t.message===e.message&&t.title===e.title&&i-t.timestamp<2e3))return;const d=c(l({},e),{id:o,timestamp:i,duration:n,isVisible:!1,isDismissing:!1});if(s(e=>[d,...e]),setTimeout(()=>{s(e=>e.map(e=>e.id===o?c(l({},e),{isVisible:!0}):e))},10),n>0){const e=setTimeout(()=>{a(o)},n);r.current.set(o,e)}},a=e=>{const t=r.current.get(e);t&&(clearTimeout(t),r.current.delete(e)),s(t=>t.map(t=>t.id===e?c(l({},t),{isDismissing:!0}):t)),setTimeout(()=>{s(t=>t.filter(t=>t.id!==e))},300)};h.useEffect(()=>()=>{r.current.forEach(e=>clearTimeout(e)),r.current.clear()},[]);const o=({notification:e})=>{const[t,s]=h.useState(100),r=h.useRef(null);h.useEffect(()=>{if(e.duration&&e.duration>0&&e.isVisible&&!e.isDismissing){const t=Date.now(),i=e.duration,a=()=>{const e=Date.now()-t,o=Math.max(0,100-e/i*100);s(o),o>0&&(r.current=setTimeout(a,50))};a()}return()=>{r.current&&clearTimeout(r.current)}},[e.duration,e.isVisible,e.isDismissing]);const i=(()=>{switch(e.type){case"success":return{container:"bg-white border-l-4 border-emerald-500 shadow-lg shadow-emerald-500/20",icon:p.jsx(F,{className:"h-5 w-5 text-emerald-600"}),iconBg:"bg-emerald-50",progress:"bg-emerald-500"};case"error":return{container:"bg-white border-l-4 border-red-500 shadow-lg shadow-red-500/20",icon:p.jsx(E,{className:"h-5 w-5 text-red-600"}),iconBg:"bg-red-50",progress:"bg-red-500"};case"warning":return{container:"bg-white border-l-4 border-amber-500 shadow-lg shadow-amber-500/20",icon:p.jsx(B,{className:"h-5 w-5 text-amber-600"}),iconBg:"bg-amber-50",progress:"bg-amber-500"};default:return{container:"bg-white border-l-4 border-blue-500 shadow-lg shadow-blue-500/20",icon:p.jsx(O,{className:"h-5 w-5 text-blue-600"}),iconBg:"bg-blue-50",progress:"bg-blue-500"}}})();return p.jsxs("div",{className:`\n          ${i.container}\n          rounded-lg overflow-hidden backdrop-blur-sm max-w-sm w-full\n          transform transition-all duration-300 ease-out\n          ${e.isVisible&&!e.isDismissing?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}\n          ${e.isDismissing?"translate-x-full opacity-0 scale-95":""}\n        `,children:[p.jsx("div",{className:"p-4",children:p.jsxs("div",{className:"flex items-start",children:[p.jsx("div",{className:`flex-shrink-0 ${i.iconBg} rounded-full p-2 mr-3`,children:i.icon}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-1",children:e.title}),p.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.message})]}),p.jsx("button",{onClick:()=>{return t=e.id,void a(t);var t},className:"flex-shrink-0 ml-3 p-1 rounded-lg hover:bg-gray-100 transition-colors duration-200 group",children:p.jsx(f,{className:"h-4 w-4 text-gray-400 group-hover:text-gray-600"})})]})}),e.duration&&e.duration>0&&p.jsx("div",{className:"h-1 bg-gray-200",children:p.jsx("div",{className:`h-full ${i.progress} transition-all duration-75 ease-linear`,style:{width:`${t}%`}})})]})};return h.useEffect(()=>{let e=!1;const t=()=>{e||(requestAnimationFrame(()=>{(()=>{const e=document.querySelector(".notification-container");if(e){const t=window.pageYOffset||document.documentElement.scrollTop,s=Math.max(20,t+20);e.style.top=`${s}px`}})(),e=!1}),e=!0)};return window.addEventListener("scroll",t,{passive:!0}),()=>window.removeEventListener("scroll",t)},[]),p.jsxs(Oe.Provider,{value:{showNotification:i,showError:(e,t)=>{const s="type"in e?e:je.handle(e);i({type:"error",title:"Oops! Something went wrong",message:s.message,duration:7e3})},showSuccess:(e,t="Success!")=>{i({type:"success",title:t,message:e,duration:4e3})},showInfo:(e,t="Info")=>{i({type:"info",title:t,message:e,duration:5e3})},showWarning:(e,t="Heads up!")=>{i({type:"warning",title:t,message:e,duration:6e3})}},children:[e,p.jsx("div",{className:"fixed top-4 right-4 z-[9999] pointer-events-none notification-container",style:{position:"fixed",top:"1rem",right:"1rem",maxHeight:"calc(100vh - 2rem)",overflow:"hidden",zIndex:9999},children:p.jsx("div",{className:"flex flex-col-reverse gap-3 max-w-sm w-full",children:t.map(e=>p.jsx("div",{className:"pointer-events-auto",children:p.jsx(o,{notification:e})},e.id))})})]})},Le=h.createContext(void 0),Ue=()=>{const e=h.useContext(Le);if(!e)throw new Error("useCart must be used within a CartProvider");return e},$e=({children:e})=>{const{user:t}=Me(),{showNotification:s}=Be(),[r,i]=h.useState([]),[a,o]=h.useState(!0),[n,d]=h.useState([]),u=h.useCallback(()=>{try{const e=localStorage.getItem("guestCart");if(e){const t=JSON.parse(e);return d(t),t}}catch(e){}return[]},[]),g=h.useCallback(e=>{try{localStorage.setItem("guestCart",JSON.stringify(e)),d(e)}catch(t){}},[]),f=h.useCallback(()=>m(null,null,function*(){if(t&&n.length>0)try{for(const e of n)yield V(e.product.id,e.variantId,e.quantity);return localStorage.removeItem("guestCart"),d([]),!0}catch(e){return!1}return!1}),[t,n]),y=h.useCallback(()=>m(null,null,function*(){o(!0);try{if(t){const e=yield H(t.id);i(e)}else{const e=u();i(e)}}catch(e){s({type:"error",title:"Error",message:"Failed to fetch cart items. Please try again later."})}o(!1)}),[t,s,u]);h.useEffect(()=>{y()},[y]),h.useEffect(()=>{t||u()},[t,u]),h.useEffect(()=>{t&&n.length>0&&f().then(e=>{e&&y()})},[t,n.length,f,y]);const w=e=>m(null,null,function*(){try{if(t){(yield J(e))?yield y():s({type:"error",title:"Error",message:"Failed to remove item from cart."})}else{const t=u().filter(t=>t.product.id!==e);g(t),i(t)}}catch(r){s({type:"error",title:"Error",message:"Failed to remove item from cart. Please try again later."})}}),b=r.reduce((e,t)=>e+t.product.price*t.quantity,0),v=r.reduce((e,t)=>e+t.quantity,0),x={items:r,addItem:(e,r=1)=>m(null,null,function*(){try{if(t){(yield V(e.id,void 0,r))?(yield y(),s({type:"success",title:"Added to Cart",message:`${e.name} has been added.`})):s({type:"error",title:"Error",message:"Could not add item to cart."})}else{const t=u(),a=t.findIndex(t=>t.product.id===e.id);let o;if(a>=0)o=[...t],o[a].quantity+=r;else{const s={id:`guest-${Date.now()}-${e.id}`,product:e,productId:e.id,quantity:r,variantId:void 0,createdAt:new Date};o=[...t,s]}g(o),i(o),s({type:"success",title:"Added to Cart",message:`${e.name} has been added.`})}}catch(a){s({type:"error",title:"Error",message:"Failed to add item to cart. Please try again later."})}}),removeItem:w,updateQuantity:(e,r)=>m(null,null,function*(){if(r<=0)yield w(e);else try{if(t){(yield Q(e,r))?yield y():s({type:"error",title:"Error",message:"Failed to update item quantity."})}else{const t=u().map(t=>t.product.id===e?c(l({},t),{quantity:r}):t);g(t),i(t)}}catch(a){s({type:"error",title:"Error",message:"Failed to update item quantity. Please try again later."})}}),clearCart:()=>m(null,null,function*(){try{if(t){(yield W())?i([]):s({type:"error",title:"Error",message:"Failed to clear cart."})}else localStorage.removeItem("guestCart"),d([]),i([])}catch(e){s({type:"error",title:"Error",message:"Failed to clear cart. Please try again later."})}}),total:b,itemCount:v,loading:a};return p.jsx(Le.Provider,{value:x,children:e})},ze=h.createContext(void 0),Ve=()=>{const e=h.useContext(ze);if(!e)throw new Error("useWishlist must be used within a WishlistProvider");return e},He=({children:e})=>{const{user:t}=Me(),{showNotification:s}=Be(),[r,i]=h.useState([]),[a,o]=h.useState(!0),n=h.useCallback(()=>m(null,null,function*(){if(!t)return i([]),void o(!1);o(!0);try{const e=yield G(t.id);i(e)}catch(e){s({type:"error",title:"Error",message:"Failed to fetch wishlist items. Please try again later."})}o(!1)}),[t,s]);h.useEffect(()=>{n()},[n]);const l=e=>m(null,null,function*(){if(t)try{(yield Y(e))?yield n():s({type:"error",title:"Error",message:"Failed to remove item from wishlist."})}catch(r){s({type:"error",title:"Error",message:"Failed to remove item from wishlist. Please try again later."})}}),c=e=>r.some(t=>t.product.id===e),d={items:r,addItem:e=>m(null,null,function*(){if(t)if(c(e.id))yield l(e.id),s({type:"info",title:"Removed from Wishlist",message:`${e.name} removed from your wishlist.`});else try{(yield Z(e.id))?(yield n(),s({type:"success",title:"Added to Wishlist",message:`${e.name} added to your wishlist.`})):s({type:"error",title:"Error",message:"Could not add item to wishlist."})}catch(r){s({type:"error",title:"Error",message:"Failed to add item to wishlist. Please try again later."})}else s({type:"info",title:"Authentication Required",message:"Please log in or create an account to add items to your wishlist."})}),removeItem:l,isInWishlist:c,clearWishlist:()=>m(null,null,function*(){if(t)try{const e=r.map(e=>Y(e.product.id));yield Promise.all(e),i([])}catch(e){s({type:"error",title:"Error",message:"Failed to clear wishlist. Please try again later."})}}),loading:a};return p.jsx(ze.Provider,{value:d,children:e})},We=(e,t)=>{throw new Error(`${t} failed: ${e.message||"Unknown error"}`)},Qe=(e,t)=>{const s=t.filter(t=>!e[t]);if(s.length>0)throw new Error(`Required fields missing: ${s.join(", ")}`)},Je=(e,t)=>m(null,null,function*(){try{if(!e)throw new Error("User ID is required");t.email&&(e=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))throw new Error("Invalid email format")})(t.email);const s={updated_at:(new Date).toISOString()};void 0!==t.name&&(s.full_name=t.name),void 0!==t.email&&(s.email=t.email),void 0!==t.role&&(s.role=t.role),void 0!==t.phone&&(s.phone=t.phone),void 0!==t.dateOfBirth&&(s.date_of_birth=t.dateOfBirth),void 0!==t.isActive&&(s.is_active=t.isActive);const{data:r,error:i}=yield z.from("profiles").update(s).eq("id",e).select().single();if(i)throw i;return{id:r.id,email:r.email,name:r.full_name,role:r.role,phone:r.phone,dateOfBirth:r.date_of_birth,isActive:r.is_active,emailVerified:r.email_verified||!1,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}}catch(s){throw We(s,"Update User"),s}}),Ge=e=>m(null,null,function*(){try{if(!e)throw new Error("User ID is required");const{data:t}=yield z.from("profiles").select("id").eq("id",e).single();if(!t)throw new Error("User not found");const s=["addresses","cart_items","wishlist_items","reviews"];for(const i of s)yield z.from(i).delete().eq("user_id",e);const{error:r}=yield z.from("profiles").delete().eq("id",e);if(r)throw r;return!0}catch(t){throw We(t,"Delete User"),t}});const Ye=(e=class{constructor(){u(this,"measurements",new Map),u(this,"metrics",[]),u(this,"maxMetrics",100)}static getInstance(){return e.instance||(e.instance=new e),e.instance}startMeasure(e){this.measurements.set(e,performance.now())}endMeasure(e,t=!0){const s=this.measurements.get(e);if(!s)return this.startMeasure(e),0;const r=performance.now()-s;return this.metrics.push({name:e,duration:r,timestamp:Date.now(),success:t}),this.metrics.length>this.maxMetrics&&this.metrics.shift(),this.measurements.delete(e),r}getStats(){const e=this.metrics.filter(e=>Date.now()-e.timestamp<3e5),t=e.filter(e=>e.success);if(0===e.length)return{totalRequests:0,successRate:0,averageTime:0,slowestOperation:null,fastestOperation:null};const s=t.map(e=>e.duration),r=s.reduce((e,t)=>e+t,0)/s.length,i=e.reduce((e,t)=>t.duration>e.duration?t:e),a=e.reduce((e,t)=>t.duration<e.duration?t:e);return{totalRequests:e.length,successRate:t.length/e.length*100,averageTime:r,slowestOperation:i,fastestOperation:a}}measureAsync(e,t){return m(this,null,function*(){this.startMeasure(e);try{const s=yield t();return this.endMeasure(e),s}catch(s){throw this.endMeasure(e),s}})}measureSync(e,t){this.startMeasure(e);try{const s=t();return this.endMeasure(e),s}catch(s){throw this.endMeasure(e),s}}},u(e,"instance"),e).getInstance();new class{constructor(e={},t={}){u(this,"warmingConfig"),u(this,"syncConfig"),u(this,"warmingTimer",null),u(this,"syncTimer",null),u(this,"accessPatterns",new Map),u(this,"dependencies",new Map),this.warmingConfig=l({warmingInterval:3e5,warmingStrategy:"smart",warmingThreshold:10,maxWarmingBatchSize:20},e),this.syncConfig=l({syncInterval:6e4,maxRetries:3,retryDelay:1e3,exponentialBackoff:!0,batchSize:10},t),this.startWarmingProcess(),this.startSyncProcess()}get(e,t){return m(this,arguments,function*(e,t,s={}){const r=l(l({},{strategy:"stale-while-revalidate",ttl:3e5,maxAge:9e5,priority:"medium",tags:[],compression:!1,version:1}),s);this.trackAccess(e),r.dependencies&&r.dependencies.length>0&&this.addDependencies(e,r.dependencies),Ye.startMeasure(`advanced-cache-get-${e}`);try{switch(r.strategy){case"cache-first":return yield this.cacheFirstStrategy(e,t,r);case"network-first":return yield this.networkFirstStrategy(e,t,r);case"stale-while-revalidate":return yield this.staleWhileRevalidateStrategy(e,t,r);case"network-only":return yield this.networkOnlyStrategy(e,t,r);case"cache-only":return yield this.cacheOnlyStrategy(e,r);default:return yield t()}}finally{Ye.endMeasure(`advanced-cache-get-${e}`)}})}set(e,t){return m(this,arguments,function*(e,t,s={}){const r=l(l({},{strategy:"stale-while-revalidate",ttl:3e5,maxAge:9e5,priority:"medium",tags:[],compression:!1,version:1}),s),i=this.selectCache(r.tags),a=`${e}_v${r.version}`,o=r.encryption?this.encrypt(t):t;i.set(a,o,{ttl:r.ttl,priority:r.priority,tags:r.tags,compress:r.compression}),this.invalidateDependencies(e)})}warmCache(){return m(this,null,function*(){try{const e=this.getCandidatesForWarming().slice(0,this.warmingConfig.maxWarmingBatchSize);yield Promise.all(e.map(e=>m(this,[e],function*({key:e,fetchFn:t}){try{yield t()}catch(s){}})))}catch(e){}})}getCandidatesForWarming(){const e=[],t=Date.now();for(const[s,r]of this.accessPatterns.entries()){this.shouldWarmKey(s,r,t)&&e.push({key:s,fetchFn:()=>m(this,null,function*(){})})}return e}shouldWarmKey(e,t,s){switch(this.warmingConfig.warmingStrategy){case"aggressive":return t.count>=this.warmingConfig.warmingThreshold;case"conservative":return t.count>=this.warmingConfig.warmingThreshold&&s-t.lastAccess<this.warmingConfig.warmingInterval;default:const e=(s-t.lastAccess)/this.warmingConfig.warmingInterval;return t.count/(1+e)>=this.warmingConfig.warmingThreshold/2}}syncOfflineData(){return m(this,null,function*(){})}trackAccess(e){const t=this.accessPatterns.get(e)||{count:0,lastAccess:Date.now()};t.count++,t.lastAccess=Date.now(),this.accessPatterns.set(e,t)}addDependencies(e,t){for(const s of t)this.dependencies.has(s)||this.dependencies.set(s,new Set),this.dependencies.get(s).add(e)}invalidateDependencies(e){const t=this.dependencies.get(e);if(t)for(const s of t)Ke.delete(s),et.delete(s),tt.delete(s),Xe.delete(s)}selectCache(e){return e.includes("user")||e.includes("profile")||e.includes("cart")?tt:e.includes("image")||e.includes("asset")?Xe:e.includes("api")?et:Ke}cacheFirstStrategy(e,t,s){return m(this,null,function*(){const r=`${e}_v${s.version}`,i=this.selectCache(s.tags).get(r);if(null!==i)return s.encryption?this.decrypt(i):i;try{const r=yield t();return yield this.set(e,r,s),r}catch(a){throw a}})}networkFirstStrategy(e,t,s){return m(this,null,function*(){const r=`${e}_v${s.version}`,i=this.selectCache(s.tags);try{const r=yield t();return yield this.set(e,r,s),r}catch(a){const e=i.get(r);if(null!==e)return s.encryption?this.decrypt(e):e;throw a}})}staleWhileRevalidateStrategy(e,t,s){return m(this,null,function*(){const r=`${e}_v${s.version}`,i=this.selectCache(s.tags).get(r);if(null!==i)return setTimeout(()=>m(this,null,function*(){try{const r=yield t();yield this.set(e,r,s)}catch(r){}}),0),s.encryption?this.decrypt(i):i;const a=yield t();return yield this.set(e,a,s),a})}networkOnlyStrategy(e,t,s){return m(this,null,function*(){const r=yield t();return s.syncOnline&&(yield this.set(e,r,s)),r})}cacheOnlyStrategy(e,t){return m(this,null,function*(){const s=`${e}_v${t.version}`,r=this.selectCache(t.tags).get(s);if(null===r)throw new Error(`No cached data available for ${e}`);return t.encryption?this.decrypt(r):r})}encrypt(e){return e}decrypt(e){return e}startWarmingProcess(){this.warmingTimer=setInterval(()=>{this.warmCache()},this.warmingConfig.warmingInterval)}startSyncProcess(){this.syncTimer=setInterval(()=>{this.syncOfflineData()},this.syncConfig.syncInterval)}destroy(){this.warmingTimer&&(clearInterval(this.warmingTimer),this.warmingTimer=null),this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null),this.accessPatterns.clear(),this.dependencies.clear()}};class Ze{constructor(e={}){u(this,"cache",new Map),u(this,"strategy"),u(this,"stats",{hitRate:0,totalRequests:0,totalHits:0,totalMisses:0,totalSize:0,entryCount:0,gcRuns:0,lastGC:Date.now()}),u(this,"gcTimer",null),u(this,"backgroundUpdateQueue",new Set),this.strategy=l({maxSize:52428800,maxEntries:1e3,defaultTTL:3e5,gcInterval:6e4,compressionThreshold:1024},e),this.startGarbageCollection()}set(e,t,s={}){Ye.startMeasure(`cache-set-${e}`);const{ttl:r=this.strategy.defaultTTL,priority:i="medium",tags:a=[],compress:o=!1}=s,n=this.serializeData(t,o),l=this.calculateSize(n);this.shouldEvict(l)&&this.evictEntries(l);const c={data:n,timestamp:Date.now(),ttl:r,accessCount:0,lastAccessed:Date.now(),size:l,priority:i,tags:a};this.cache.set(e,c),this.updateStats("set",l),Ye.endMeasure(`cache-set-${e}`)}get(e){Ye.startMeasure(`cache-get-${e}`),this.stats.totalRequests++;const t=this.cache.get(e);return t?this.isExpired(t)?(this.cache.delete(e),this.stats.totalMisses++,this.updateStats("delete",t.size),this.updateHitRate(),Ye.endMeasure(`cache-get-${e}`,!1),"high"===t.priority&&this.queueBackgroundUpdate(e),null):(t.accessCount++,t.lastAccessed=Date.now(),this.stats.totalHits++,this.updateHitRate(),Ye.endMeasure(`cache-get-${e}`),this.deserializeData(t.data)):(this.stats.totalMisses++,this.updateHitRate(),Ye.endMeasure(`cache-get-${e}`,!1),null)}has(e){const t=this.cache.get(e);return void 0!==t&&!this.isExpired(t)}delete(e){const t=this.cache.get(e);return!!t&&(this.cache.delete(e),this.updateStats("delete",t.size),!0)}clearByTags(e){let t=0;for(const[s,r]of this.cache.entries())r.tags.some(t=>e.includes(t))&&(this.cache.delete(s),this.updateStats("delete",r.size),t++);return t}clear(){this.cache.clear(),this.stats=c(l({},this.stats),{totalSize:0,entryCount:0})}getStats(){return l({},this.stats)}prefetch(e,t){return m(this,arguments,function*(e,t,s={}){try{const r=yield t();return this.set(e,r,l({priority:"high"},s)),r}catch(r){throw r}})}getOrFetch(e,t){return m(this,arguments,function*(e,t,s={}){const r=s,{staleWhileRevalidate:i=!1}=r,a=d(r,["staleWhileRevalidate"]),o=this.get(e);if(null!==o)return i&&this.queueBackgroundUpdate(e,t,a),o;try{const s=yield t();return this.set(e,s,a),s}catch(n){throw n}})}serializeData(e,t){return t&&"string"==typeof e?{compressed:!0,data:e}:e}deserializeData(e){return e&&e.compressed?e.data:e}calculateSize(e){return 2*JSON.stringify(e).length}isExpired(e){return Date.now()-e.timestamp>e.ttl}shouldEvict(e){return this.stats.totalSize+e>this.strategy.maxSize||this.stats.entryCount>=this.strategy.maxEntries}evictEntries(e){const t=Array.from(this.cache.entries());t.sort(([,e],[,t])=>{const s={low:1,medium:2,high:3};return e.priority!==t.priority?s[e.priority]-s[t.priority]:Math.abs(e.lastAccessed-t.lastAccessed)>1e3?e.lastAccessed-t.lastAccessed:e.accessCount-t.accessCount});let s=0;for(const[r,i]of t){if(s>=e&&this.stats.entryCount<this.strategy.maxEntries)break;this.cache.delete(r),s+=i.size,this.updateStats("delete",i.size)}}updateStats(e,t){"set"===e?(this.stats.totalSize+=t,this.stats.entryCount++):(this.stats.totalSize-=t,this.stats.entryCount--)}updateHitRate(){this.stats.hitRate=this.stats.totalRequests>0?this.stats.totalHits/this.stats.totalRequests*100:0}startGarbageCollection(){this.gcTimer=setInterval(()=>{this.runGarbageCollection()},this.strategy.gcInterval)}runGarbageCollection(){const e=this.stats.entryCount,t=Date.now();for(const[s,r]of this.cache.entries())this.isExpired(r)&&(this.cache.delete(s),this.updateStats("delete",r.size));this.stats.gcRuns++,this.stats.lastGC=t;this.stats.entryCount}queueBackgroundUpdate(e,t,s={}){this.backgroundUpdateQueue.has(e)||(this.backgroundUpdateQueue.add(e),setTimeout(()=>m(this,null,function*(){try{if(t){const r=yield t();this.set(e,r,s)}}catch(r){}finally{this.backgroundUpdateQueue.delete(e)}}),100))}destroy(){this.gcTimer&&(clearInterval(this.gcTimer),this.gcTimer=null),this.clear()}}const Ke=new Ze({maxSize:52428800,maxEntries:1e3,defaultTTL:9e5}),Xe=new Ze({maxSize:157286400,maxEntries:300,defaultTTL:36e5}),et=new Ze({maxSize:20971520,maxEntries:500,defaultTTL:6e5}),tt=new Ze({maxSize:10485760,maxEntries:200,defaultTTL:18e5}),st=Ke,rt=Ke,it=(e,t={})=>{const s=Object.keys(t).sort().map(e=>`${e}:${t[e]}`).join("|");return s?`${e}:${s}`:e},at=e=>{Ke.clearByTags(["product"])},ot=()=>{Ke.clearByTags(["category"])},nt=[{id:"1",name:"Luxury Perfume Collection",description:"A sophisticated blend of floral and woody notes, perfect for evening wear. This luxurious fragrance features top notes of bergamot and lemon, heart notes of jasmine and rose, and a base of sandalwood and musk.",shortDescription:"Elegant floral-woody fragrance for special occasions",price:89.99,originalPrice:129.99,categoryId:"1",category:"Premium Fragrances",images:["/images/products/perfumes/attar-1.jpg","/images/products/perfumes/attar-2.jpg","/images/products/perfumes/attar-3.jpg"],stock:15,minStockLevel:5,sku:"LUX-PERF-001",weight:.5,dimensions:{length:10,width:5,height:15},rating:4.8,reviewCount:127,reviews:[],sellerId:"seller-1",sellerName:"Luxury Fragrances Inc.",tags:["luxury","evening","floral","woody"],specifications:{fragrance_family:"Floral Woody",concentration:"Eau de Parfum",volume:"100ml",top_notes:"Bergamot, Lemon",middle_notes:"Jasmine, Rose",base_notes:"Sandalwood, Musk"},featured:!0,isActive:!0,metaTitle:"Luxury Perfume Collection - Premium Fragrances",metaDescription:"Shop our Luxury Perfume Collection with sophisticated floral and woody notes. Perfect for evening wear and special occasions.",createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15")},{id:"2",name:"Fresh Citrus Spray",description:"An invigorating citrus blend that brings a burst of freshness. Perfect for daytime use, this fragrance opens with zesty lemon and grapefruit, followed by a subtle hint of mint and finished with a clean musk base.",shortDescription:"Refreshing citrus fragrance for daily wear",price:49.99,categoryId:"2",category:"Everyday Scents",images:["/images/products/perfumes/attar-4.jpg","/images/products/perfumes/attar-5.jpg"],stock:25,minStockLevel:10,sku:"FRESH-CIT-002",weight:.4,dimensions:{length:8,width:4,height:12},rating:4.6,reviewCount:89,reviews:[],sellerId:"seller-2",sellerName:"Citrus Essentials Co.",tags:["citrus","fresh","daytime","energizing"],specifications:{fragrance_family:"Citrus",concentration:"Eau de Toilette",volume:"50ml",top_notes:"Lemon, Grapefruit, Mint",middle_notes:"Basil, Green Notes",base_notes:"Clean Musk, White Woods"},featured:!1,isActive:!0,metaTitle:"Fresh Citrus Spray - Everyday Scents",metaDescription:"Experience the refreshing burst of our Fresh Citrus Spray, perfect for daily wear and daytime use.",createdAt:new Date("2024-02-20"),updatedAt:new Date("2024-02-20")},{id:"3",name:"Oriental Spice Blend",description:"A warm and sensual oriental fragrance with spicy accords. This captivating scent features cardamom and saffron opening, a heart of cinnamon and clove, and a base of amber and vanilla that lingers throughout the day.",shortDescription:"Warm oriental fragrance with spicy notes",price:79.99,originalPrice:99.99,categoryId:"1",category:"Premium Fragrances",images:["/images/products/alcohol-free-perfumes/IMG-20250924-WA0028.jpg","/images/products/alcohol-free-perfumes/IMG-20250924-WA0054.jpg"],stock:8,minStockLevel:3,sku:"ORI-SPICE-003",weight:.45,dimensions:{length:9,width:4.5,height:14},rating:4.9,reviewCount:203,reviews:[],sellerId:"seller-3",sellerName:"Oriental Scents Ltd.",tags:["oriental","spicy","warm","sensual"],specifications:{fragrance_family:"Oriental Spicy",concentration:"Parfum",volume:"30ml",top_notes:"Cardamom, Saffron",middle_notes:"Cinnamon, Clove, Nutmeg",base_notes:"Amber, Vanilla, Patchouli"},featured:!0,isActive:!0,metaTitle:"Oriental Spice Blend - Premium Fragrances",metaDescription:"Discover our Oriental Spice Blend with warm, spicy accords. A sensual fragrance that lingers throughout the day.",createdAt:new Date("2024-03-10"),updatedAt:new Date("2024-03-10")},{id:"4",name:"The Holy Quran - Cover 1",description:"Beautiful cover design for the Holy Quran",price:29.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-holy-quran-cover-1.jpg"],stock:50,featured:!0,rating:4.9,reviewCount:15,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["quran","holy-book","islamic-literature"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"5",name:"The Holy Quran - Cover 2",description:"Elegant cover design for the Holy Quran",price:29.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-holy-quran-cover-2.jpg"],stock:50,featured:!0,rating:4.8,reviewCount:12,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["quran","holy-book","islamic-literature"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"6",name:"The Sealed Nectar - Biography of Prophet Muhammad (PBUH)",description:"A comprehensive biography of Prophet Muhammad (PBUH)",price:19.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-sealed-nectar-biography-of-prophet-muhammad.jpg"],stock:50,featured:!0,rating:4.9,reviewCount:28,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["biography","prophet","islamic-history"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"7",name:"Seerah an-Nabi - Biography of Prophet Muhammad (PBUH)",description:"Detailed biography of the life of Prophet Muhammad (PBUH)",price:18.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/seerah-an-nabi-biography-of-prophet-muhammad.jpg"],stock:45,featured:!0,rating:4.7,reviewCount:22,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["biography","prophet","islamic-history"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"8",name:"Riyad as Salihin - Collection of Hadith",description:"Gardens of the Righteous - A collection of hadith",price:14.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/riyad-as-salihin-collection-of-hadith.jpg"],stock:45,featured:!0,rating:4.8,reviewCount:31,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["hadith","islamic-teachings","morals"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"9",name:"Fortress of the Muslim - Daily Supplications",description:"Daily supplications from the Quran and Sunnah",price:12.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/fortress-of-the-muslim-daily-suplications.jpg"],stock:60,featured:!1,rating:4.6,reviewCount:19,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["dua","supplications","daily-practice"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"10",name:"40 Hadith Nawawi - Essential Hadiths",description:"40 important hadiths with commentary",price:16.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/forty-hadith-nawawi-essential-hadiths.jpg"],stock:40,featured:!1,rating:4.7,reviewCount:25,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["hadith","nawawi","essential-teachings"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"11",name:"Islamic Finance - Banking Principles",description:"Understanding Islamic banking and finance principles",price:24.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/islamic-finance-banking-principles.jpg"],stock:30,featured:!0,rating:4.5,reviewCount:14,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["finance","banking","islamic-economics"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"12",name:"Stories of the Prophets",description:"Collection of stories about the prophets in Islam",price:22.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/stories-of-the-prophets.jpg"],stock:35,featured:!0,rating:4.8,reviewCount:33,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophets","stories","islamic-history"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"13",name:"Understanding Islam - For New Muslims",description:"A comprehensive guide for new converts to Islam",price:17.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/understanding-islam-for-new-muslims.jpg"],stock:40,featured:!1,rating:4.6,reviewCount:27,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["new-muslims","guide","introduction"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"14",name:"Collection of Duas from Quran and Sunnah",description:"Complete collection of supplications from the Quran and Sunnah",price:13.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/collection-of-duas-from-quran-and-sunnah.jpg"],stock:55,featured:!1,rating:4.7,reviewCount:21,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["dua","supplications","quran","sunnah"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"15",name:"The Life of Prophet Ayyub (Job)",description:"The story of Prophet Ayyub (Job), known for his patience",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-life-of-prophet-ayyub.jpg"],stock:30,featured:!1,rating:4.4,reviewCount:8,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","ayyub","patience"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"16",name:"The Story of Prophet Musa (Moses)",description:"The story of Prophet Musa (Moses) and his mission",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-musa.jpg"],stock:30,featured:!1,rating:4.5,reviewCount:12,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","musa","moses"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"17",name:"The Story of Prophet Ibrahim (Abraham)",description:"The story of Prophet Ibrahim (Abraham), the father of prophets",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-ibrahim.jpg"],stock:30,featured:!1,rating:4.6,reviewCount:15,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","ibrahim","abraham"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"18",name:"The Story of Prophet Yusuf (Joseph)",description:"The story of Prophet Yusuf (Joseph) and his brothers",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-yusuf.jpg"],stock:30,featured:!1,rating:4.7,reviewCount:18,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","yusuf","joseph"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"19",name:"The Story of Prophet Nuh (Noah)",description:"The story of Prophet Nuh (Noah) and the great flood",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-nuh.jpg"],stock:30,featured:!1,rating:4.3,reviewCount:9,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","nuh","noah"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"20",name:"The Story of Prophet Sulaiman (Solomon)",description:"The story of Prophet Sulaiman (Solomon) and his wisdom",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-sulaiman.jpg"],stock:30,featured:!1,rating:4.6,reviewCount:14,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","sulaiman","solomon"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"21",name:"The Story of Prophet Dawud (David)",description:"The story of Prophet Dawud (David) and his psalms",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-dawud.jpg"],stock:30,featured:!1,rating:4.4,reviewCount:11,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","dawud","david"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"22",name:"The Story of Prophet Isa (Jesus)",description:"The story of Prophet Isa (Jesus) in Islamic perspective",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-isa.jpg"],stock:30,featured:!1,rating:4.5,reviewCount:16,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","isa","jesus"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"23",name:"The Story of Prophet Yunus (Jonah)",description:"The story of Prophet Yunus (Jonah) and the whale",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-yunus.jpg"],stock:30,featured:!1,rating:4.3,reviewCount:7,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","yunus","jonah"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"24",name:"The Story of Prophet Lut (Lot)",description:"The story of Prophet Lut (Lot) and his people",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-lut.jpg"],stock:30,featured:!1,rating:4.2,reviewCount:6,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","lut","lot"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"25",name:"The Story of Prophet Hud",description:"The story of Prophet Hud and his people of 'Ad",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-hud.jpg"],stock:30,featured:!1,rating:4.1,reviewCount:5,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","hud"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"26",name:"The Story of Prophet Shuaib",description:"The story of Prophet Shuaib and his people of Madyan",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-shuaib.jpg"],stock:30,featured:!1,rating:4.2,reviewCount:8,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","shuaib"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"27",name:"The Story of Prophet Idris (Enoch)",description:"The story of Prophet Idris (Enoch), the first tailor",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-idris.jpg"],stock:30,featured:!1,rating:4,reviewCount:4,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","idris","enoch"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"28",name:"The Story of Prophet Ismail (Ishmael)",description:"The story of Prophet Ismail (Ishmael), the son of Ibrahim",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-ismail.jpg"],stock:30,featured:!1,rating:4.3,reviewCount:9,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","ismail","ishmael"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"29",name:"The Story of Prophet Iyas",description:"The story of Prophet Iyas and his people",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-iyas.jpg"],stock:30,featured:!1,rating:4,reviewCount:3,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","iyas"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"30",name:"The Story of Prophet Yusha (Joshua)",description:"The story of Prophet Yusha (Joshua), successor of Musa",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-yusha.jpg"],stock:30,featured:!1,rating:4.1,reviewCount:6,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","yusha","joshua"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"31",name:"The Story of Prophet Ayman",description:"The story of Prophet Ayman and his people",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-ayman.jpg"],stock:30,featured:!1,rating:4,reviewCount:2,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","ayman"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"32",name:"The Story of Prophet Dhul-Kifl",description:"The story of Prophet Dhul-Kifl, known for his patience",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-dhul-kifl.jpg"],stock:30,featured:!1,rating:4.2,reviewCount:7,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","dhul-kifl"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"33",name:"The Story of Prophet Harun (Aaron)",description:"The story of Prophet Harun (Aaron), brother of Musa",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-harun.jpg"],stock:30,featured:!1,rating:4.3,reviewCount:8,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","harun","aaron"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"34",name:"The Story of Prophet Zakariya (Zachariah)",description:"The story of Prophet Zakariya (Zachariah) and his son Yahya",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-zakariya.jpg"],stock:30,featured:!1,rating:4.1,reviewCount:5,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","zakariya","zachariah"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"35",name:"The Story of Prophet Yahya (John)",description:"The story of Prophet Yahya (John), son of Zakariya",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-yahya.jpg"],stock:30,featured:!1,rating:4.4,reviewCount:9,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","yahya","john"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"36",name:"The Story of Prophet Salih",description:"The story of Prophet Salih and his people of Thamud",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-salih.jpg"],stock:30,featured:!1,rating:4.2,reviewCount:6,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","salih"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")},{id:"37",name:"The Story of Prophet Shammil",description:"The story of Prophet Shammil and his people",price:11.99,categoryId:"books-1",category:"Islamic Books",images:["/images/products/islamic-books/the-story-of-prophet-shammil.jpg"],stock:30,featured:!1,rating:4,reviewCount:3,reviews:[],sellerId:"seller-books",sellerName:"Islamic Bookstore",tags:["prophet","shammil"],createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")}],lt=[{id:"1",name:"Premium Fragrances",description:"Luxurious and sophisticated scents crafted with the finest ingredients for special occasions and evening wear.",image:"/images/categories/premium-fragrances.jpg",parentId:"",isActive:!0,sortOrder:1,productCount:24,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"2",name:"Everyday Scents",description:"Fresh and invigorating fragrances perfect for daily use and daytime activities.",image:"/images/categories/everyday-scents.jpg",parentId:"",isActive:!0,sortOrder:2,productCount:36,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"3",name:"Seasonal Collections",description:"Limited edition fragrances created for specific seasons and holidays.",image:"/images/categories/seasonal-collections.jpg",parentId:"",isActive:!0,sortOrder:3,productCount:15,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"4",name:"Unisex Fragrances",description:"Versatile scents designed to appeal to all genders, featuring balanced compositions of floral, woody, and fresh notes.",image:"/images/categories/unisex-fragrances.jpg",parentId:"",isActive:!0,sortOrder:4,productCount:28,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"books-1",name:"Islamic Books",description:"Collection of Islamic books and literature",image:"/images/products/islamic-books/placeholder-book-cover-1.svg",parentId:"",isActive:!0,sortOrder:5,productCount:34,createdAt:new Date("2024-04-01"),updatedAt:new Date("2024-04-01")}],ct=h.createContext(void 0),dt=()=>{const e=h.useContext(ct);if(!e)throw new Error("useProducts must be used within a ProductProvider");return e},ut=h.memo(({children:e})=>{const[t,s]=h.useState([]),[r,i]=h.useState([]),[a,o]=h.useState([]),[n,u]=h.useState(!1),[g,f]=h.useState(!1),[y,w]=h.useState(!1),[b,v]=h.useState(!1),[x,k]=h.useState(!1),{setError:j}=fe(),{user:S}=Me();h.useEffect(()=>{},[]),h.useEffect(()=>{},[t]),h.useEffect(()=>{},[a]),h.useEffect(()=>{},[n,g,y]),h.useEffect(()=>{},[x]);const C=h.useCallback(()=>m(null,null,function*(){try{const e=it("categories"),t=rt.get(e);t&&o(t);const s=new Promise((e,t)=>setTimeout(()=>t(new Error("Categories fetch timeout")),3e3)),{testDirectRestAPI:r}=yield pe(()=>m(null,null,function*(){const{testDirectRestAPI:e}=yield import("./vendor-db-CTXq6Blq.js").then(e=>e.M);return{testDirectRestAPI:e}}),__vite__mapDeps([3,2])),i=yield Promise.race([r(),s]);if(!i.success||!i.data)throw new Error(i.error||"Failed to fetch categories");{const t=i.data.map(e=>({id:e.id,name:e.name,slug:e.slug||e.name.toLowerCase().replace(/\s+/g,"-"),description:e.description||`${e.name} products`,imageUrl:e.image_url||"https://via.placeholder.com/400",parentId:e.parent_id,sortOrder:e.sort_order||0,isActive:!1!==e.is_active,createdAt:new Date(e.created_at||Date.now()),updatedAt:new Date(e.updated_at||Date.now())}));o(t),k(!1),rt.set(e,t,{ttl:36e5})}}catch(e){o([]),k(!1)}}),[j]),E=h.useCallback((e=6)=>m(null,null,function*(){try{v(!0);const t=it("featured-products",{limit:e}),s=st.get(t);s&&i(s);const r=new Promise((e,t)=>setTimeout(()=>t(new Error("Featured products fetch timeout")),15e3)),a=yield Promise.race([K(e),r]);i(a),k(!1),st.set(t,a,{ttl:18e5})}catch(t){i([]),k(!1)}finally{v(!1)}}),[j]),N=h.useCallback((e=!1)=>m(null,null,function*(){e&&u(!0),f(!0);try{const r=it("products-basic"),i=it("categories"),a=e?null:st.get(r),n=e?null:rt.get(i);if(a&&n&&!e)return s(a),o(n),f(!1),void u(!1);try{const e=yield X();o(e),rt.set(i,e,{ttl:36e5}),setTimeout(()=>m(null,null,function*(){try{const e=yield ee({limit:20}),t=e.map(e=>c(l({},e),{images:Array.isArray(e.images)?e.images:[],category:e.category||"",categoryId:e.categoryId||""}));s(t),st.set(r,t,{ttl:18e5});const i=e.map(e=>c(l({},e),{categoryId:e.category_id||"",images:e.image_url?[e.image_url]:[],rating:0,reviews:[],sellerId:e.seller_id||"",sellerName:"",tags:e.tags||[],reviewCount:0,createdAt:new Date(e.created_at||Date.now())}));s(i),st.set(r,e,{ttl:18e5}),k(!1),f(!1),setTimeout(()=>m(null,null,function*(){try{const e=yield te({limit:50});s(e),st.set("products-full",e,{ttl:18e5})}catch(e){}finally{w(!1)}}),1e3)}catch(e){s([]),f(!1)}}),100),k(!1)}catch(t){j("Failed to load data from database - using fallback content"),s(nt),o(lt),k(!0),f(!1)}}catch(r){r instanceof Error&&r.message.includes("infinite recursion")?j("DATABASE SETUP ERROR: Your database security policies are causing an infinite loop. This is a common setup issue. Please run the provided SQL script in your Supabase SQL Editor to fix it."):(j("Failed to load data from database - using fallback content"),s(nt),o(lt),k(!0)),f(!1),w(!1)}u(!1)}),[j]);h.useEffect(()=>{C();const e=setTimeout(()=>{N()},50),t=setTimeout(()=>{E()},200);return()=>{clearTimeout(e),clearTimeout(t)}},[N,C,E]);const P=e=>m(null,null,function*(){var t;try{const s=null==S?void 0:S.id,r=yield(e=>m(null,null,function*(){try{if(Qe(e,["name","description","price","categoryId"]),e.price<=0)throw new Error("Price must be greater than 0");const t=e.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),s=e.imageUrl?[e.imageUrl]:[],{data:r,error:i}=yield z.from("products").insert({name:e.name,description:e.description,price:e.price,category_id:e.categoryId,seller_id:e.sellerId||null,stock:e.stock||0,images:s,featured:e.featured||!1,slug:t,is_active:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}).select().single();if(i)throw i;return{id:r.id,name:r.name,description:r.description,price:parseFloat(r.price),categoryId:r.category_id,sellerId:r.seller_id,sellerName:"",stock:r.stock,images:r.images||[],tags:[],featured:r.featured,slug:r.slug,isActive:r.is_active,rating:0,reviewCount:0,reviews:[],createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}}catch(t){throw We(t,"Create Product"),t}}))({name:e.name,description:e.description,price:e.price,categoryId:e.categoryId,sellerId:s||"",stock:e.stock,imageUrl:(null==(t=e.images)?void 0:t[0])||"",featured:e.featured});r&&(at(),yield N(!0),j(null))}catch(s){j("Error adding product: "+(s instanceof Error?s.message:"Unknown error"))}}),A=e=>m(null,null,function*(){try{const t=e,{id:s,createdAt:r,reviews:i,rating:a,reviewCount:o}=t,n=d(t,["id","createdAt","reviews","rating","reviewCount"]),l=yield((e,t)=>m(null,null,function*(){try{if(!e)throw new Error("Product ID is required");if(void 0!==t.price&&t.price<=0)throw new Error("Price must be greater than 0");const s={updated_at:(new Date).toISOString()};void 0!==t.name&&(s.name=t.name),void 0!==t.description&&(s.description=t.description),void 0!==t.price&&(s.price=t.price),void 0!==t.categoryId&&(s.category_id=t.categoryId),void 0!==t.stock&&(s.stock=t.stock),void 0!==t.imageUrl&&(s.images=t.imageUrl?[t.imageUrl]:[]),void 0!==t.featured&&(s.featured=t.featured),void 0!==t.isActive&&(s.is_active=t.isActive);const{data:r,error:i}=yield z.from("products").update(s).eq("id",e).select().single();if(i)throw i;return{id:r.id,name:r.name,description:r.description,price:parseFloat(r.price),categoryId:r.category_id,sellerId:r.seller_id,sellerName:"",stock:r.stock,images:r.images||[],tags:[],featured:r.featured,slug:r.slug,isActive:r.is_active,rating:0,reviewCount:0,reviews:[],createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}}catch(s){throw We(s,"Update Product"),s}}))(s,n);l&&(at(),yield N(!0),j(null))}catch(t){j("Error updating product: "+(t instanceof Error?t.message:"Unknown error"))}}),I=(e,t)=>m(null,null,function*(){try{const t=yield(e=>m(null,null,function*(){try{if(!e)throw new Error("Product ID is required");const{error:t}=yield z.from("products").update({is_active:!1,updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;return!0}catch(t){throw We(t,"Delete Product"),t}}))(e);t&&(at(),yield N(!0),j(null))}catch(t){j("Error deleting product: "+(t instanceof Error?t.message:"Unknown error"))}}),D=e=>m(null,null,function*(){try{const{data:t,error:s}=yield z.from("reviews").select("*, profiles(full_name, avatar_url)").eq("product_id",e).order("created_at",{ascending:!1});return s?[]:t}catch(t){return[]}}),R=e=>m(null,null,function*(){try{const t={productId:e.productId||e.product_id,rating:e.rating,comment:e.comment,title:e.title,createdAt:new Date};(yield se(t))||j("Failed to submit review")}catch(t){j("Error submitting review: "+(t instanceof Error?t.message:"Unknown error"))}}),T=e=>m(null,null,function*(){try{const t=yield(e=>m(null,null,function*(){try{Qe(e,["name"]);const t=e.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),{data:s,error:r}=yield z.from("categories").insert({name:e.name,slug:t,description:e.description||null,image_url:e.imageUrl||null,is_active:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}).select().single();if(r)throw r;return{id:s.id,name:s.name,slug:s.slug,description:s.description,imageUrl:s.image_url,isActive:s.is_active,productCount:0,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)}}catch(t){throw We(t,"Create Category"),t}}))({name:e.name,description:e.description||"",imageUrl:e.image||""});if(t)return ot(),yield C(),j(null),Promise.resolve()}catch(t){return j("Error adding category: "+(t instanceof Error?t.message:"Unknown error")),Promise.reject(t)}}),q=e=>m(null,null,function*(){try{const t=e,{id:s,createdAt:r,updatedAt:i,productCount:a}=t,o=d(t,["id","createdAt","updatedAt","productCount"]),n=yield((e,t)=>m(null,null,function*(){try{if(!e)throw new Error("Category ID is required");const s={updated_at:(new Date).toISOString()};void 0!==t.name&&(s.name=t.name),void 0!==t.description&&(s.description=t.description),void 0!==t.imageUrl&&(s.image_url=t.imageUrl),void 0!==t.isActive&&(s.is_active=t.isActive);const{data:r,error:i}=yield z.from("categories").update(s).eq("id",e).select().single();if(i)throw i;return{id:r.id,name:r.name,slug:r.slug,description:r.description,imageUrl:r.image_url,isActive:r.is_active,productCount:0,createdAt:new Date(r.created_at),updatedAt:new Date(r.updated_at)}}catch(s){throw We(s,"Update Category"),s}}))(s,o);if(n)return ot(),yield C(),j(null),Promise.resolve()}catch(t){return j("Error updating category: "+(t instanceof Error?t.message:"Unknown error")),Promise.reject(t)}}),M=e=>m(null,null,function*(){try{const t=yield(e=>m(null,null,function*(){try{if(!e)throw new Error("Category ID is required");const{count:t}=yield z.from("products").select("*",{count:"exact",head:!0}).eq("category_id",e).eq("is_active",!0);if(t&&t>0)throw new Error("Cannot delete category with active products. Please move or delete products first.");const{error:s}=yield z.from("categories").update({is_active:!1,updated_at:(new Date).toISOString()}).eq("id",e);if(s)throw s;return!0}catch(t){throw We(t,"Delete Category"),t}}))(e);if(t)return ot(),yield C(),j(null),Promise.resolve()}catch(t){return j("Error deleting category: "+(t instanceof Error?t.message:"Unknown error")),Promise.reject(t)}}),_=h.useMemo(()=>({products:t,featuredProducts:r,categories:a,addProduct:P,updateProduct:A,deleteProduct:I,fetchReviewsForProduct:D,submitReview:R,fetchProducts:N,fetchCategories:C,fetchFeaturedProducts:E,loading:n,basicLoading:g,detailsLoading:y,featuredLoading:b,isUsingMockData:x,addCategory:T,updateCategory:q,deleteCategory:M}),[t,r,a,n,g,y,b,x,P,A,I,D,R,N,C,E,T,q,M]);return p.jsx(ct.Provider,{value:_,children:e})}),mt=h.createContext(void 0),ht=[{id:"1",name:"Royal Heritage Collection",slug:"royal-heritage",description:"Timeless fragrances inspired by royal traditions and ancient perfumery arts. Each bottle contains centuries of wisdom and craftsmanship, bringing you the essence of royal courts and majestic ceremonies.",shortDescription:"Royal-inspired luxury attars",image:"https://images.unsplash.com/photo-1541643600914-78b084683601?w=400",bannerImage:"https://images.unsplash.com/photo-1541643600914-78b084683601?w=800",type:"heritage",status:"active",price:299,originalPrice:399,discount:25,productIds:["1","2","3"],productCount:12,featured:!0,isExclusive:!0,launchDate:new Date("2024-01-15"),sortOrder:1,tags:["luxury","heritage","royal","exclusive"],metaTitle:"Royal Heritage Collection - Luxury Attars",metaDescription:"Discover our Royal Heritage Collection featuring timeless fragrances inspired by royal traditions.",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-15")},{id:"2",name:"Seasonal Blossoms",slug:"seasonal-blossoms",description:"Fresh floral compositions that capture the essence of each season. From spring cherry blossoms to autumn roses, experience nature's beauty in every drop.",shortDescription:"Seasonal floral fragrances",image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400",bannerImage:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800",type:"seasonal",status:"active",price:199,originalPrice:249,discount:20,productIds:["4","5","6"],productCount:8,featured:!0,isExclusive:!1,launchDate:new Date("2024-03-01"),endDate:new Date("2024-06-30"),sortOrder:2,tags:["floral","seasonal","fresh"],metaTitle:"Seasonal Blossoms Collection - Floral Attars",metaDescription:"Experience the beauty of seasonal flowers with our Seasonal Blossoms collection.",createdAt:new Date("2024-02-15"),updatedAt:new Date("2024-03-01")},{id:"3",name:"Limited Edition Oud",slug:"limited-oud",description:"Rare and precious oud compositions available for a limited time only. Sourced from the finest agarwood trees, these exclusive blends represent the pinnacle of oud craftsmanship.",shortDescription:"Exclusive limited oud collection",image:"https://images.unsplash.com/photo-1594736797933-d0401ba2fe65?w=400",bannerImage:"https://images.unsplash.com/photo-1594736797933-d0401ba2fe65?w=800",type:"limited",status:"coming_soon",price:599,originalPrice:799,discount:25,productIds:["7","8"],productCount:5,featured:!0,isExclusive:!0,launchDate:new Date("2024-12-01"),endDate:new Date("2025-02-28"),sortOrder:3,tags:["oud","limited","premium","rare"],metaTitle:"Limited Edition Oud Collection - Rare Attars",metaDescription:"Discover our exclusive Limited Edition Oud collection featuring rare and precious compositions.",createdAt:new Date("2024-10-01"),updatedAt:new Date("2024-11-15")},{id:"4",name:"Modern Fusion",slug:"modern-fusion",description:"Contemporary blends that merge traditional attars with modern perfumery techniques. Innovation meets tradition in these groundbreaking compositions.",shortDescription:"Modern attar innovations",image:"https://images.unsplash.com/photo-1588405748880-12d1d2a59d32?w=400",bannerImage:"https://images.unsplash.com/photo-1588405748880-12d1d2a59d32?w=800",type:"modern",status:"active",price:249,originalPrice:299,discount:17,productIds:["9","10","11"],productCount:10,featured:!1,isExclusive:!1,sortOrder:4,tags:["modern","fusion","contemporary"],metaTitle:"Modern Fusion Collection - Contemporary Attars",metaDescription:"Experience the future of fragrance with our Modern Fusion collection.",createdAt:new Date("2024-05-01"),updatedAt:new Date("2024-06-15")},{id:"5",name:"Signature Classics",slug:"signature-classics",description:"Our most beloved and iconic fragrances that have defined our brand for generations. These timeless classics continue to captivate and inspire.",shortDescription:"Iconic signature fragrances",image:"https://images.unsplash.com/photo-1592945403244-b3fbafd7f539?w=400",bannerImage:"https://images.unsplash.com/photo-1592945403244-b3fbafd7f539?w=800",type:"signature",status:"active",price:179,originalPrice:199,discount:10,productIds:["12","13","14","15"],productCount:15,featured:!0,isExclusive:!1,sortOrder:5,tags:["signature","classic","bestseller"],metaTitle:"Signature Classics Collection - Iconic Attars",metaDescription:"Discover our most beloved Signature Classics collection featuring iconic fragrances.",createdAt:new Date("2023-01-01"),updatedAt:new Date("2024-01-01")}],pt=({children:e})=>{const[t,s]=h.useState([]),[r,i]=h.useState(!0),[a,o]=h.useState(null),{showNotification:n}=Be();h.useEffect(()=>{m(null,null,function*(){try{i(!0),o(null),yield new Promise(e=>setTimeout(e,1e3)),s(ht)}catch(e){o("Failed to load collections")}finally{i(!1)}})},[]);const d=t.filter(e=>e.featured),u=t.filter(e=>"active"===e.status),g=e=>t.find(t=>t.id===e),f={collections:t,loading:r,error:a,featuredCollections:d,activeCollections:u,getCollectionById:g,getCollectionBySlug:e=>t.find(t=>t.slug===e),addCollection:e=>m(null,null,function*(){try{const t=c(l({},e),{id:Date.now().toString(),productCount:e.productIds.length,createdAt:new Date,updatedAt:new Date});return yield new Promise(e=>setTimeout(e,500)),s(e=>[...e,t]),n({type:"success",title:"Collection Created",message:`${t.name} has been successfully created.`}),t}catch(t){const e="Failed to create collection";throw o(e),n({type:"error",title:"Creation Failed",message:e}),new Error(e)}}),updateCollection:(e,t)=>m(null,null,function*(){try{const r=g(e);if(!r)throw new Error("Collection not found");const i=c(l(l({},r),t),{id:e,updatedAt:new Date});return yield new Promise(e=>setTimeout(e,500)),s(t=>t.map(t=>t.id===e?i:t)),n({type:"success",title:"Collection Updated",message:`${i.name} has been successfully updated.`}),i}catch(r){const e="Failed to update collection";throw o(e),n({type:"error",title:"Update Failed",message:e}),new Error(e)}}),deleteCollection:e=>m(null,null,function*(){try{const t=g(e);if(!t)throw new Error("Collection not found");yield new Promise(e=>setTimeout(e,500)),s(t=>t.filter(t=>t.id!==e)),n({type:"success",title:"Collection Deleted",message:`${t.name} has been successfully deleted.`})}catch(t){const e="Failed to delete collection";throw o(e),n({type:"error",title:"Deletion Failed",message:e}),new Error(e)}}),refreshCollections:()=>m(null,null,function*(){try{i(!0),o(null),yield new Promise(e=>setTimeout(e,1e3)),s([...ht]),n({type:"success",title:"Collections Refreshed",message:"Collection data has been refreshed successfully."})}catch(e){const t="Failed to refresh collections";o(t),n({type:"error",title:"Refresh Failed",message:t})}finally{i(!1)}})};return p.jsx(mt.Provider,{value:f,children:e})},gt=()=>{const e=h.useContext(mt);if(void 0===e)throw new Error("useCollections must be used within a CollectionProvider");return e},ft=h.createContext(void 0),yt=()=>{const e=h.useContext(ft);if(!e)throw new Error("useCompare must be used within a CompareProvider");return e},wt=({children:e})=>{const{user:t}=Me(),[s,r]=h.useState(()=>{const e=localStorage.getItem("compare");return e?JSON.parse(e):[]}),{showNotification:i}=Be(),[a,o]=h.useState(null);h.useEffect(()=>{localStorage.setItem("compare",JSON.stringify(s))},[s]),h.useEffect(()=>{a&&(i({type:"info",title:"Added to Compare",message:`${a.name} has been added to your compare list.`}),o(null))},[a,i]);const n=h.useCallback(e=>{t?r(t=>t.find(t=>t.id===e.id)?t:t.length>=4?(i({type:"error",title:"Compare List Full",message:"You can only compare up to 4 products at a time."}),t):(o(e),[...t,e])):i({type:"info",title:"Authentication Required",message:"Please log in or create an account to compare products."})},[i,t]),l=h.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]),c=h.useCallback(e=>s.some(t=>t.id===e),[s]),d=h.useCallback(()=>{r([])},[]),u={items:s,addItem:n,removeItem:l,isInCompare:c,clearCompare:d};return p.jsx(ft.Provider,{value:u,children:e})},bt=h.createContext(void 0),vt=()=>{const e=h.useContext(bt);if(!e)throw new Error("useOrders must be used within an OrderProvider");return e},xt=({children:e})=>{const{user:t}=Me(),{showNotification:s}=Be(),[r,i]=h.useState([]),[a,o]=h.useState(!1),n=h.useCallback(()=>m(null,null,function*(){if(t){o(!0);try{const e=yield re(t.id);i(e)}catch(e){s({type:"error",title:"Error",message:"Failed to load orders. Please try again later."})}finally{o(!1)}}else i([])}),[t,s]);h.useEffect(()=>{n()},[n]);const l={orders:r,loading:a,createOrder:(e,r,i,a)=>m(null,null,function*(){if(!t)return s({type:"error",title:"Authentication Required",message:"Please log in to place an order"}),null;o(!0);try{const t=yield oe({items:e,shippingAddress:r,billingAddress:void 0,paymentMethod:i});return t?(s({type:"success",title:"Order Placed",message:"Your order has been placed successfully!"}),yield n(),t):(s({type:"error",title:"Order Failed",message:"Failed to create order. Please try again."}),null)}catch(a){return s({type:"error",title:"Order Failed",message:"An unexpected error occurred. Please try again."}),null}finally{o(!1)}}),updateOrderStatus:(e,t)=>m(null,null,function*(){try{return(yield ae(e,t))?(yield n(),s({type:"success",title:"Status Updated",message:`Order status updated to ${t}`}),!0):(s({type:"error",title:"Update Failed",message:"Failed to update order status"}),!1)}catch(r){return s({type:"error",title:"Update Failed",message:"Failed to update order status. Please try again later."}),!1}}),getOrderById:e=>m(null,null,function*(){try{return yield ie(e)}catch(t){const s=r.find(t=>t.id===e);return s||null}}),getUserOrders:e=>m(null,null,function*(){const s=e||(null==t?void 0:t.id);if(!s)return[];try{return yield re(s)}catch(r){return[]}})};return p.jsx(bt.Provider,{value:l,children:e})},kt=h.createContext(void 0),jt=()=>{const e=h.useContext(kt);if(!e)throw new Error("useAddresses must be used within an AddressProvider");return e},St=({children:e})=>{const[t,s]=h.useState([]),[r,i]=h.useState(!1),{user:a}=Me(),{showNotification:o}=Be(),n=h.useCallback(()=>m(null,null,function*(){if(a){i(!0);try{const e=yield ne(a.id);s(e)}catch(e){o({type:"error",title:"Error",message:"Failed to fetch addresses"})}finally{i(!1)}}else s([])}),[a,o]);h.useEffect(()=>{n()},[n]);const l={addresses:t,addAddress:e=>m(null,null,function*(){if(a)try{(yield ue(e))?(yield n(),o({type:"success",title:"Address Added",message:"Your address has been added successfully"})):o({type:"error",title:"Error",message:"Failed to add address"})}catch(t){o({type:"error",title:"Error",message:"Failed to add address"})}else o({type:"error",title:"Authentication Required",message:"Please log in to add an address"})}),updateAddress:e=>m(null,null,function*(){try{(yield de(e))?(yield n(),o({type:"success",title:"Address Updated",message:"Your address has been updated successfully"})):o({type:"error",title:"Error",message:"Failed to update address"})}catch(t){o({type:"error",title:"Error",message:"Failed to update address"})}}),deleteAddress:e=>m(null,null,function*(){try{(yield ce(e))?(yield n(),o({type:"success",title:"Address Deleted",message:"Your address has been deleted successfully"})):o({type:"error",title:"Error",message:"Failed to delete address"})}catch(t){o({type:"error",title:"Error",message:"Failed to delete address"})}}),setDefaultAddress:(e,t)=>m(null,null,function*(){try{(yield le(e,t))?(yield n(),o({type:"success",title:"Default Address Set",message:`Default ${t} address has been updated`})):o({type:"error",title:"Error",message:"Failed to set default address"})}catch(s){o({type:"error",title:"Error",message:"Failed to set default address"})}}),fetchAddresses:n,loading:r};return p.jsx(kt.Provider,{value:l,children:e})},Ct="recentlyViewed";const Et=new class{constructor(){u(this,"sessionId"),this.sessionId=this.generateSessionId()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addProduct(e){try{const t=this.getRecentlyViewed().filter(t=>t.productId!==e),s=[{productId:e,viewedAt:Date.now(),sessionId:this.sessionId},...t].slice(0,20);localStorage.setItem(Ct,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("recentlyViewedUpdated",{detail:{productId:e,items:s}}))}catch(t){}}getRecentlyViewed(){try{const e=localStorage.getItem(Ct);if(!e)return[];const t=JSON.parse(e),s=Date.now()-2592e6,r=t.filter(e=>e.viewedAt>s);return r.length!==t.length&&localStorage.setItem(Ct,JSON.stringify(r)),r}catch(e){return[]}}getRecentlyViewedIds(){return this.getRecentlyViewed().map(e=>e.productId)}removeProduct(e){try{const t=this.getRecentlyViewed().filter(t=>t.productId!==e);localStorage.setItem(Ct,JSON.stringify(t)),window.dispatchEvent(new CustomEvent("recentlyViewedUpdated",{detail:{productId:e,items:t,action:"removed"}}))}catch(t){}}clearAll(){try{localStorage.removeItem(Ct),window.dispatchEvent(new CustomEvent("recentlyViewedUpdated",{detail:{items:[],action:"cleared"}}))}catch(e){}}getRecentlyViewedProducts(e){return this.getRecentlyViewedIds().map(t=>e.find(e=>e.id===t)).filter(e=>void 0!==e)}getAnalytics(){const e=this.getRecentlyViewed(),t=new Set(e.map(e=>e.productId)).size,s=new Set(e.map(e=>e.sessionId)).size,r={};e.forEach(e=>{const t=new Date(e.viewedAt).getHours();r[t]=(r[t]||0)+1});const i=Object.entries(r).map(([e,t])=>({hour:parseInt(e),count:t})).sort((e,t)=>e.hour-t.hour);return{totalViewed:e.length,uniqueProducts:t,averageViewsPerSession:s>0?e.length/s:0,topViewedCategories:[],viewingPatterns:i}}getViewingBasedRecommendations(e,t=8){const s=this.getRecentlyViewedProducts(e);if(0===s.length)return e.filter(e=>e.featured||e.rating>=4).sort((e,t)=>t.rating-e.rating).slice(0,t);const r=[...new Set(s.map(e=>e.category))],i=[...new Set(s.map(e=>e.brand).filter(Boolean))],a=new Set(s.map(e=>e.id));return e.filter(e=>!a.has(e.id)).map(e=>{let t=0;r.includes(e.category)&&(t+=30),e.brand&&i.includes(e.brand)&&(t+=20),t+=10*e.rating,e.featured&&(t+=15);const a=s.reduce((e,t)=>e+t.price,0)/s.length;return Math.abs(e.price-a)/a<=.5&&(t+=10),{product:e,score:t}}).sort((e,t)=>t.score-e.score).slice(0,t).map(e=>e.product)}isRecentlyViewed(e){return this.getRecentlyViewedIds().includes(e)}getLastViewedTime(e){const t=this.getRecentlyViewed().find(t=>t.productId===e);return t?t.viewedAt:null}},Nt=h.createContext(void 0),Pt=({children:e})=>{const{products:t}=dt(),[s,r]=h.useState({related:[],frequentlyBought:[],youMayLike:[],recentlyViewed:[],trending:[],newArrivals:[]}),[i,a]=h.useState(!1),[o,n]=h.useState(null),d=(e,t)=>{let s=0;e.category===t.category&&(s+=40);Math.abs(e.price-t.price)/Math.max(e.price,t.price)<=.3&&(s+=25),e.sellerName&&t.sellerName&&e.sellerName===t.sellerName&&(s+=20);if(Math.abs(e.rating-t.rating)<=.5&&(s+=10),e.tags&&t.tags){s+=e.tags.filter(e=>t.tags.includes(e)).length/Math.max(e.tags.length,t.tags.length)*5}return s},u=(e,s=4)=>{const r=t.find(t=>t.id===e);return r?t.filter(t=>t.id!==e).map(e=>({product:e,score:d(r,e)})).sort((e,t)=>t.score-e.score).slice(0,s).map(e=>e.product):[]},m=(e,s=3)=>{const r=t.find(t=>t.id===e);if(!r)return[];const i={"Oudh Attars":["Amber Attars","Sandalwood Attars","Musk Attars"],"Floral Attars":["Jasmine Attars","Rose Attars","Attar Blends"],"Musk Attars":["Oudh Attars","Amber Attars","Heritage Attars"],"Amber Attars":["Oudh Attars","Saffron Attars","Musk Attars"],"Saffron Attars":["Amber Attars","Heritage Attars","Attar Blends"],"Sandalwood Attars":["Oudh Attars","Musk Attars","Floral Attars"],"Jasmine Attars":["Floral Attars","Attar Blends","Seasonal Attars"],"Attar Blends":["Heritage Attars","Saffron Attars","Seasonal Attars"],"Seasonal Attars":["Attar Blends","Floral Attars","Jasmine Attars"],"Heritage Attars":["Oudh Attars","Saffron Attars","Attar Blends"]};return t.filter(t=>t.id!==e).map(e=>{var t;let s=0;r.category&&e.category&&(null==(t=i[r.category])?void 0:t.includes(e.category))?s+=50:r.category===e.category&&(s+=30);const a=e.price/r.price;return a>=.1&&a<=.6&&(s+=30),s+=10*e.rating,e.stock>0&&(s+=10),{product:e,score:s}}).sort((e,t)=>t.score-e.score).slice(0,s).map(e=>e.product)},g=(e=8)=>{const s=Et.getRecentlyViewedProducts(t);if(0===s.length)return t.filter(e=>e.featured||e.rating>=4).sort((e,t)=>e.featured&&!t.featured?-1:!e.featured&&t.featured?1:t.rating-e.rating).slice(0,e);const r=[...new Set(s.map(e=>e.category))],i=[...new Set(s.map(e=>e.sellerName).filter(Boolean))],a=s.reduce((e,t)=>e+t.price,0)/s.length,o=new Set(s.map(e=>e.id));return t.filter(e=>!o.has(e.id)).map(e=>{let t=0;r.includes(e.category)&&(t+=30),e.sellerName&&i.includes(e.sellerName)&&(t+=20),t+=5*e.rating,e.featured&&(t+=10);return Math.abs(e.price-a)/a<=.5&&(t+=10),e.stock>0&&(t+=5),t+=5*Math.random(),{product:e,score:t}}).sort((e,t)=>t.score-e.score).slice(0,e).map(e=>e.product)},f=(e=6)=>Et.getRecentlyViewedProducts(t).slice(0,e),y=(e=8)=>t.map(e=>({product:e,score:20*e.rating+(e.featured?30:0)+50*Math.random()})).sort((e,t)=>t.score-e.score).slice(0,e).map(e=>e.product),w=(e=8)=>t.filter(e=>e.createdAt).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,e),b=e=>{a(!0),n(null);try{const t={related:e?u(e):[],frequentlyBought:e?m(e):[],youMayLike:g(),recentlyViewed:f(),trending:y(),newArrivals:w()};r(t)}catch(t){n(t instanceof Error?t.message:"Failed to load recommendations")}finally{a(!1)}};h.useEffect(()=>{t.length>0&&b()},[t]),h.useEffect(()=>{const e=()=>{r(e=>c(l({},e),{recentlyViewed:f(),youMayLike:g()}))};return window.addEventListener("recentlyViewedUpdated",e),()=>window.removeEventListener("recentlyViewedUpdated",e)},[t]);const v={recommendations:s,loading:i,error:o,getRelatedProducts:u,getFrequentlyBoughtTogether:m,getPersonalizedRecommendations:g,getRecentlyViewed:f,getTrendingProducts:y,getNewArrivals:w,addToRecentlyViewed:e=>{Et.addProduct(e),r(e=>c(l({},e),{recentlyViewed:f()}))},removeFromRecentlyViewed:e=>{Et.removeProduct(e),r(e=>c(l({},e),{recentlyViewed:f()}))},clearRecentlyViewed:()=>{Et.clearAll(),r(e=>c(l({},e),{recentlyViewed:[]}))},getRecommendationAnalytics:()=>({recentlyViewed:Et.getAnalytics(),totalRecommendations:Object.values(s).flat().length,categoriesRepresented:[...new Set(Object.values(s).flat().map(e=>e.category))].length,averageRating:Object.values(s).flat().reduce((e,t)=>e+t.rating,0)/Object.values(s).flat().length||0}),refreshRecommendations:b};return p.jsx(Nt.Provider,{value:v,children:e})},At=()=>{const e=h.useContext(Nt);if(void 0===e)throw new Error("useRecommendations must be used within a RecommendationsProvider");return e},It={neutral:{primary:{50:"#f8fafc",100:"#f1f5f9",500:"#475569",600:"#334155",700:"#1e293b",900:"#020617"},secondary:{50:"#fafaf9",100:"#f5f5f4",500:"#78716c",600:"#57534e",700:"#44403c",900:"#1c1917"}},warm:{primary:{50:"#fef7ed",100:"#fdedd3",500:"#ea580c",600:"#dc2626",700:"#b91c1c",900:"#7c2d12"},secondary:{50:"#fefce8",100:"#fef3c7",500:"#eab308",600:"#ca8a04",700:"#a16207",900:"#713f12"}},cool:{primary:{50:"#eff6ff",100:"#dbeafe",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",900:"#1e3a8a"},secondary:{50:"#f0fdfa",100:"#ccfbf1",500:"#14b8a6",600:"#0d9488",700:"#0f766e",900:"#134e4a"}},vibrant:{primary:{50:"#fdf4ff",100:"#fae8ff",500:"#a855f7",600:"#9333ea",700:"#7c3aed",900:"#581c87"},secondary:{50:"#fef2f2",100:"#fee2e2",500:"#ef4444",600:"#dc2626",700:"#b91c1c",900:"#7f1d1d"}},monochrome:{primary:{50:"#f9fafb",100:"#f3f4f6",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"},secondary:{50:"#f9fafb",100:"#f3f4f6",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"}}},Dt={compact:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.75rem",lineHeight:"1rem"},sm:{size:"0.875rem",lineHeight:"1.25rem"},base:{size:"1rem",lineHeight:"1.5rem"},lg:{size:"1.125rem",lineHeight:"1.75rem"},xl:{size:"1.25rem",lineHeight:"1.75rem"},"2xl":{size:"1.5rem",lineHeight:"2rem"},"3xl":{size:"1.875rem",lineHeight:"2.25rem"},"4xl":{size:"2.25rem",lineHeight:"2.5rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}},comfortable:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.8125rem",lineHeight:"1.125rem"},sm:{size:"0.9375rem",lineHeight:"1.375rem"},base:{size:"1.0625rem",lineHeight:"1.625rem"},lg:{size:"1.1875rem",lineHeight:"1.875rem"},xl:{size:"1.3125rem",lineHeight:"1.875rem"},"2xl":{size:"1.5625rem",lineHeight:"2.125rem"},"3xl":{size:"1.9375rem",lineHeight:"2.375rem"},"4xl":{size:"2.3125rem",lineHeight:"2.625rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}},spacious:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.875rem",lineHeight:"1.25rem"},sm:{size:"1rem",lineHeight:"1.5rem"},base:{size:"1.125rem",lineHeight:"1.75rem"},lg:{size:"1.25rem",lineHeight:"2rem"},xl:{size:"1.375rem",lineHeight:"2rem"},"2xl":{size:"1.625rem",lineHeight:"2.25rem"},"3xl":{size:"2rem",lineHeight:"2.5rem"},"4xl":{size:"2.375rem",lineHeight:"2.75rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}}},Rt={none:{sm:"0px",default:"0px",md:"0px",lg:"0px",xl:"0px",full:"0px"},small:{sm:"2px",default:"4px",md:"6px",lg:"8px",xl:"12px",full:"9999px"},medium:{sm:"4px",default:"6px",md:"8px",lg:"12px",xl:"16px",full:"9999px"},large:{sm:"6px",default:"8px",md:"12px",lg:"16px",xl:"24px",full:"9999px"},full:{sm:"9999px",default:"9999px",md:"9999px",lg:"9999px",xl:"9999px",full:"9999px"}},Tt=()=>{const[e,t]=h.useState(()=>"undefined"==typeof window?{mode:"light",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}:function(){try{const e=localStorage.getItem("theme_preferences");if(e)return l(l({},{mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}),JSON.parse(e))}catch(e){}return{mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}}()),[s,r]=h.useState(()=>"undefined"==typeof window?{prefersDark:!1,prefersReducedMotion:!1,prefersHighContrast:!1}:qt()),i=h.useMemo(()=>{const t="light",s=It[e.colorScheme],r=Dt[e.fontScale],i=Rt[e.borderRadius],a=function(e){const t=!1;return{primary:e.primary||It.neutral.primary,secondary:e.secondary||It.neutral.secondary,accent:e.primary||It.neutral.primary,neutral:It.neutral.primary,semantic:{success:{50:"#f0fdf4",500:"#22c55e",600:"#16a34a",700:"#15803d"},warning:{50:"#fffbeb",500:"#f59e0b",600:"#d97706",700:"#b45309"},error:{50:"#fef2f2",500:"#ef4444",600:"#dc2626",700:"#b91c1c"},info:{50:"#eff6ff",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8"}},background:{primary:t?"#0f172a":"#ffffff",secondary:t?"#1e293b":"#f8fafc",tertiary:t?"#334155":"#f1f5f9",overlay:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)"},text:{primary:t?"#f8fafc":"#0f172a",secondary:t?"#cbd5e1":"#475569",tertiary:t?"#94a3b8":"#64748b",inverse:t?"#0f172a":"#f8fafc",disabled:t?"#64748b":"#94a3b8"},border:{subtle:t?"#334155":"#e2e8f0",default:t?"#475569":"#cbd5e1",strong:t?"#64748b":"#94a3b8",interactive:t?"#3b82f6":"#2563eb"}}}(s,0,e.highContrast);return{mode:t,colorScheme:e.colorScheme,colors:a,typography:r,spacing:{scale:"compact"===e.fontScale?.875:"spacious"===e.fontScale?1.125:1,base:16,sizes:Mt(e.fontScale)},borderRadius:e.borderRadius,animationLevel:e.reducedMotion?"none":e.animationLevel,fontScale:e.fontScale,customProperties:_t(a,r,i)}},[e,s]),a=h.useCallback(e=>{t(t=>{const s=l(l({},t),e);return function(e){try{localStorage.setItem("theme_preferences",JSON.stringify(e))}catch(t){}}(s),s})},[]);return h.useEffect(()=>{!function(e){const t=document.documentElement;Object.entries(e.customProperties).forEach(([e,s])=>{t.style.setProperty(e,s)}),t.className=t.className.replace(/theme-\w+/g,""),t.classList.add(`theme-${e.mode}`),t.classList.add(`color-scheme-${e.colorScheme}`),t.classList.add(`font-scale-${e.fontScale}`),t.classList.add(`border-radius-${e.borderRadius}`),t.classList.add(`animation-${e.animationLevel}`),t.style.colorScheme="light"}(i)},[i]),h.useEffect(()=>{const e=[window.matchMedia("(prefers-color-scheme: dark)"),window.matchMedia("(prefers-reduced-motion: reduce)"),window.matchMedia("(prefers-contrast: high)")],t=()=>{r(qt())};return e.forEach(e=>e.addEventListener("change",t)),()=>{e.forEach(e=>e.removeEventListener("change",t))}},[]),{preferences:e,themeConfig:i,systemPreferences:s,updatePreferences:a,resetToDefaults:()=>a({mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1})}};function qt(){return{prefersDark:window.matchMedia("(prefers-color-scheme: dark)").matches,prefersReducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,prefersHighContrast:window.matchMedia("(prefers-contrast: high)").matches||window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia("(forced-colors: active)").matches}}function Mt(e){const t=16*("compact"===e?.875:"spacious"===e?1.125:1);return{xs:.25*t+"px",sm:.5*t+"px",md:1*t+"px",lg:1.5*t+"px",xl:2*t+"px","2xl":3*t+"px","3xl":4*t+"px","4xl":6*t+"px"}}function _t(e,t,s){const r={};return Object.entries(e.background).forEach(([e,t])=>{r[`--color-background-${e}`]=t}),Object.entries(e.text).forEach(([e,t])=>{r[`--color-text-${e}`]=t}),Object.entries(e.border).forEach(([e,t])=>{r[`--color-border-${e}`]=t}),r["--font-family-sans"]=t.fontFamily.sans.join(", "),r["--font-family-serif"]=t.fontFamily.serif.join(", "),r["--font-family-mono"]=t.fontFamily.mono.join(", "),Object.entries(s).forEach(([e,t])=>{r[`--border-radius-${e}`]=t}),r}const Ot=h.createContext(void 0),Bt=()=>{const e=h.useContext(Ot);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},Ft=({children:e})=>{const{preferences:t,themeConfig:s,systemPreferences:r,updatePreferences:i,resetToDefaults:a}=Tt();h.useEffect(()=>{const e=`Theme changed to ${s.mode} mode with ${s.colorScheme} color scheme`,t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},1e3)},[s.mode,s.colorScheme]);const o={themeConfig:s,preferences:t,systemPreferences:r,setMode:e=>i({mode:e}),setColorScheme:e=>i({colorScheme:e}),setFontScale:e=>i({fontScale:e}),setBorderRadius:e=>i({borderRadius:e}),setAnimationLevel:e=>i({animationLevel:e}),toggleHighContrast:()=>i({highContrast:!t.highContrast}),toggleReducedMotion:()=>i({reducedMotion:!t.reducedMotion}),updatePreferences:i,resetToDefaults:a,theme:s.mode,actualTheme:s.mode};return p.jsx(Ot.Provider,{value:o,children:e})},Lt=({isOpen:e,onClose:t,initialMode:s="login"})=>{const[r,i]=h.useState(s),[a,o]=h.useState(!1),[n,d]=h.useState(!1),[u,w]=h.useState(!1),[b,v]=h.useState(1),[x,k]=h.useState(!1),{signIn:j,signUp:_}=Me(),{showNotification:O}=Be(),[B,U]=h.useState({email:"",password:"",confirmPassword:"",fullName:"",phone:"",dateOfBirth:"",address:"",agreeToTerms:!1,subscribeNewsletter:!0}),[$,z]=h.useState({});h.useEffect(()=>(e?(i(s),v(1),U({email:"",password:"",confirmPassword:"",fullName:"",phone:"",dateOfBirth:"",address:"",agreeToTerms:!1,subscribeNewsletter:!0}),z({}),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e,s]);const V=e=>{const t=[];return e.length<8&&t.push("At least 8 characters"),/[A-Z]/.test(e)||t.push("One uppercase letter"),/[a-z]/.test(e)||t.push("One lowercase letter"),/\d/.test(e)||t.push("One number"),/[!@#$%^&*(),.?":{}|<>]/.test(e)||t.push("One special character"),{isValid:0===t.length,errors:t}},H=(e,t)=>{U(s=>c(l({},s),{[e]:t})),$[e]&&z(t=>{const s=l({},t);return delete s[e],s})},W=e=>{const t=V(e),s=Math.max(0,5-t.errors.length);return 0===s?{strength:0,label:"Very Weak",color:"bg-red-500"}:s<=2?{strength:20*s,label:"Weak",color:"bg-orange-500"}:s<=3?{strength:20*s,label:"Fair",color:"bg-yellow-500"}:s<=4?{strength:20*s,label:"Good",color:"bg-blue-500"}:{strength:100,label:"Strong",color:"bg-green-500"}};return e?p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-hidden",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",margin:0,padding:"1rem"},children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden border border-neutral-200 relative",style:{position:"relative",maxHeight:"90vh",overflow:"hidden",margin:"auto",zIndex:1e4,width:"100%",maxWidth:"48rem"},children:[p.jsxs("div",{className:"relative bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 flex-shrink-0",children:[p.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors duration-200","aria-label":"Close",children:p.jsx(f,{className:"h-5 w-5"})}),"login"!==r&&"verify"!==r&&p.jsx("button",{onClick:()=>{"signup"===r&&2===b?v(1):i("login")},className:"absolute top-4 left-4 p-2 hover:bg-white hover:bg-opacity-20 rounded-full transition-colors","aria-label":"Back",children:p.jsx(g,{className:"h-5 w-5"})}),p.jsxs("div",{className:"text-center mt-6",children:[p.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:"verify"===r?p.jsx(F,{className:"h-8 w-8"}):"forgot"===r||"reset"===r?p.jsx(q,{className:"h-8 w-8"}):p.jsx(I,{className:"h-8 w-8"})}),p.jsxs("h2",{className:"text-2xl font-bold",children:["login"===r&&"Welcome to Aligarh Attar House","signup"===r&&(1===b?"Create Account":"Complete Profile"),"forgot"===r&&"Reset Password","verify"===r&&"Check Your Email","reset"===r&&"New Password"]}),p.jsxs("p",{className:"text-indigo-100 mt-2",children:["login"===r&&"Sign in to discover premium attars","signup"===r&&(1===b?"Join our community of fragrance lovers":"Tell us about yourself"),"forgot"===r&&"Enter your email to reset your password","verify"===r&&"We sent a verification link to your email","reset"===r&&"Enter your new password"]})]})]}),p.jsx("div",{className:"p-6 overflow-y-auto flex-grow",children:"verify"===r?p.jsxs("div",{className:"text-center space-y-4",children:[p.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:p.jsx(y,{className:"h-10 w-10 text-green-600"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Verification Email Sent"}),p.jsxs("p",{className:"text-gray-600 mt-2",children:["We've sent a verification link to ",p.jsx("strong",{children:B.email})]}),p.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Didn't receive the email? Check your spam folder or"," ",p.jsx("button",{className:"text-indigo-600 hover:text-indigo-700 font-medium",children:"resend verification email"})]})]}),p.jsx("button",{onClick:()=>i("login"),className:"w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Back to Login"})]}):p.jsxs("form",{onSubmit:e=>m(null,null,function*(){if(e.preventDefault(),(()=>{const e={};var t;if(B.email?(t=B.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||(e.email="Please enter a valid email address")):e.email="Email is required",B.password){if("signup"===r){const t=V(B.password);t.isValid||(e.password=t.errors.join(", "))}}else e.password="Password is required";return"signup"===r&&(1===b&&B.password!==B.confirmPassword&&(e.confirmPassword="Passwords do not match"),2===b&&(B.fullName.trim()||(e.fullName="Full name is required"),B.agreeToTerms||(e.agreeToTerms="You must agree to the terms and conditions"),B.phone&&!/^\+?[\d\s-()]+$/.test(B.phone)&&(e.phone="Please enter a valid phone number"),B.address.trim()||(e.address="Address is required"))),z(e),0===Object.keys(e).length})()){w(!0);try{"login"===r?(yield j(B.email,B.password),O({type:"success",title:"Welcome back!",message:"Successfully logged in."}),t()):"signup"===r?1===b?v(2):(yield _(B.email,B.password,{fullName:B.fullName,phone:B.phone,dateOfBirth:B.dateOfBirth,address:B.address,subscribeNewsletter:B.subscribeNewsletter}),i("verify"),O({type:"success",title:"Account created!",message:"Please check your email to verify your account."})):"forgot"===r&&(O({type:"success",title:"Password reset link sent!",message:"Check your email for instructions."}),i("login"))}catch(s){const e=s instanceof Error?s.message:"An error occurred. Please try again.";O({type:"error",title:"Authentication Error",message:e})}finally{w(!1)}}}),className:"space-y-4",children:[("login"===r||"signup"===r&&1===b)&&p.jsxs("div",{className:"text-center mb-6",children:[p.jsxs("div",{className:"inline-flex items-center justify-center space-x-2 bg-gradient-to-r from-purple-100 to-indigo-100 rounded-full px-4 py-2 mb-4",children:[p.jsx(S,{className:"h-5 w-5 text-purple-600"}),p.jsx("span",{className:"text-sm font-semibold text-purple-800",children:"Premium Attar Collection"}),p.jsx(C,{className:"h-5 w-5 text-amber-500"})]}),p.jsx("p",{className:"text-sm text-gray-600",children:"Experience the finest natural perfumes from around the world"})]}),("login"===r||"forgot"===r||"signup"===r&&1===b)&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Email Address"}),p.jsxs("div",{className:"relative",children:[p.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-text-tertiary"}),p.jsx("input",{type:"email",value:B.email,onChange:e=>H("email",e.target.value),className:"input-field-luxury pl-10 "+($.email?"border-state-error focus:border-state-error focus:ring-state-error/20":""),placeholder:"Enter your email",disabled:u,required:!0})]}),$.email&&p.jsxs("p",{className:"mt-2 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.email]})]}),("login"===r||"reset"===r||"signup"===r&&1===b)&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Password"}),p.jsxs("div",{className:"relative",children:[p.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-neutral-400"}),p.jsx("input",{type:a?"text":"password",value:B.password,onChange:e=>H("password",e.target.value),className:"form-input pl-10 pr-12 "+($.password?"form-input-error":""),placeholder:"Enter your password",disabled:u,required:!0}),p.jsx("button",{type:"button",onClick:()=>o(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-400 hover:text-neutral-600 transition-colors duration-200","aria-label":a?"Hide password":"Show password",children:a?p.jsx(P,{className:"h-5 w-5"}):p.jsx(A,{className:"h-5 w-5"})})]}),$.password&&p.jsxs("p",{className:"mt-2 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.password]}),"signup"===r&&1===b&&B.password&&p.jsxs("div",{className:"mt-3",children:[p.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[p.jsx("span",{children:"Password Strength"}),p.jsx("span",{className:"font-medium",children:W(B.password).label})]}),p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:p.jsx("div",{className:`h-2 rounded-full ${W(B.password).color} transition-all duration-300`,style:{width:`${W(B.password).strength}%`}})}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use 8+ characters with a mix of letters, numbers & symbols"})]})]}),"signup"===r&&1===b&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Confirm Password"}),p.jsxs("div",{className:"relative",children:[p.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-neutral-400"}),p.jsx("input",{type:n?"text":"password",value:B.confirmPassword,onChange:e=>H("confirmPassword",e.target.value),className:"form-input pl-10 pr-12 "+($.confirmPassword?"form-input-error":""),placeholder:"Confirm your password",disabled:u,required:!0}),p.jsx("button",{type:"button",onClick:()=>d(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-400 hover:text-neutral-600 transition-colors duration-200","aria-label":n?"Hide password":"Show password",children:n?p.jsx(P,{className:"h-5 w-5"}):p.jsx(A,{className:"h-5 w-5"})})]}),$.confirmPassword&&p.jsxs("p",{className:"mt-2 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.confirmPassword]})]}),"signup"===r&&2===b&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Full Name"}),p.jsxs("div",{className:"relative",children:[p.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-neutral-400"}),p.jsx("input",{type:"text",value:B.fullName,onChange:e=>H("fullName",e.target.value),className:"form-input pl-10 "+($.fullName?"form-input-error":""),placeholder:"Enter your full name",disabled:u,required:!0})]}),$.fullName&&p.jsxs("p",{className:"mt-2 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.fullName]})]}),"signup"===r&&2===b&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Phone Number"}),p.jsxs("div",{className:"relative",children:[p.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-neutral-400"}),p.jsx("input",{type:"tel",value:B.phone,onChange:e=>H("phone",e.target.value),className:"form-input pl-10 "+($.phone?"form-input-error":""),placeholder:"Enter your phone number",disabled:u,required:!0})]}),$.phone&&p.jsxs("p",{className:"mt-2 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.phone]})]}),"signup"===r&&2===b&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Date of Birth"}),p.jsxs("div",{className:"relative",children:[p.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-neutral-400"}),p.jsx("input",{type:"date",value:B.dateOfBirth,onChange:e=>H("dateOfBirth",e.target.value),className:"form-input pl-10",disabled:u,required:!0})]})]}),"signup"===r&&2===b&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Address"}),p.jsxs("div",{className:"relative",children:[p.jsxs("svg",{className:"absolute left-3 top-3 h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),p.jsx("textarea",{value:B.address,onChange:e=>H("address",e.target.value),className:"form-input pl-10",placeholder:"Enter your full address",disabled:u,rows:3,required:!0})]}),$.address&&p.jsxs("p",{className:"mt-2 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.address]})]}),"login"===r&&p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",checked:x,onChange:e=>k(e.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",disabled:u}),p.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),p.jsx("button",{type:"button",onClick:()=>i("forgot"),className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Forgot password?"})]}),"signup"===r&&2===b&&p.jsxs("div",{className:"flex items-start",children:[p.jsx("div",{className:"flex items-center h-5",children:p.jsx("input",{id:"subscribe-newsletter",name:"subscribe-newsletter",type:"checkbox",checked:B.subscribeNewsletter,onChange:e=>H("subscribeNewsletter",e.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",disabled:u})}),p.jsxs("div",{className:"ml-3 text-sm",children:[p.jsx("label",{htmlFor:"subscribe-newsletter",className:"font-medium text-gray-700",children:"Subscribe to our newsletter"}),p.jsx("p",{className:"text-gray-500",children:"Get updates on new arrivals and special offers"})]})]}),"signup"===r&&2===b&&p.jsxs("div",{className:"flex items-start",children:[p.jsx("div",{className:"flex items-center h-5",children:p.jsx("input",{id:"terms-agreement",name:"terms-agreement",type:"checkbox",checked:B.agreeToTerms,onChange:e=>H("agreeToTerms",e.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded "+($.agreeToTerms?"border-state-error":""),disabled:u,required:!0})}),p.jsxs("div",{className:"ml-3 text-sm",children:[p.jsxs("label",{htmlFor:"terms-agreement",className:"font-medium text-gray-700",children:["I agree to the ",p.jsx("a",{href:"#",className:"text-indigo-600 hover:text-indigo-500",children:"Terms and Conditions"})]}),$.agreeToTerms&&p.jsxs("p",{className:"mt-1 text-sm text-state-error flex items-center",children:[p.jsx(E,{className:"h-4 w-4 mr-1"}),$.agreeToTerms]})]})]}),p.jsx("div",{children:p.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:u?p.jsxs(p.Fragment,{children:[p.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"login"===r?"Sign In":"signup"===r&&1===b?"Continue":"signup"===r&&2===b?"Create Account":"forgot"===r?"Send Reset Link":"Submit"})}),p.jsx("div",{className:"text-center text-sm text-gray-600",children:"login"===r?p.jsxs("p",{children:["Don't have an account?"," ",p.jsx("button",{type:"button",onClick:()=>i("signup"),className:"font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Sign up"})]}):"signup"===r?p.jsxs("p",{children:["Already have an account?"," ",p.jsx("button",{type:"button",onClick:()=>i("login"),className:"font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Sign in"})]}):"forgot"===r?p.jsxs("p",{children:["Remember your password?"," ",p.jsx("button",{type:"button",onClick:()=>i("login"),className:"font-medium text-indigo-600 hover:text-indigo-500",disabled:u,children:"Sign in"})]}):null}),("login"===r||"signup"===r&&1===b)&&p.jsx("div",{className:"pt-4 border-t border-gray-200",children:p.jsxs("div",{className:"flex items-center justify-center space-x-4 text-xs text-gray-500",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx(q,{className:"h-4 w-4 mr-1 text-green-500"}),p.jsx("span",{children:"Secure"})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(M,{className:"h-4 w-4 mr-1 text-blue-500"}),p.jsx("span",{children:"Private"})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(L,{className:"h-4 w-4 mr-1 text-purple-500"}),p.jsx("span",{children:"Trusted"})]})]})})]})})]})}):null},Ut=h.createContext(void 0),$t=()=>{const e=h.useContext(Ut);if(!e)throw new Error("useAuthModal must be used within an AuthModalProvider");return e},zt=({children:e})=>{const[t,s]=h.useState(!1),[r,i]=h.useState(null),[a,o]=h.useState(null),n=()=>{s(!1),i(null),o(null)},l={showAuthModal:(e,t)=>{o(e),i(t),s(!0)},hideAuthModal:n,isModalOpen:t,modalAction:r,selectedProduct:a};return p.jsxs(Ut.Provider,{value:l,children:[e,t&&a&&U.createPortal(p.jsx(Lt,{isOpen:t,onClose:()=>{n()},initialMode:"login"}),document.body)]})},Vt=h.createContext(void 0),Ht=({children:e})=>{const{user:t}=Me(),{showNotification:s}=Be(),[r,i]=h.useState({isSecureConnection:!1,hasValidSession:!1,rateLimitStatus:{userCreation:!0,emailSending:!0}}),[a,o]=h.useState([]),[n,d]=h.useState("");h.useEffect(()=>{u(),m(),g();const e=setInterval(()=>{m(),y()},6e4);return()=>clearInterval(e)},[]);const u=()=>{const e="https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname;i(t=>c(l({},t),{isSecureConnection:e})),e||s({type:"warning",title:"Insecure Connection",message:"Please use HTTPS for secure data transmission."})},m=()=>{const e=!!t&&!!t.id;i(t=>c(l({},t),{hasValidSession:e}))},g=()=>{const e=btoa(Math.random().toString()).substr(10,32);d(e),sessionStorage.setItem("csrf_token",e)},f=e=>{o(t=>[...t,e]),"permission_denied"!==e.type&&"suspicious_activity"!==e.type||s({type:"error",title:"Access Denied",message:"You do not have permission to perform this action."})},y=()=>{o(e=>e.slice(-100))},w={isSecureConnection:r.isSecureConnection,hasValidSession:r.hasValidSession,rateLimitStatus:r.rateLimitStatus,checkPermission:(e,s)=>{if(!t)return f({type:"permission_denied",action:e,resource:s,details:{reason:"No authenticated user"},timestamp:new Date}),!1;const r=t.role,i={user_management:{create:["admin"],read:["admin","seller"],update:["admin"],delete:["admin"],bulk_operations:["admin"]},email_operations:{send_welcome:["admin"],send_confirmation:["admin"],resend_confirmation:["admin"]},system_settings:{read:["admin"],update:["admin"]}}[s||"user_management"];if(!i)return!1;const a=i[e];if(!a)return!1;const o=a.includes(r);return o||f({type:"permission_denied",action:e,resource:s,details:{userRole:r,requiredRoles:a},timestamp:new Date}),o},logSecurityEvent:f,validateCSRF:e=>e===sessionStorage.getItem("csrf_token")&&e===n};return p.jsx(Vt.Provider,{value:w,children:e})},Wt=()=>{const e=h.useContext(Vt);if(!e)throw new Error("useSecurity must be used within a SecurityProvider");return e},Qt=h.memo(({children:e})=>p.jsx(ye,{children:p.jsx(Ft,{children:p.jsx(Fe,{children:p.jsx(_e,{children:p.jsx(Ht,{children:p.jsx(zt,{children:p.jsx(ut,{children:p.jsx(pt,{children:p.jsx($e,{children:p.jsx(He,{children:p.jsx(wt,{children:p.jsx(xt,{children:p.jsx(St,{children:p.jsx(Pt,{children:e})})})})})})})})})})})})})}));Qt.displayName="CombinedProvider";const Jt=({href:e,children:t})=>p.jsx("a",{href:e,className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:rounded-md focus:shadow-lg",onFocus:e=>e.currentTarget.classList.remove("sr-only"),onBlur:e=>e.currentTarget.classList.add("sr-only"),children:t}),Gt=Object.freeze(Object.defineProperty({__proto__:null,SkipLink:Jt,initializeAccessibility:()=>{var e;if(!document.querySelector("main")){const t=document.querySelector('#main-content, .main-content, [role="main"]');if(t&&"MAIN"!==t.tagName){const s=document.createElement("main");s.id="main-content",null==(e=t.parentNode)||e.insertBefore(s,t),s.appendChild(t)}}document.addEventListener("keydown",e=>{if("Escape"===e.key){document.querySelectorAll('[role="dialog"][aria-hidden="false"]').forEach(e=>{const t=e.querySelector('[data-close], [aria-label*="close"]');t&&t.click()})}})}},Symbol.toStringTag,{value:"Module"})),Yt=()=>m(null,null,function*(){try{return!0}catch(e){return!1}});const Zt=new class{constructor(){u(this,"registration",null),u(this,"updateCheckInterval",null),this.setupUpdateChecking()}register(){return m(this,null,function*(){if(!this.isSupported())return null;try{return this.registration=yield navigator.serviceWorker.register("/sw.js",{scope:"/"}),this.registration.addEventListener("updatefound",()=>{var e;const t=null==(e=this.registration)?void 0:e.installing;t&&this.handleServiceWorkerUpdate(t)}),navigator.serviceWorker.addEventListener("message",e=>{this.handleServiceWorkerMessage(e)}),this.registration}catch(e){return null}})}unregister(){return m(this,null,function*(){if(!this.registration)return!1;try{const e=yield this.registration.unregister();return this.registration=null,this.updateCheckInterval&&(clearInterval(this.updateCheckInterval),this.updateCheckInterval=null),e}catch(e){return!1}})}update(){return m(this,null,function*(){if(this.registration)try{yield this.registration.update()}catch(e){}})}clearCache(){return m(this,null,function*(){return this.sendMessage("CLEAR_CACHE")})}getCacheStats(){return m(this,null,function*(){return(yield this.sendMessage("CACHE_STATS")).stats})}prefetchResources(e){return m(this,null,function*(){return this.sendMessage("PREFETCH_RESOURCES",{urls:e})})}isSupported(){return"serviceWorker"in navigator}getRegistration(){return this.registration}sendMessage(e,t){return m(this,null,function*(){if(!navigator.serviceWorker.controller)throw new Error("No service worker controller available");return new Promise((s,r)=>{const i=new MessageChannel;i.port1.onmessage=e=>{e.data.error?r(new Error(e.data.error)):s(e.data)},navigator.serviceWorker.controller.postMessage({type:e,payload:t},[i.port2])})})}handleServiceWorkerUpdate(e){e.addEventListener("statechange",()=>{"installed"===e.state&&navigator.serviceWorker.controller&&this.showUpdateNotification()})}handleServiceWorkerMessage(e){const{type:t,payload:s}=e.data;switch(t){case"CACHE_UPDATED":case"OFFLINE_READY":break;case"UPDATE_AVAILABLE":this.showUpdateNotification()}}showUpdateNotification(){window.dispatchEvent(new CustomEvent("sw-update-available",{detail:{registration:this.registration}}))}setupUpdateChecking(){this.updateCheckInterval=setInterval(()=>{this.registration&&this.update().catch(console.error)},18e5)}applyUpdate(){return m(this,null,function*(){this.registration&&this.registration.waiting&&(this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})}},Kt=new class{constructor(e){u(this,"sw"),this.sw=e}prefetchCriticalResources(){return m(this,null,function*(){const e=["/assets/css/index.css","/assets/js/vendor.js","/assets/js/main.js"];try{yield this.sw.prefetchResources(e)}catch(t){}})}prefetchRoute(e){return m(this,null,function*(){const t=this.getRouteResources(e);try{yield this.sw.prefetchResources(t)}catch(s){}})}getCacheHealth(){return m(this,null,function*(){try{const e=yield this.sw.getCacheStats(),t=[];let s=0;return Object.entries(e).forEach(([e,r])=>{s+=r.entryCount||0,r.entryCount>100&&t.push(`${e} cache has many entries (${r.entryCount})`),r.exists||t.push(`${e} cache is not properly initialized`)}),{totalSize:s,cacheStatus:e,recommendations:t}}catch(e){return{totalSize:0,cacheStatus:{},recommendations:["Failed to get cache statistics"]}}})}getRouteResources(e){return{"/products":["/api/products","/api/categories"],"/dashboard":["/api/dashboard/analytics","/api/user/profile"],"/checkout":["/api/payment/methods","/api/shipping/options"]}[e]||[]}}(Zt);"undefined"!=typeof window&&(window.addEventListener("load",()=>{Zt.register().then(e=>{e&&Kt.prefetchCriticalResources().catch(console.error)}).catch(console.error)}),window.addEventListener("online",()=>{Zt.update().catch(console.error)}),window.addEventListener("offline",()=>{}));const Xt=new class{constructor(){u(this,"metrics",[]),u(this,"observers",[]),u(this,"isEnabled",!0),u(this,"detailedMetrics",{}),this.initializeObservers(),this.trackPageLoad()}initializeObservers(){if("undefined"!=typeof window&&"PerformanceObserver"in window)try{const e=new PerformanceObserver(e=>{var t;const s=e.getEntries(),r=s[s.length-1];this.recordMetric("lcp",r.startTime,"timing",{element:(null==(t=r.element)?void 0:t.tagName)||"unknown"}),this.detailedMetrics.lcp=r.startTime});e.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(e);const t=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("fid",e.processingStart-e.startTime,"timing"),this.detailedMetrics.fid=e.processingStart-e.startTime})});t.observe({entryTypes:["first-input"]}),this.observers.push(t);const s=new PerformanceObserver(e=>{let t=0;e.getEntries().forEach(e=>{e.hadRecentInput||(t+=e.value)}),t>0&&(this.recordMetric("cls",t,"gauge"),this.detailedMetrics.cls=t)});s.observe({entryTypes:["layout-shift"]}),this.observers.push(s);const r=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("long_task",e.duration,"timing",{type:e.name})})});r.observe({entryTypes:["longtask"]}),this.observers.push(r);const i=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("ttfb",e.responseStart-e.requestStart,"timing"),this.recordMetric("dom_content_loaded",e.domContentLoadedEventEnd-e.fetchStart,"timing"),this.recordMetric("load_complete",e.loadEventEnd-e.fetchStart,"timing"),this.detailedMetrics.ttfb=e.responseStart-e.requestStart})});i.observe({entryTypes:["navigation"]}),this.observers.push(i)}catch(e){this.isEnabled=!1}else this.isEnabled=!1}trackPageLoad(){"undefined"!=typeof window&&window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];e&&(this.recordMetric("ttfb",e.responseStart-e.requestStart,"timing"),this.recordMetric("dom_content_loaded",e.domContentLoadedEventEnd-e.fetchStart,"timing"),this.recordMetric("load_complete",e.loadEventEnd-e.fetchStart,"timing"),this.detailedMetrics.ttfb=e.responseStart-e.requestStart);performance.getEntriesByType("paint").forEach(e=>{this.recordMetric(e.name.replace("-","_"),e.startTime,"timing"),"first-contentful-paint"===e.name&&(this.detailedMetrics.fcp=e.startTime)});const t=performance.getEntriesByType("resource"),s=t.filter(e=>e.duration>1e3);this.recordMetric("slow_resources_count",s.length,"counter"),this.detailedMetrics.slowResourcesCount=s.length,this.detailedMetrics.totalResources=t.length,this.logPerformanceSummary()},1e3)})}recordMetric(e,t,s,r){if(!this.isEnabled)return;const i={name:e,value:t,timestamp:Date.now(),type:s,tags:r};this.metrics.push(i),this.checkPerformanceThresholds(i)}checkPerformanceThresholds(e){const t={lcp:2500,fid:100,cls:.1,ttfb:800,long_task:50,fcp:1800,image_load:3e3}[e.name];t&&e.value}logPerformanceSummary(){this.getPerformanceSummary()}getPerformanceSummary(){const e={},t=this.metrics.reduce((e,t)=>(e[t.name]||(e[t.name]=[]),e[t.name].push(t.value),e),{});return Object.entries(t).forEach(([t,s])=>{const r=s.reduce((e,t)=>e+t,0)/s.length,i=Math.max(...s),a=Math.min(...s);e[t]={average:Math.round(r),max:Math.round(i),min:Math.round(a),count:s.length}}),e}startTiming(e){const t=performance.now();return()=>{const s=performance.now()-t;this.recordMetric(e,s,"timing")}}trackComponentRender(e,t){this.recordMetric("component_render",t,"timing",{component:e})}trackDatabaseQuery(e,t,s){this.recordMetric("db_query",t,"timing",{query:e,success:s.toString()})}trackUserInteraction(e,t){this.recordMetric("user_interaction",t||1,"counter",{action:e})}trackImageLoad(e,t,s){this.recordMetric("image_load",t,"timing",{image:e,success:s.toString()}),s&&(this.detailedMetrics.imageLoadTime=t)}trackApiResponse(e,t,s){this.recordMetric("api_response",t,"timing",{endpoint:e,success:s.toString()}),s&&(this.detailedMetrics.apiResponseTime=t)}trackCachePerformance(e){this.recordMetric("cache_hit_rate",e,"gauge"),this.detailedMetrics.cacheHitRate=e}getAllMetrics(){return[...this.metrics]}getDetailedMetrics(){return l({},this.detailedMetrics)}clearMetrics(){this.metrics=[],this.detailedMetrics={}}destroy(){this.observers.forEach(e=>e.disconnect()),this.observers=[],this.metrics=[],this.detailedMetrics={}}},es=e=>{const t=performance.now(),s=()=>{if("complete"===document.readyState){const s=performance.now()-t;Xt.recordMetric("page_load",s,"timing",{page:e})}else setTimeout(s,100)};s()},ts=e=>{const t=$.useRef(0);return{startLoading:$.useCallback(()=>{t.current=performance.now()},[]),endLoading:$.useCallback(s=>{if(t.current){const r=performance.now()-t.current;Xt.trackImageLoad(e,r,s),t.current=0}},[e])}};const ss=new class{constructor(){u(this,"preloadQueue",[]),u(this,"isProcessing",!1),u(this,"preloadedItems",new Set)}preloadProduct(e){return m(this,arguments,function*(e,t={}){const{priority:s="medium",timeout:r=8e3,force:i=!1}=t,a=`product-${e}`;if(this.preloadedItems.has(a)&&!i)return;if(st.has(a)&&!i)return void this.preloadedItems.add(a);const o=()=>m(this,null,function*(){try{const t=yield Promise.race([me(e),new Promise((e,t)=>setTimeout(()=>t(new Error("Preload timeout")),r))]);t&&(st.set(a,t,3e5),this.preloadedItems.add(a))}catch(t){}});"high"===s?this.preloadQueue.unshift(o):this.preloadQueue.push(o),this.processQueue()})}preloadCategoryProducts(e){return m(this,arguments,function*(e,t={}){const{priority:s="low",timeout:r=8e3,force:i=!1}=t,a=`category-products-${e}`;if(this.preloadedItems.has(a)&&!i)return;const o=()=>m(this,null,function*(){try{const t=yield Promise.race([ee({categoryId:e,limit:12}),new Promise((e,t)=>setTimeout(()=>t(new Error("Preload timeout")),r))]);t&&t.length>0&&(st.set(a,t,18e4),this.preloadedItems.add(a))}catch(t){}});"high"===s?this.preloadQueue.unshift(o):this.preloadQueue.push(o),this.processQueue()})}preloadNextPage(e){return m(this,arguments,function*(e,t=12,s={}){const{timeout:r=1e4}=s,i=e+t,a=`products-page-${i}-${t}`;if(this.preloadedItems.has(a))return;this.preloadQueue.push(()=>m(this,null,function*(){try{const e=yield Promise.race([ee({limit:t,offset:i}),new Promise((e,t)=>setTimeout(()=>t(new Error("Preload timeout")),r))]);e&&e.length>0&&(st.set(a,e,12e4),this.preloadedItems.add(a))}catch(e){}})),this.processQueue()})}preloadEssentials(){return m(this,null,function*(){this.preloadQueue.unshift(()=>m(null,null,function*(){try{const e=it("categories");if(!rt.has(e)){const t=yield X();rt.set(e,t)}const t=it("products-featured");if(!st.has(t)){const e=yield ee({featured:!0,limit:8});st.set(t,e)}}catch(e){}})),this.processQueue()})}processQueue(){return m(this,null,function*(){if(!this.isProcessing&&0!==this.preloadQueue.length){for(this.isProcessing=!0;this.preloadQueue.length>0;){const t=this.preloadQueue.shift();if(t){try{yield t()}catch(e){}yield new Promise(e=>setTimeout(e,100))}}this.isProcessing=!1}})}clear(){this.preloadQueue=[],this.preloadedItems.clear(),this.isProcessing=!1}getStats(){return{queueLength:this.preloadQueue.length,preloadedItems:this.preloadedItems.size,isProcessing:this.isProcessing}}smartPreload(e){const{currentPage:t,userScrollPosition:s=0,timeOnPage:r=0}=e;r>1e4&&s>.5&&"products"===t&&this.preloadNextPage(0),"home"===t&&r>5e3&&this.preloadEssentials(),null==t||t.startsWith("product-")}};"undefined"!=typeof window&&setTimeout(()=>{ss.preloadEssentials()},2e3);new class{constructor(e={}){u(this,"failures",0),u(this,"lastFailureTime",0),u(this,"state","closed"),u(this,"config"),u(this,"halfOpenSuccesses",0),u(this,"metrics",{requestCount:0,successCount:0,failureCount:0,averageResponseTime:0,bandwidthUsage:0,retryCount:0,circuitBreakerEvents:0}),u(this,"failureTimestamps",[]),this.config=l({failureThreshold:5,resetTimeout:6e4,monitoringPeriod:3e5,halfOpenAttempts:3},e)}execute(e){return m(this,null,function*(){this.metrics.requestCount++;const t=Date.now();if("open"===this.state){if(!(Date.now()-this.lastFailureTime>this.config.resetTimeout))throw new Error("Circuit breaker is open - service unavailable");this.state="half-open",this.halfOpenSuccesses=0,this.metrics.circuitBreakerEvents++}try{const s=yield e();"half-open"===this.state?(this.halfOpenSuccesses++,this.halfOpenSuccesses>=this.config.halfOpenAttempts&&(this.state="closed",this.failures=0,this.failureTimestamps=[],this.metrics.circuitBreakerEvents++)):this.metrics.successCount++;const r=Date.now()-t;return this.metrics.averageResponseTime=(this.metrics.averageResponseTime*(this.metrics.successCount-1)+r)/this.metrics.successCount,s}catch(s){this.failures++,this.lastFailureTime=Date.now(),this.failureTimestamps.push(this.lastFailureTime),this.metrics.failureCount++,this.metrics.circuitBreakerEvents++;const e=Date.now()-this.config.monitoringPeriod;this.failureTimestamps=this.failureTimestamps.filter(t=>t>e);const t=this.failureTimestamps.length;throw(this.failures>=this.config.failureThreshold||"half-open"===this.state||t>=this.config.failureThreshold&&"closed"===this.state)&&(this.state="open"),s}})}getState(){return{state:this.state,failures:this.failures,lastFailureTime:this.lastFailureTime,halfOpenSuccesses:this.halfOpenSuccesses,metrics:l({},this.metrics),recentFailureRate:this.failureTimestamps.length/(this.config.monitoringPeriod/1e3/60)}}reset(){this.state="closed",this.failures=0,this.lastFailureTime=0,this.halfOpenSuccesses=0,this.failureTimestamps=[]}getMetrics(){return l({},this.metrics)}}({failureThreshold:5,resetTimeout:6e4,monitoringPeriod:3e5,halfOpenAttempts:3}),new class{constructor(){u(this,"queue",[]),u(this,"isProcessing",!1),u(this,"maxRetries",3),u(this,"maxAge",864e5),u(this,"bandwidthThreshold",.5),u(this,"persistenceKey","offline-request-queue"),this.loadPersistedRequests(),window.addEventListener("online",()=>{this.processQueue()}),window.addEventListener("offline",()=>{this.persistQueue()}),setInterval(()=>{this.cleanupOldRequests()},6e4)}enqueue(e){return m(this,arguments,function*(e,t="normal",s=[],r=!1,i){return new Promise((a,o)=>{const n=`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,l=["critical","high","normal","low","background"],c=this.queue.findIndex(e=>l.indexOf(e.priority)>l.indexOf(t)),d={id:n,request:e,resolve:a,reject:o,timestamp:Date.now(),retries:0,priority:t,tags:s,persist:r,data:i};-1===c?this.queue.push(d):this.queue.splice(c,0,d),navigator.onLine?this.processQueue():r&&this.persistQueue()})})}processQueue(){return m(this,null,function*(){if(this.isProcessing||!navigator.onLine||0===this.queue.length)return;this.isProcessing=!0;const e=["critical","high","normal","low","background"];this.queue.sort((t,s)=>e.indexOf(t.priority)-e.indexOf(s.priority));const t=this.queue.filter(e=>"critical"===e.priority||"high"===e.priority),s=this.queue.filter(e=>"critical"!==e.priority&&"high"!==e.priority),r=(e,t=3)=>m(this,null,function*(){for(let s=0;s<e.length;s+=t){const r=e.slice(s,s+t);yield Promise.all(r.map(e=>m(this,null,function*(){try{const t=yield e.request();e.resolve(t),this.queue=this.queue.filter(t=>t.id!==e.id)}catch(t){e.retries++,e.retries<this.maxRetries?(e.priority=this.downgradePriority(e.priority),this.queue=this.queue.filter(t=>t.id!==e.id),this.queue.push(e)):(e.reject(t),this.queue=this.queue.filter(t=>t.id!==e.id))}})))}});t.length>0&&(yield r(t,3)),s.length>0&&(yield r(s,2)),this.isProcessing=!1,this.queue.length>0&&this.persistQueue()})}downgradePriority(e){const t=["critical","high","normal","low","background"],s=t.indexOf(e);if(s>=0&&s<t.length-1){const r=t[s+1];return null!=r?r:e}return e}cleanupOldRequests(){const e=Date.now();this.queue.length;this.queue=this.queue.filter(t=>{const s=e-t.timestamp>this.maxAge;return s&&t.reject(new Error("Request expired")),!s}),this.queue.length}getQueueStatus(){return{queueLength:this.queue.length,isProcessing:this.isProcessing,oldestRequest:this.queue.length>0&&this.queue[0]?this.queue[0].timestamp:null,priorityBreakdown:this.getPriorityBreakdown(),persistedRequests:this.queue.filter(e=>e.persist).length}}getPriorityBreakdown(){const e={critical:0,high:0,normal:0,low:0,background:0};return this.queue.forEach(t=>{e[t.priority]++}),e}clearQueue(){this.queue.forEach(e=>{e.reject(new Error("Queue cleared"))}),this.queue=[],this.clearPersistedQueue()}cancelRequestsByTag(e){const t=this.queue.length;this.queue=this.queue.filter(t=>!(t&&t.tags&&t.tags.includes(e))||(t.reject(new Error(`Request cancelled by tag: ${e}`)),!1)),t!==this.queue.length&&this.queue.some(e=>e.persist)&&this.persistQueue()}setBandwidthThreshold(e){this.bandwidthThreshold=e}persistQueue(){try{const e=this.queue.filter(e=>e.persist).map(e=>({id:e.id,timestamp:e.timestamp,retries:e.retries,priority:e.priority,tags:e.tags,data:e.data}));e.length>0?localStorage.setItem(this.persistenceKey,JSON.stringify(e)):this.clearPersistedQueue()}catch(e){}}loadPersistedRequests(){try{const e=localStorage.getItem(this.persistenceKey);if(e){JSON.parse(e)}}catch(e){}}clearPersistedQueue(){try{localStorage.removeItem(this.persistenceKey)}catch(e){}}sync(){return m(this,null,function*(){navigator.onLine&&(yield this.processQueue())})}};const rs=new class{constructor(){u(this,"pendingRequests",new Map)}deduplicate(e,t){return m(this,null,function*(){if(this.pendingRequests.has(e))return this.pendingRequests.get(e);const s=t().finally(()=>{this.pendingRequests.delete(e)});return this.pendingRequests.set(e,s),s})}clear(){this.pendingRequests.clear()}};const is=new class{constructor(e={}){u(this,"config"),u(this,"activeRequests",new Map),u(this,"requestQueue",[]),u(this,"metrics",{activeRequests:0,queuedRequests:0,completedRequests:0,failedRequests:0,bandwidthUsage:0,memoryUsage:0,averageResponseTime:0}),u(this,"isProcessing",!1),u(this,"deduplicator"),u(this,"requestBundles",new Map),this.config=l({maxConcurrentRequests:6,enableDeduplication:!0,enablePrefetching:!0},e),this.deduplicator=rs,setInterval(()=>{this.cleanupCompletedRequests()},3e4)}addRequest(e){return m(this,null,function*(){const t=l({id:`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,retryCount:0,maxRetries:3,timeout:3e4},e);return new Promise((e,s)=>{t.onSuccess=e,t.onError=s,this.config.enableDeduplication&&t.dedupKey?this.deduplicator.deduplicate(t.dedupKey,()=>this.processRequest(t)).then(e).catch(s):this.enqueueRequest(t)})})}enqueueRequest(e){const t=["critical","high","normal","low","background"],s=this.requestQueue.findIndex(s=>t.indexOf(s.priority)>t.indexOf(e.priority));-1===s?this.requestQueue.push(e):this.requestQueue.splice(s,0,e),this.metrics.queuedRequests=this.requestQueue.length,this.processQueue()}processQueue(){return m(this,null,function*(){if(!(this.isProcessing||this.activeRequests.size>=this.config.maxConcurrentRequests)){for(this.isProcessing=!0;this.requestQueue.length>0&&this.activeRequests.size<this.config.maxConcurrentRequests;){const e=this.requestQueue.shift();if(e.dependencies.length>0){if(!e.dependencies.every(e=>!this.activeRequests.has(e))){this.requestQueue.unshift(e);continue}}this.activeRequests.set(e.id,e),this.metrics.activeRequests=this.activeRequests.size,this.metrics.queuedRequests=this.requestQueue.length,this.processRequest(e).catch(t=>{var s;null==(s=e.onError)||s.call(e,t)})}this.isProcessing=!1}})}processRequest(e){return m(this,null,function*(){var t,s;const r=Date.now();try{const s=new Promise((t,s)=>{setTimeout(()=>s(new Error(`Request timeout after ${e.timeout}ms`)),e.timeout)}),i=yield Promise.race([this.executeRequest(e),s]),a=Date.now()-r;return this.updateMetrics(a,!0),this.activeRequests.delete(e.id),this.metrics.activeRequests=this.activeRequests.size,this.metrics.completedRequests++,null==(t=e.onSuccess)||t.call(e,i),i}catch(i){const t=Date.now()-r;if(this.updateMetrics(t,!1),!(e.retryCount<e.maxRetries))throw this.activeRequests.delete(e.id),this.metrics.activeRequests=this.activeRequests.size,this.metrics.failedRequests++,null==(s=e.onError)||s.call(e,i),i;{e.retryCount++;const t=Math.min(1e3*Math.pow(2,e.retryCount),1e4);yield new Promise(e=>setTimeout(e,t)),this.enqueueRequest(c(l({},e),{priority:this.downgradePriority(e.priority)}))}}this.processQueue()})}executeRequest(e){return m(this,null,function*(){try{if(e.url&&(e.url.includes(".jpg")||e.url.includes(".png")||e.url.includes(".webp")||e.url.includes(".avif"))){const t=yield fetch(e.url);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return t.json()}const t=yield fetch(e.url,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return t.json()}catch(t){throw t}})}updateMetrics(e,t){this.metrics.averageResponseTime=(this.metrics.averageResponseTime*(this.metrics.completedRequests+this.metrics.failedRequests-1)+e)/(this.metrics.completedRequests+this.metrics.failedRequests)}downgradePriority(e){const t=["critical","high","normal","low","background"],s=t.indexOf(e);return s>=0&&s<t.length-1?t[s+1]:e}cancelRequestsByTag(e){this.requestQueue=this.requestQueue.filter(t=>{var s;return!t.tags.includes(e)||(null==(s=t.onError)||s.call(t,new Error(`Request cancelled by tag: ${e}`)),!1)}),this.activeRequests.forEach((t,s)=>{var r;t.tags.includes(e)&&(null==(r=t.onError)||r.call(t,new Error(`Request cancelled by tag: ${e}`)),this.activeRequests.delete(s))}),this.metrics.queuedRequests=this.requestQueue.length,this.metrics.activeRequests=this.activeRequests.size}bundleRequests(e,t,s=3){return m(this,null,function*(){this.requestBundles.set(t,e);const r=[];for(let t=0;t<e.length;t+=s){const i=e.slice(t,t+s),a=yield Promise.all(i.map(e=>e()));r.push(...a)}return r})}prefetchResources(e){return m(this,null,function*(){if(!this.config.enablePrefetching)return;const t=e.map(e=>c(l({},e),{priority:"background",maxRetries:1}));yield Promise.all(t.map(e=>this.addRequest(e)))})}getMetrics(){return l({},this.metrics)}cleanupCompletedRequests(){this.metrics.completedRequests>1e3&&(this.metrics.completedRequests=Math.floor(this.metrics.completedRequests/2)),this.metrics.failedRequests>1e3&&(this.metrics.failedRequests=Math.floor(this.metrics.failedRequests/2))}clear(){this.activeRequests.forEach(e=>{var t;null==(t=e.onError)||t.call(e,new Error("Request cancelled: ResourceManager cleared"))}),this.requestQueue.forEach(e=>{var t;null==(t=e.onError)||t.call(e,new Error("Request cancelled: ResourceManager cleared"))}),this.activeRequests.clear(),this.requestQueue=[],this.metrics.activeRequests=0,this.metrics.queuedRequests=0}}({maxConcurrentRequests:6,enableDeduplication:!0,enablePrefetching:!0}),as=class e{constructor(){u(this,"resourceManager",null),u(this,"circuitBreaker",null),u(this,"customMetrics",new Map),u(this,"observers",[]),u(this,"isEnabled",!0),this.initializePerformanceObservers()}static getInstance(){return e.instance||(e.instance=new e),e.instance}setResourceManager(e){this.resourceManager=e}setCircuitBreaker(e){this.circuitBreaker=e}initializePerformanceObservers(){if("undefined"!=typeof window&&"PerformanceObserver"in window)try{if("largestContentfulPaint"in window){const e=new PerformanceObserver(e=>{const t=e.getEntries(),s=t[t.length-1];this.recordCustomMetric("lcp",s.startTime)});e.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(e)}if("firstInput"in window){const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordCustomMetric("fid",e.processingStart-e.startTime)})});e.observe({entryTypes:["first-input"]}),this.observers.push(e)}if("layoutShift"in window){const e=new PerformanceObserver(e=>{let t=0;e.getEntries().forEach(e=>{e.hadRecentInput||(t+=e.value)}),t>0&&this.recordCustomMetric("cls",t)});e.observe({entryTypes:["layout-shift"]}),this.observers.push(e)}}catch(e){this.isEnabled=!1}else this.isEnabled=!1}recordCustomMetric(e,t){this.customMetrics.set(e,t),Xt.recordMetric(e,t,"gauge")}recordUserInteraction(e,t){const s=this.customMetrics.get("userInteractions")||0;this.customMetrics.set("userInteractions",s+1),Xt.trackUserInteraction(e,t)}recordComponentRender(e,t){const s=this.customMetrics.get("componentRenders")||0;this.customMetrics.set("componentRenders",s+1),Xt.trackComponentRender(e,t)}recordDatabaseQuery(e,t,s){const r=this.customMetrics.get("databaseQueries")||0;this.customMetrics.set("databaseQueries",r+1),Xt.trackDatabaseQuery(e,t,s)}recordCacheEvent(e){if(e){const e=this.customMetrics.get("cacheHits")||0;this.customMetrics.set("cacheHits",e+1)}else{const e=this.customMetrics.get("cacheMisses")||0;this.customMetrics.set("cacheMisses",e+1)}}getDetailedMetrics(){let e={activeRequests:0,queuedRequests:0,completedRequests:0,failedRequests:0,bandwidthUsage:0,memoryUsage:0,averageResponseTime:0};this.resourceManager&&(e=this.resourceManager.getMetrics());let t={requestCount:0,successCount:0,failureCount:0,retryCount:0,circuitBreakerEvents:0};this.circuitBreaker&&(t=this.circuitBreaker.getMetrics());return{lcp:this.customMetrics.get("lcp"),fid:this.customMetrics.get("fid"),cls:this.customMetrics.get("cls"),fcp:this.customMetrics.get("fcp"),ttfb:this.customMetrics.get("ttfb"),activeRequests:e.activeRequests||0,queuedRequests:e.queuedRequests||0,completedRequests:e.completedRequests||0,failedRequests:e.failedRequests||0,bandwidthUsage:e.bandwidthUsage||0,memoryUsage:e.memoryUsage||0,averageResponseTime:e.averageResponseTime||0,circuitBreakerEvents:t.circuitBreakerEvents||0,retryCount:t.retryCount||0,successCount:t.successCount||0,failureCount:t.failureCount||0,requestCount:t.requestCount||0,userInteractions:this.customMetrics.get("userInteractions")||0,componentRenders:this.customMetrics.get("componentRenders")||0,databaseQueries:this.customMetrics.get("databaseQueries")||0,cacheHits:this.customMetrics.get("cacheHits")||0,cacheMisses:this.customMetrics.get("cacheMisses")||0}}generateReport(){var e;return{timestamp:Date.now(),metrics:this.getDetailedMetrics(),userAgent:navigator.userAgent,url:window.location.href,connectionType:(null==(e=navigator.connection)?void 0:e.effectiveType)||"unknown"}}logMetrics(){this.generateReport()}sendMetricsToAnalytics(e){e||this.generateReport()}checkPerformanceThresholds(){const e=this.getDetailedMetrics();Object.entries({lcp:2500,fid:100,cls:.1,fcp:1800,ttfb:800}).forEach(([t,s])=>{e[t]}),e.activeRequests,e.failedRequests,e.circuitBreakerEvents}destroy(){this.observers.forEach(e=>e.disconnect()),this.observers=[],this.customMetrics.clear()}};u(as,"instance");const os=as.getInstance(),ns=(e,...t)=>m(null,[e,...t],function*(e,t={format:"csv",includeHeaders:!0}){try{let s=z.from(e).select("*");t.dateRange&&(s=s.gte("created_at",t.dateRange.start.toISOString()).lte("created_at",t.dateRange.end.toISOString())),t.filters&&Object.entries(t.filters).forEach(([e,t])=>{null!=t&&""!==t&&(s=s.eq(e,t))});const{data:r,error:i}=yield s;if(i)return{success:!1,processed:0,errors:[i.message]};if(!r||0===r.length)return{success:!0,processed:0,errors:[],data:[]};let a;switch(t.format){case"csv":default:a=ls(r,t.includeHeaders);break;case"json":a=JSON.stringify(r,null,2);break;case"xlsx":a=r}return cs(a,`${e}_export.${t.format}`,t.format),{success:!0,processed:r.length,errors:[],data:r}}catch(s){return{success:!1,processed:0,errors:[s instanceof Error?s.message:"Unknown error occurred"]}}}),ls=(e,t=!0)=>{if(0===e.length)return"";const s=Object.keys(e[0]),r=[];return t&&r.push(s.join(",")),e.forEach(e=>{const t=s.map(t=>{const s=e[t];return null==s?"":"object"==typeof s?`"${JSON.stringify(s).replace(/"/g,'""')}"`:"string"==typeof s&&(s.includes(",")||s.includes('"')||s.includes("\n"))?`"${s.replace(/"/g,'""')}"`:s.toString()});r.push(t.join(","))}),r.join("\n")},cs=(e,t,s)=>{let r;switch(s){case"csv":r=new Blob([e],{type:"text/csv;charset=utf-8;"});break;case"json":r=new Blob([e],{type:"application/json;charset=utf-8;"});break;default:r=new Blob([e],{type:"text/plain;charset=utf-8;"})}const i=document.createElement("a"),a=URL.createObjectURL(r);i.setAttribute("href",a),i.setAttribute("download",t),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)},ds=(e,t)=>m(null,null,function*(){try{const{error:s}=yield z.from(e).delete().in("id",t);return s?{success:!1,processed:0,errors:[s.message]}:{success:!0,processed:t.length,errors:[]}}catch(s){return{success:!1,processed:0,errors:[s instanceof Error?s.message:"Unknown error occurred"]}}}),us=e=>{const t=[],s=[],r=(e=>{const t=[],s=[];if(!e)return t.push("Email is required"),{isValid:!1,errors:t,warnings:s};/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||t.push("Please enter a valid email address"),e.length>254&&t.push("Email address is too long (maximum 254 characters)");const r=e.split("@")[0];r&&r.length>64&&t.push("Email local part is too long (maximum 64 characters)");const i=e.split("@")[1];i&&(i.length>253&&t.push("Email domain is too long (maximum 253 characters)"),/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(i)||t.push("Email domain format is invalid"));const a={"gmial.com":"gmail.com","gmai.com":"gmail.com","yahooo.com":"yahoo.com","hotmial.com":"hotmail.com","outlok.com":"outlook.com"};return i&&a[i.toLowerCase()]&&s.push(`Did you mean ${a[i.toLowerCase()]}?`),{isValid:0===t.length,errors:t,warnings:s}})(e.email),i=(e=>{const t=[],s=[];return e?(e.length<2&&t.push("Name must be at least 2 characters long"),e.length>100&&t.push("Name is too long (maximum 100 characters)"),/^[a-zA-Z\s\-'\.]+$/.test(e)||t.push("Name can only contain letters, spaces, hyphens, and apostrophes"),e.includes("  ")&&s.push("Name contains multiple consecutive spaces"),(e.startsWith(" ")||e.endsWith(" "))&&s.push("Name has leading or trailing spaces"),{isValid:0===t.length,errors:t,warnings:s}):(t.push("Name is required"),{isValid:!1,errors:t,warnings:s})})(e.name),a=(e=>{const t=[];return e?(["admin","seller","customer"].includes(e.toLowerCase())||t.push("Invalid role. Must be admin, seller, or customer"),{isValid:0===t.length,errors:t}):(t.push("Role is required"),{isValid:!1,errors:t})})(e.role),o=(e=>{const t=[],s=[];if(!e)return{isValid:!0,errors:t,warnings:s};const r=e.replace(/\D/g,"");return r.length<10&&t.push("Phone number must be at least 10 digits"),r.length>15&&t.push("Phone number is too long (maximum 15 digits)"),/^[\+]?[1-9][\d]{0,15}$/.test(r)||t.push("Please enter a valid phone number"),{isValid:0===t.length,errors:t,warnings:s}})(e.phone||""),n=(e=>{const t=[],s=[];if(!e)return{isValid:!0,errors:t,warnings:s};const r=new Date(e),i=new Date;if(isNaN(r.getTime()))return t.push("Please enter a valid date"),{isValid:!1,errors:t,warnings:s};r>i&&t.push("Date of birth cannot be in the future");const a=new Date;a.setFullYear(a.getFullYear()-120),r<a&&t.push("Date of birth seems unrealistic (over 120 years ago)");const o=new Date;return o.setFullYear(o.getFullYear()-13),r>o&&s.push("User appears to be under 13 years old. Additional parental consent may be required."),{isValid:0===t.length,errors:t,warnings:s}})(e.dateOfBirth||"");return t.push(...r.errors),t.push(...i.errors),t.push(...a.errors),t.push(...o.errors),t.push(...n.errors),s.push(...r.warnings||[]),s.push(...i.warnings||[]),s.push(...o.warnings||[]),s.push(...n.warnings||[]),{isValid:0===t.length,errors:t,warnings:s}},ms=e=>e?e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim():"",hs=()=>{const[e,t]=h.useState(()=>"undefined"==typeof window?{reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!1,focusVisible:!1,colorBlindness:"none"}:ps());h.useEffect(()=>{const e=()=>{t(ps())},s=[window.matchMedia("(prefers-reduced-motion: reduce)"),window.matchMedia("(prefers-contrast: high)"),window.matchMedia("(prefers-color-scheme: dark)")];return s.forEach(t=>{t.addEventListener("change",e)}),window.addEventListener("storage",e),()=>{s.forEach(t=>{t.removeEventListener("change",e)}),window.removeEventListener("storage",e)}},[]);return{preferences:e,updatePreference:h.useCallback((e,s)=>{t(t=>c(l({},t),{[e]:s}));try{const t=JSON.parse(localStorage.getItem("accessibility_preferences")||"{}");localStorage.setItem("accessibility_preferences",JSON.stringify(c(l({},t),{[e]:s})))}catch(r){}},[])}};function ps(){const e={reducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,highContrast:window.matchMedia("(prefers-contrast: high)").matches,largeText:!1,screenReader:!1,keyboardNavigation:!1,focusVisible:!1,colorBlindness:"none"};e.screenReader=!!(window.navigator.userAgent.match(/NVDA|JAWS|VoiceOver|ORCA|Dragon/i)||window.speechSynthesis||window.speechSynthesis);try{const t=JSON.parse(localStorage.getItem("accessibility_preferences")||"{}");Object.assign(e,t)}catch(t){}return e}const gs=()=>{const e=h.useRef(null);h.useEffect(()=>{if(!e.current){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.style.cssText="\n        position: absolute !important;\n        width: 1px !important;\n        height: 1px !important;\n        padding: 0 !important;\n        margin: -1px !important;\n        overflow: hidden !important;\n        clip: rect(0, 0, 0, 0) !important;\n        white-space: nowrap !important;\n        border: 0 !important;\n      ",document.body.appendChild(t),e.current=t}return()=>{e.current&&document.body.contains(e.current)&&document.body.removeChild(e.current)}},[]);return{announce:h.useCallback((t,s="polite")=>{e.current&&(e.current.setAttribute("aria-live",s),e.current.textContent="",setTimeout(()=>{e.current&&(e.current.textContent=t)},100))},[])}},fs={checkAltText:(e=document.body)=>{const t=e.querySelectorAll("img");return Array.from(t).filter(e=>!e.alt&&!e.getAttribute("aria-label")&&!e.getAttribute("aria-labelledby")&&"presentation"!==e.getAttribute("role"))},checkFormLabels:(e=document.body)=>{const t=e.querySelectorAll("input, select, textarea");return Array.from(t).filter(e=>{var t;const s=e;return!(null==(t=s.labels)?void 0:t.length)&&!s.getAttribute("aria-label")&&!s.getAttribute("aria-labelledby")&&"hidden"!==s.type})},checkHeadingHierarchy:(e=document.body)=>{const t=Array.from(e.querySelectorAll("h1, h2, h3, h4, h5, h6")),s=[];let r=0;return t.forEach(e=>{const t=parseInt(e.tagName.charAt(1));t>r+1&&s.push({element:e,issue:`Heading level ${t} follows level ${r}, skipping levels`}),r=t}),s},generateReport:(e=document.body)=>({missingAltText:fs.checkAltText(e),missingFormLabels:fs.checkFormLabels(e),headingIssues:fs.checkHeadingHierarchy(e),timestamp:(new Date).toISOString()})},ys={xs:320,sm:640,md:768,lg:1024,xl:1280,"2xl":1536,"3xl":1920,"4xl":2560},ws={xs:"100%",sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px","3xl":"1920px","4xl":"2560px"},bs={xs:4,sm:8,md:12,lg:12,xl:12,"2xl":12,"3xl":16,"4xl":20},vs={xs:{base:4,scale:1},sm:{base:4,scale:1.2},md:{base:6,scale:1.4},lg:{base:8,scale:1.6},xl:{base:10,scale:1.8},"2xl":{base:12,scale:2},"3xl":{base:16,scale:2.2},"4xl":{base:20,scale:2.4}},xs={xs:{base:14,scale:1},sm:{base:14,scale:1.1},md:{base:16,scale:1.2},lg:{base:16,scale:1.3},xl:{base:18,scale:1.4},"2xl":{base:18,scale:1.5},"3xl":{base:20,scale:1.6},"4xl":{base:22,scale:1.7}},ks=()=>{const[e,t]=h.useState(()=>"undefined"==typeof window?{width:1024,height:768,breakpoint:"lg",deviceType:"desktop",orientation:"landscape",pixelRatio:1,isTouch:!1,isPWA:!1,isRetina:!1,aspectRatio:1.33,safeAreaInsets:{top:0,right:0,bottom:0,left:0}}:js()),s=h.useCallback(()=>{t(js())},[]);h.useEffect(()=>{s();const e=function(e,t){let s;return(...r)=>{clearTimeout(s),s=setTimeout(()=>e.apply(null,r),t)}}(s,150);window.addEventListener("resize",e);const t=()=>{setTimeout(s,100)};window.addEventListener("orientationchange",t);const r=()=>{s()};return window.addEventListener("beforeinstallprompt",r),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",t),window.removeEventListener("beforeinstallprompt",r)}},[s]);const r=h.useCallback(t=>e.breakpoint===t,[e.breakpoint]),i=h.useCallback(t=>e.width>=ys[t],[e.width]),a=h.useCallback(t=>e.width<ys[t],[e.width]),o=h.useCallback(t=>{const s=Object.keys(ys).sort((e,t)=>ys[e]-ys[t]);for(let r=s.length-1;r>=0;r--){const i=s[r];if(e.width>=ys[i]&&void 0!==t[i])return t[i]}for(const e of s)if(void 0!==t[e])return t[e]},[e.width]),n=h.useCallback(()=>ws[e.breakpoint],[e.breakpoint]),d=h.useCallback(()=>bs[e.breakpoint],[e.breakpoint]),u=h.useCallback((t=1)=>{const s=vs[e.breakpoint];return s.base*s.scale*t},[e.breakpoint]),m=h.useCallback((t=1)=>{const s=xs[e.breakpoint];return s.base*s.scale*t},[e.breakpoint]);return c(l({},e),{isBreakpoint:r,isBreakpointUp:i,isBreakpointDown:a,getResponsiveValue:o,getContainerSize:n,getGridColumns:d,getSpacing:u,getTypographySize:m,isMobile:"mobile"===e.deviceType,isTablet:"tablet"===e.deviceType,isDesktop:"desktop"===e.deviceType,isPortrait:"portrait"===e.orientation,isLandscape:"landscape"===e.orientation})};function js(){const e=window.innerWidth,t=window.innerHeight,s=window.devicePixelRatio||1,r=e/t;let i="xs";const a=Object.entries(ys);for(const[n,l]of a.reverse())if(e>=l){i=n;break}let o="desktop";e<ys.md?o="mobile":e<ys.lg?o="tablet":e>=ys["3xl"]&&(o="tv");return{width:e,height:t,breakpoint:i,deviceType:o,orientation:e>t?"landscape":"portrait",pixelRatio:s,isTouch:"ontouchstart"in window||navigator.maxTouchPoints>0,isPWA:window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches||!0===window.navigator.standalone,isRetina:s>1,aspectRatio:r,safeAreaInsets:{top:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-top")||"0"),right:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-right")||"0"),bottom:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-bottom")||"0"),left:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-left")||"0")}}}const Ss=e=>{const{getGridColumns:t,getResponsiveValue:s}=ks(),r=h.useMemo(()=>e&&s(e)||t(),[e,s,t]),i=h.useCallback(e=>"number"==typeof e?Math.min(e,r):Math.min(s(e)||1,r),[r,s]),a=h.useCallback(e=>i(e)/r*100+"%",[i,r]);return{gridColumns:r,getColumnSpan:i,getColumnWidth:a}};export{ss as A,es as B,Xt as C,vt as D,jt as E,fe as F,Ce as G,Yt as H,Qt as I,Gt as J,Jt as S,pe as _,dt as a,Ve as b,Ue as c,ds as d,ns as e,Wt as f,Be as g,Ge as h,Je as i,gt as j,hs as k,gs as l,ks as m,fs as n,Ss as o,Bt as p,Ye as q,ts as r,ms as s,is as t,Me as u,us as v,yt as w,At as x,$t as y,os as z};
