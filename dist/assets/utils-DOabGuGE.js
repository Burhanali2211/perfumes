var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,j as a}from"./vendor-I9hkboGq.js";import{s as r,bG as i,H as n,J as o}from"./index-CzTquisR.js";import{S as c}from"./services-BbBFH2H7.js";const l=e=>{if("code"in e&&"details"in e){const t=e;switch(t.code){case"PGRST116":return{type:"database",message:t.message,userMessage:"The requested resource was not found.",code:t.code,details:t.details};case"PGRST301":return{type:"database",message:t.message,userMessage:"Database connection failed. Please try again later.",code:t.code,details:t.details};case"23505":return{type:"validation",message:t.message,userMessage:"This item already exists. Please use a different value.",code:t.code,details:t.details};case"23503":return{type:"validation",message:t.message,userMessage:"Cannot complete this action due to related data.",code:t.code,details:t.details};case"42501":return{type:"authorization",message:t.message,userMessage:"You do not have permission to perform this action.",code:t.code,details:t.details};case"PGRST204":return{type:"authorization",message:t.message,userMessage:"Access denied. You do not have permission to access this resource.",code:t.code,details:t.details};default:return{type:"database",message:t.message,userMessage:"A database error occurred. Please try again.",code:t.code,details:t.details}}}return e.message.includes("fetch")||e.message.includes("Network")?{type:"network",message:e.message,userMessage:"Network connection failed. Please check your internet connection and try again."}:e.message.includes("JWT")||e.message.includes("auth")||e.message.includes("token")?{type:"authentication",message:e.message,userMessage:"Your session has expired. Please sign in again."}:e.message.includes("infinite recursion")||e.message.includes("maximum recursion depth")||e.message.includes("stack depth limit")||e.message.includes("too much recursion")?{type:"database",message:e.message,userMessage:"Database configuration error detected. Row Level Security policies may have infinite recursion. Please run the RLS fixes script."}:e.message.includes("timeout")||e.message.includes("timed out")?{type:"network",message:e.message,userMessage:"Request timed out. Please try again."}:e.message.includes("row-level security")||e.message.includes("policy")||e.message.includes("RLS")?{type:"authorization",message:e.message,userMessage:"Access restricted by security policies. Please check your permissions."}:{type:"unknown",message:e.message,userMessage:"An unexpected error occurred. Please try again."}},d=e=>["infinite recursion","maximum recursion depth","stack depth limit","too much recursion","recursive policy","circular dependency in policies"].some(t=>e.message.toLowerCase().includes(t.toLowerCase())),u=class e{constructor(){t(this,"measurements",new Map),t(this,"metrics",[]),t(this,"maxMetrics",100)}static getInstance(){return e.instance||(e.instance=new e),e.instance}startMeasure(e){this.measurements.set(e,performance.now())}endMeasure(e,t=!0){const s=this.measurements.get(e);if(!s)return this.startMeasure(e),0;const a=performance.now()-s;return this.metrics.push({name:e,duration:a,timestamp:Date.now(),success:t}),this.metrics.length>this.maxMetrics&&this.metrics.shift(),this.measurements.delete(e),a}getStats(){const e=this.metrics.filter(e=>Date.now()-e.timestamp<3e5),t=e.filter(e=>e.success);if(0===e.length)return{totalRequests:0,successRate:0,averageTime:0,slowestOperation:null,fastestOperation:null};const s=t.map(e=>e.duration),a=s.reduce((e,t)=>e+t,0)/s.length,r=e.reduce((e,t)=>t.duration>e.duration?t:e),i=e.reduce((e,t)=>t.duration<e.duration?t:e);return{totalRequests:e.length,successRate:t.length/e.length*100,averageTime:a,slowestOperation:r,fastestOperation:i}}async measureAsync(e,t){this.startMeasure(e);try{const s=await t();return this.endMeasure(e),s}catch(s){throw this.endMeasure(e),s}}measureSync(e,t){this.startMeasure(e);try{const s=t();return this.endMeasure(e),s}catch(s){throw this.endMeasure(e),s}}};t(u,"instance");const h=u.getInstance();class m{constructor(e={}){t(this,"cache",new Map),t(this,"strategy"),t(this,"stats",{hitRate:0,totalRequests:0,totalHits:0,totalMisses:0,totalSize:0,entryCount:0,gcRuns:0,lastGC:Date.now()}),t(this,"gcTimer",null),t(this,"backgroundUpdateQueue",new Set),this.strategy={maxSize:52428800,maxEntries:1e3,defaultTTL:3e5,gcInterval:6e4,compressionThreshold:1024,...e},this.startGarbageCollection()}set(e,t,s={}){h.startMeasure(`cache-set-${e}`);const{ttl:a=this.strategy.defaultTTL,priority:r="medium",tags:i=[],compress:n=!1}=s,o=this.serializeData(t,n),c=this.calculateSize(o);this.shouldEvict(c)&&this.evictEntries(c);const l={data:o,timestamp:Date.now(),ttl:a,accessCount:0,lastAccessed:Date.now(),size:c,priority:r,tags:i};this.cache.set(e,l),this.updateStats("set",c),h.endMeasure(`cache-set-${e}`)}get(e){h.startMeasure(`cache-get-${e}`),this.stats.totalRequests++;const t=this.cache.get(e);return t?this.isExpired(t)?(this.cache.delete(e),this.stats.totalMisses++,this.updateStats("delete",t.size),this.updateHitRate(),h.endMeasure(`cache-get-${e}`,!1),"high"===t.priority&&this.queueBackgroundUpdate(e),null):(t.accessCount++,t.lastAccessed=Date.now(),this.stats.totalHits++,this.updateHitRate(),h.endMeasure(`cache-get-${e}`),this.deserializeData(t.data)):(this.stats.totalMisses++,this.updateHitRate(),h.endMeasure(`cache-get-${e}`,!1),null)}has(e){const t=this.cache.get(e);return void 0!==t&&!this.isExpired(t)}delete(e){const t=this.cache.get(e);return!!t&&(this.cache.delete(e),this.updateStats("delete",t.size),!0)}clearByTags(e){let t=0;for(const[s,a]of this.cache.entries())a.tags.some(t=>e.includes(t))&&(this.cache.delete(s),this.updateStats("delete",a.size),t++);return t}clear(){this.cache.clear(),this.stats={...this.stats,totalSize:0,entryCount:0}}getStats(){return{...this.stats}}async prefetch(e,t,s={}){try{const a=await t();return this.set(e,a,{priority:"high",...s}),a}catch(a){throw a}}async getOrFetch(e,t,s={}){const{staleWhileRevalidate:a=!1,...r}=s,i=this.get(e);if(null!==i)return a&&this.queueBackgroundUpdate(e,t,r),i;try{const s=await t();return this.set(e,s,r),s}catch(n){throw n}}serializeData(e,t){return t&&"string"==typeof e?{compressed:!0,data:e}:e}deserializeData(e){return e&&e.compressed?e.data:e}calculateSize(e){return 2*JSON.stringify(e).length}isExpired(e){return Date.now()-e.timestamp>e.ttl}shouldEvict(e){return this.stats.totalSize+e>this.strategy.maxSize||this.stats.entryCount>=this.strategy.maxEntries}evictEntries(e){const t=Array.from(this.cache.entries());t.sort(([,e],[,t])=>{const s={low:1,medium:2,high:3};return e.priority!==t.priority?s[e.priority]-s[t.priority]:Math.abs(e.lastAccessed-t.lastAccessed)>1e3?e.lastAccessed-t.lastAccessed:e.accessCount-t.accessCount});let s=0;for(const[a,r]of t){if(s>=e&&this.stats.entryCount<this.strategy.maxEntries)break;this.cache.delete(a),s+=r.size,this.updateStats("delete",r.size)}}updateStats(e,t){"set"===e?(this.stats.totalSize+=t,this.stats.entryCount++):(this.stats.totalSize-=t,this.stats.entryCount--)}updateHitRate(){this.stats.hitRate=this.stats.totalRequests>0?this.stats.totalHits/this.stats.totalRequests*100:0}startGarbageCollection(){this.gcTimer=setInterval(()=>{this.runGarbageCollection()},this.strategy.gcInterval)}runGarbageCollection(){this.stats.entryCount;const e=Date.now();for(const[t,s]of this.cache.entries())this.isExpired(s)&&(this.cache.delete(t),this.updateStats("delete",s.size));this.stats.gcRuns++,this.stats.lastGC=e,this.stats.entryCount}queueBackgroundUpdate(e,t,s={}){this.backgroundUpdateQueue.has(e)||(this.backgroundUpdateQueue.add(e),setTimeout(async()=>{try{if(t){const a=await t();this.set(e,a,s)}}catch(a){}finally{this.backgroundUpdateQueue.delete(e)}},100))}destroy(){this.gcTimer&&(clearInterval(this.gcTimer),this.gcTimer=null),this.clear()}}const p=new m({maxSize:26214400,maxEntries:500,defaultTTL:3e5});new m({maxSize:104857600,maxEntries:200,defaultTTL:18e5}),new m({maxSize:10485760,maxEntries:300,defaultTTL:12e4}),new m({maxSize:5242880,maxEntries:100,defaultTTL:9e5});const g=p,f=p,y=(e,t={})=>{const s=Object.keys(t).sort().map(e=>`${e}:${t[e]}`).join("|");return s?`${e}:${s}`:e},b=e=>{p.clearByTags(["product"])},w=()=>{p.clearByTags(["category"])},x={neutral:{primary:{50:"#f8fafc",100:"#f1f5f9",500:"#475569",600:"#334155",700:"#1e293b",900:"#020617"},secondary:{50:"#fafaf9",100:"#f5f5f4",500:"#78716c",600:"#57534e",700:"#44403c",900:"#1c1917"}},warm:{primary:{50:"#fef7ed",100:"#fdedd3",500:"#ea580c",600:"#dc2626",700:"#b91c1c",900:"#7c2d12"},secondary:{50:"#fefce8",100:"#fef3c7",500:"#eab308",600:"#ca8a04",700:"#a16207",900:"#713f12"}},cool:{primary:{50:"#eff6ff",100:"#dbeafe",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",900:"#1e3a8a"},secondary:{50:"#f0fdfa",100:"#ccfbf1",500:"#14b8a6",600:"#0d9488",700:"#0f766e",900:"#134e4a"}},vibrant:{primary:{50:"#fdf4ff",100:"#fae8ff",500:"#a855f7",600:"#9333ea",700:"#7c3aed",900:"#581c87"},secondary:{50:"#fef2f2",100:"#fee2e2",500:"#ef4444",600:"#dc2626",700:"#b91c1c",900:"#7f1d1d"}},monochrome:{primary:{50:"#f9fafb",100:"#f3f4f6",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"},secondary:{50:"#f9fafb",100:"#f3f4f6",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"}}},v={compact:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.75rem",lineHeight:"1rem"},sm:{size:"0.875rem",lineHeight:"1.25rem"},base:{size:"1rem",lineHeight:"1.5rem"},lg:{size:"1.125rem",lineHeight:"1.75rem"},xl:{size:"1.25rem",lineHeight:"1.75rem"},"2xl":{size:"1.5rem",lineHeight:"2rem"},"3xl":{size:"1.875rem",lineHeight:"2.25rem"},"4xl":{size:"2.25rem",lineHeight:"2.5rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}},comfortable:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.8125rem",lineHeight:"1.125rem"},sm:{size:"0.9375rem",lineHeight:"1.375rem"},base:{size:"1.0625rem",lineHeight:"1.625rem"},lg:{size:"1.1875rem",lineHeight:"1.875rem"},xl:{size:"1.3125rem",lineHeight:"1.875rem"},"2xl":{size:"1.5625rem",lineHeight:"2.125rem"},"3xl":{size:"1.9375rem",lineHeight:"2.375rem"},"4xl":{size:"2.3125rem",lineHeight:"2.625rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}},spacious:{fontFamily:{sans:["Inter","system-ui","sans-serif"],serif:["Playfair Display","Georgia","serif"],mono:["JetBrains Mono","Menlo","monospace"],display:["Cormorant Garamond","Playfair Display","serif"]},fontSize:{xs:{size:"0.875rem",lineHeight:"1.25rem"},sm:{size:"1rem",lineHeight:"1.5rem"},base:{size:"1.125rem",lineHeight:"1.75rem"},lg:{size:"1.25rem",lineHeight:"2rem"},xl:{size:"1.375rem",lineHeight:"2rem"},"2xl":{size:"1.625rem",lineHeight:"2.25rem"},"3xl":{size:"2rem",lineHeight:"2.5rem"},"4xl":{size:"2.375rem",lineHeight:"2.75rem"}},fontWeight:{light:300,normal:400,medium:500,semibold:600,bold:700}}},S={none:{sm:"0px",default:"0px",md:"0px",lg:"0px",xl:"0px",full:"0px"},small:{sm:"2px",default:"4px",md:"6px",lg:"8px",xl:"12px",full:"9999px"},medium:{sm:"4px",default:"6px",md:"8px",lg:"12px",xl:"16px",full:"9999px"},large:{sm:"6px",default:"8px",md:"12px",lg:"16px",xl:"24px",full:"9999px"},full:{sm:"9999px",default:"9999px",md:"9999px",lg:"9999px",xl:"9999px",full:"9999px"}},k=()=>{const[e,t]=s.useState(()=>"undefined"==typeof window?{mode:"light",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}:function(){try{const e=localStorage.getItem("theme_preferences");if(e)return{mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1,...JSON.parse(e)}}catch(e){}return{mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1}}()),[a,r]=s.useState(()=>"undefined"==typeof window?{prefersDark:!1,prefersReducedMotion:!1,prefersHighContrast:!1}:C()),i=s.useMemo(()=>{const t="light",s=x[e.colorScheme],a=v[e.fontScale],r=S[e.borderRadius],i=function(e){const t=!1;return{primary:e.primary||x.neutral.primary,secondary:e.secondary||x.neutral.secondary,accent:e.primary||x.neutral.primary,neutral:x.neutral.primary,semantic:{success:{50:"#f0fdf4",500:"#22c55e",600:"#16a34a",700:"#15803d"},warning:{50:"#fffbeb",500:"#f59e0b",600:"#d97706",700:"#b45309"},error:{50:"#fef2f2",500:"#ef4444",600:"#dc2626",700:"#b91c1c"},info:{50:"#eff6ff",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8"}},background:{primary:t?"#0f172a":"#ffffff",secondary:t?"#1e293b":"#f8fafc",tertiary:t?"#334155":"#f1f5f9",overlay:t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)"},text:{primary:t?"#f8fafc":"#0f172a",secondary:t?"#cbd5e1":"#475569",tertiary:t?"#94a3b8":"#64748b",inverse:t?"#0f172a":"#f8fafc",disabled:t?"#64748b":"#94a3b8"},border:{subtle:t?"#334155":"#e2e8f0",default:t?"#475569":"#cbd5e1",strong:t?"#64748b":"#94a3b8",interactive:t?"#3b82f6":"#2563eb"}}}(s,0,e.highContrast);return{mode:t,colorScheme:e.colorScheme,colors:i,typography:a,spacing:{scale:"compact"===e.fontScale?.875:"spacious"===e.fontScale?1.125:1,base:16,sizes:E(e.fontScale)},borderRadius:e.borderRadius,animationLevel:e.reducedMotion?"none":e.animationLevel,fontScale:e.fontScale,customProperties:M(i,a,r)}},[e,a]),n=s.useCallback(e=>{t(t=>{const s={...t,...e};return function(e){try{localStorage.setItem("theme_preferences",JSON.stringify(e))}catch(t){}}(s),s})},[]);return s.useEffect(()=>{!function(e){const t=document.documentElement;Object.entries(e.customProperties).forEach(([e,s])=>{t.style.setProperty(e,s)}),t.className=t.className.replace(/theme-\w+/g,""),t.classList.add(`theme-${e.mode}`),t.classList.add(`color-scheme-${e.colorScheme}`),t.classList.add(`font-scale-${e.fontScale}`),t.classList.add(`border-radius-${e.borderRadius}`),t.classList.add(`animation-${e.animationLevel}`),t.style.colorScheme="light"}(i)},[i]),s.useEffect(()=>{const e=[window.matchMedia("(prefers-color-scheme: dark)"),window.matchMedia("(prefers-reduced-motion: reduce)"),window.matchMedia("(prefers-contrast: high)")],t=()=>{r(C())};return e.forEach(e=>e.addEventListener("change",t)),()=>{e.forEach(e=>e.removeEventListener("change",t))}},[]),{preferences:e,themeConfig:i,systemPreferences:a,updatePreferences:n,resetToDefaults:()=>n({mode:"auto",colorScheme:"neutral",fontScale:"comfortable",borderRadius:"medium",animationLevel:"normal",highContrast:!1,reducedMotion:!1})}};function C(){return{prefersDark:window.matchMedia("(prefers-color-scheme: dark)").matches,prefersReducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,prefersHighContrast:window.matchMedia("(prefers-contrast: high)").matches||window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia("(forced-colors: active)").matches}}function E(e){const t=16*("compact"===e?.875:"spacious"===e?1.125:1);return{xs:.25*t+"px",sm:.5*t+"px",md:1*t+"px",lg:1.5*t+"px",xl:2*t+"px","2xl":3*t+"px","3xl":4*t+"px","4xl":6*t+"px"}}function M(e,t,s){const a={};return Object.entries(e.background).forEach(([e,t])=>{a[`--color-background-${e}`]=t}),Object.entries(e.text).forEach(([e,t])=>{a[`--color-text-${e}`]=t}),Object.entries(e.border).forEach(([e,t])=>{a[`--color-border-${e}`]=t}),a["--font-family-sans"]=t.fontFamily.sans.join(", "),a["--font-family-serif"]=t.fontFamily.serif.join(", "),a["--font-family-mono"]=t.fontFamily.mono.join(", "),Object.entries(s).forEach(([e,t])=>{a[`--border-radius-${e}`]=t}),a}const z=({href:e,children:t})=>a.jsx("a",{href:e,className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:rounded-md focus:shadow-lg",onFocus:e=>e.currentTarget.classList.remove("sr-only"),onBlur:e=>e.currentTarget.classList.add("sr-only"),children:t}),R=Object.freeze(Object.defineProperty({__proto__:null,SkipLink:z,initializeAccessibility:()=>{var e;if(!document.querySelector("main")){const t=document.querySelector('#main-content, .main-content, [role="main"]');if(t&&"MAIN"!==t.tagName){const s=document.createElement("main");s.id="main-content",null==(e=t.parentNode)||e.insertBefore(s,t),s.appendChild(t)}}document.addEventListener("keydown",e=>{if("Escape"===e.key){document.querySelectorAll('[role="dialog"][aria-hidden="false"]').forEach(e=>{const t=e.querySelector('[data-close], [aria-label*="close"]');t&&t.click()})}})}},Symbol.toStringTag,{value:"Module"})),P=async()=>{try{const{data:e,error:t}=await r.from("products").select("id").limit(1),{data:s,error:a}=await r.from("categories").select("id").limit(1),{data:i,error:n}=await r.from("profiles").select("id").limit(1);await c.initializeAllBuckets();return!0}catch(e){return!1}};const T=new class{constructor(){t(this,"registration",null),t(this,"updateCheckInterval",null),this.setupUpdateChecking()}async register(){if(!this.isSupported())return null;try{return this.registration=await navigator.serviceWorker.register("/sw.js",{scope:"/"}),this.registration.addEventListener("updatefound",()=>{var e;const t=null==(e=this.registration)?void 0:e.installing;t&&this.handleServiceWorkerUpdate(t)}),navigator.serviceWorker.addEventListener("message",e=>{this.handleServiceWorkerMessage(e)}),this.registration}catch(e){return null}}async unregister(){if(!this.registration)return!1;try{const e=await this.registration.unregister();return this.registration=null,this.updateCheckInterval&&(clearInterval(this.updateCheckInterval),this.updateCheckInterval=null),e}catch(e){return!1}}async update(){if(this.registration)try{await this.registration.update()}catch(e){}}async clearCache(){return this.sendMessage("CLEAR_CACHE")}async getCacheStats(){return(await this.sendMessage("CACHE_STATS")).stats}async prefetchResources(e){return this.sendMessage("PREFETCH_RESOURCES",{urls:e})}isSupported(){return"serviceWorker"in navigator}getRegistration(){return this.registration}async sendMessage(e,t){if(!navigator.serviceWorker.controller)throw new Error("No service worker controller available");return new Promise((s,a)=>{const r=new MessageChannel;r.port1.onmessage=e=>{e.data.error?a(new Error(e.data.error)):s(e.data)},navigator.serviceWorker.controller.postMessage({type:e,payload:t},[r.port2])})}handleServiceWorkerUpdate(e){e.addEventListener("statechange",()=>{"installed"===e.state&&navigator.serviceWorker.controller&&this.showUpdateNotification()})}handleServiceWorkerMessage(e){const{type:t,payload:s}=e.data;switch(t){case"CACHE_UPDATED":case"OFFLINE_READY":break;case"UPDATE_AVAILABLE":this.showUpdateNotification()}}showUpdateNotification(){window.dispatchEvent(new CustomEvent("sw-update-available",{detail:{registration:this.registration}}))}setupUpdateChecking(){this.updateCheckInterval=setInterval(()=>{this.registration&&this.update().catch(console.error)},18e5)}async applyUpdate(){this.registration&&this.registration.waiting&&(this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())}},A=new class{constructor(e){t(this,"sw"),this.sw=e}async prefetchCriticalResources(){const e=["/assets/css/index.css","/assets/js/vendor.js","/assets/js/main.js"];try{await this.sw.prefetchResources(e)}catch(t){}}async prefetchRoute(e){const t=this.getRouteResources(e);try{await this.sw.prefetchResources(t)}catch(s){}}async getCacheHealth(){try{const e=await this.sw.getCacheStats(),t=[];let s=0;return Object.entries(e).forEach(([e,a])=>{s+=a.entryCount||0,a.entryCount>100&&t.push(`${e} cache has many entries (${a.entryCount})`),a.exists||t.push(`${e} cache is not properly initialized`)}),{totalSize:s,cacheStatus:e,recommendations:t}}catch(e){return{totalSize:0,cacheStatus:{},recommendations:["Failed to get cache statistics"]}}}getRouteResources(e){return{"/products":["/api/products","/api/categories"],"/dashboard":["/api/dashboard/analytics","/api/user/profile"],"/checkout":["/api/payment/methods","/api/shipping/options"]}[e]||[]}}(T);"undefined"!=typeof window&&(window.addEventListener("load",()=>{T.register().then(e=>{e&&A.prefetchCriticalResources().catch(console.error)}).catch(console.error)}),window.addEventListener("online",()=>{T.update().catch(console.error)}),window.addEventListener("offline",()=>{}));const L=new class{constructor(){t(this,"preloadQueue",[]),t(this,"isProcessing",!1),t(this,"preloadedItems",new Set)}async preloadProduct(e,t={}){const{priority:s="medium",timeout:a=8e3,force:r=!1}=t,n=`product-${e}`;if(this.preloadedItems.has(n)&&!r)return;if(g.has(n)&&!r)return void this.preloadedItems.add(n);const o=async()=>{try{const t=await Promise.race([i(e),new Promise((e,t)=>setTimeout(()=>t(new Error("Preload timeout")),a))]);t&&(g.set(n,t,3e5),this.preloadedItems.add(n))}catch(t){}};"high"===s?this.preloadQueue.unshift(o):this.preloadQueue.push(o),this.processQueue()}async preloadCategoryProducts(e,t={}){const{priority:s="low",timeout:a=8e3,force:r=!1}=t,i=`category-products-${e}`;if(this.preloadedItems.has(i)&&!r)return;const o=async()=>{try{const t=await Promise.race([n({categoryId:e,limit:12}),new Promise((e,t)=>setTimeout(()=>t(new Error("Preload timeout")),a))]);t&&t.length>0&&(g.set(i,t,18e4),this.preloadedItems.add(i))}catch(t){}};"high"===s?this.preloadQueue.unshift(o):this.preloadQueue.push(o),this.processQueue()}async preloadNextPage(e,t=12,s={}){const{timeout:a=1e4}=s,r=e+t,i=`products-page-${r}-${t}`;if(this.preloadedItems.has(i))return;this.preloadQueue.push(async()=>{try{const e=await Promise.race([n({limit:t,offset:r}),new Promise((e,t)=>setTimeout(()=>t(new Error("Preload timeout")),a))]);e&&e.length>0&&(g.set(i,e,12e4),this.preloadedItems.add(i))}catch(e){}}),this.processQueue()}async preloadEssentials(){this.preloadQueue.unshift(async()=>{try{const e=y("categories");if(!f.has(e)){const t=await o();f.set(e,t)}const t=y("products-featured");if(!g.has(t)){const e=await n({featured:!0,limit:8});g.set(t,e)}}catch(e){}}),this.processQueue()}async processQueue(){if(!this.isProcessing&&0!==this.preloadQueue.length){for(this.isProcessing=!0;this.preloadQueue.length>0;){const t=this.preloadQueue.shift();if(t){try{await t()}catch(e){}await new Promise(e=>setTimeout(e,100))}}this.isProcessing=!1}}clear(){this.preloadQueue=[],this.preloadedItems.clear(),this.isProcessing=!1}getStats(){return{queueLength:this.preloadQueue.length,preloadedItems:this.preloadedItems.size,isProcessing:this.isProcessing}}smartPreload(e){const{currentPage:t,userScrollPosition:s=0,timeOnPage:a=0}=e;a>1e4&&s>.5&&"products"===t&&this.preloadNextPage(0),"home"===t&&a>5e3&&this.preloadEssentials(),null==t||t.startsWith("product-")}};"undefined"!=typeof window&&setTimeout(()=>{L.preloadEssentials()},2e3);const I=async(e,t={format:"csv",includeHeaders:!0})=>{try{let s=r.from(e).select("*");t.dateRange&&(s=s.gte("created_at",t.dateRange.start.toISOString()).lte("created_at",t.dateRange.end.toISOString())),t.filters&&Object.entries(t.filters).forEach(([e,t])=>{null!=t&&""!==t&&(s=s.eq(e,t))});const{data:a,error:i}=await s;if(i)return{success:!1,processed:0,errors:[i.message]};if(!a||0===a.length)return{success:!0,processed:0,errors:[],data:[]};let n;switch(t.format){case"csv":default:n=H(a,t.includeHeaders);break;case"json":n=JSON.stringify(a,null,2);break;case"xlsx":n=a}return j(n,`${e}_export.${t.format}`,t.format),{success:!0,processed:a.length,errors:[],data:a}}catch(s){return{success:!1,processed:0,errors:[s instanceof Error?s.message:"Unknown error occurred"]}}},H=(e,t=!0)=>{if(0===e.length)return"";const s=Object.keys(e[0]),a=[];return t&&a.push(s.join(",")),e.forEach(e=>{const t=s.map(t=>{const s=e[t];return null==s?"":"object"==typeof s?`"${JSON.stringify(s).replace(/"/g,'""')}"`:"string"==typeof s&&(s.includes(",")||s.includes('"')||s.includes("\n"))?`"${s.replace(/"/g,'""')}"`:s.toString()});a.push(t.join(","))}),a.join("\n")},j=(e,t,s)=>{let a;switch(s){case"csv":a=new Blob([e],{type:"text/csv;charset=utf-8;"});break;case"json":a=new Blob([e],{type:"application/json;charset=utf-8;"});break;default:a=new Blob([e],{type:"text/plain;charset=utf-8;"})}const r=document.createElement("a"),i=URL.createObjectURL(a);r.setAttribute("href",i),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)},D=async(e,t)=>{try{const{error:s}=await r.from(e).delete().in("id",t);return s?{success:!1,processed:0,errors:[s.message]}:{success:!0,processed:t.length,errors:[]}}catch(s){return{success:!1,processed:0,errors:[s instanceof Error?s.message:"Unknown error occurred"]}}},O=e=>{const t=[],s=[],a=(e=>{const t=[],s=[];if(!e)return t.push("Email is required"),{isValid:!1,errors:t,warnings:s};/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||t.push("Please enter a valid email address"),e.length>254&&t.push("Email address is too long (maximum 254 characters)");const a=e.split("@")[0];a&&a.length>64&&t.push("Email local part is too long (maximum 64 characters)");const r=e.split("@")[1];r&&(r.length>253&&t.push("Email domain is too long (maximum 253 characters)"),/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(r)||t.push("Email domain format is invalid"));const i={"gmial.com":"gmail.com","gmai.com":"gmail.com","yahooo.com":"yahoo.com","hotmial.com":"hotmail.com","outlok.com":"outlook.com"};return r&&i[r.toLowerCase()]&&s.push(`Did you mean ${i[r.toLowerCase()]}?`),{isValid:0===t.length,errors:t,warnings:s}})(e.email),r=(e=>{const t=[],s=[];return e?(e.length<2&&t.push("Name must be at least 2 characters long"),e.length>100&&t.push("Name is too long (maximum 100 characters)"),/^[a-zA-Z\s\-'\.]+$/.test(e)||t.push("Name can only contain letters, spaces, hyphens, and apostrophes"),e.includes("  ")&&s.push("Name contains multiple consecutive spaces"),(e.startsWith(" ")||e.endsWith(" "))&&s.push("Name has leading or trailing spaces"),{isValid:0===t.length,errors:t,warnings:s}):(t.push("Name is required"),{isValid:!1,errors:t,warnings:s})})(e.name),i=(e=>{const t=[];return e?(["admin","seller","customer"].includes(e.toLowerCase())||t.push("Invalid role. Must be admin, seller, or customer"),{isValid:0===t.length,errors:t}):(t.push("Role is required"),{isValid:!1,errors:t})})(e.role),n=(e=>{const t=[],s=[];if(!e)return{isValid:!0,errors:t,warnings:s};const a=e.replace(/\D/g,"");return a.length<10&&t.push("Phone number must be at least 10 digits"),a.length>15&&t.push("Phone number is too long (maximum 15 digits)"),/^[\+]?[1-9][\d]{0,15}$/.test(a)||t.push("Please enter a valid phone number"),{isValid:0===t.length,errors:t,warnings:s}})(e.phone||""),o=(e=>{const t=[],s=[];if(!e)return{isValid:!0,errors:t,warnings:s};const a=new Date(e),r=new Date;if(isNaN(a.getTime()))return t.push("Please enter a valid date"),{isValid:!1,errors:t,warnings:s};a>r&&t.push("Date of birth cannot be in the future");const i=new Date;i.setFullYear(i.getFullYear()-120),a<i&&t.push("Date of birth seems unrealistic (over 120 years ago)");const n=new Date;return n.setFullYear(n.getFullYear()-13),a>n&&s.push("User appears to be under 13 years old. Additional parental consent may be required."),{isValid:0===t.length,errors:t,warnings:s}})(e.dateOfBirth||"");return t.push(...a.errors),t.push(...r.errors),t.push(...i.errors),t.push(...n.errors),t.push(...o.errors),s.push(...a.warnings||[]),s.push(...r.warnings||[]),s.push(...n.warnings||[]),s.push(...o.warnings||[]),{isValid:0===t.length,errors:t,warnings:s}},N=e=>e?e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim():"",$=()=>{const[e,t]=s.useState(()=>"undefined"==typeof window?{reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!1,focusVisible:!1,colorBlindness:"none"}:U());s.useEffect(()=>{const e=()=>{t(U())},s=[window.matchMedia("(prefers-reduced-motion: reduce)"),window.matchMedia("(prefers-contrast: high)"),window.matchMedia("(prefers-color-scheme: dark)")];return s.forEach(t=>{t.addEventListener("change",e)}),window.addEventListener("storage",e),()=>{s.forEach(t=>{t.removeEventListener("change",e)}),window.removeEventListener("storage",e)}},[]);return{preferences:e,updatePreference:s.useCallback((e,s)=>{t(t=>({...t,[e]:s}));try{const t=JSON.parse(localStorage.getItem("accessibility_preferences")||"{}");localStorage.setItem("accessibility_preferences",JSON.stringify({...t,[e]:s}))}catch(a){}},[])}};function U(){const e={reducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,highContrast:window.matchMedia("(prefers-contrast: high)").matches,largeText:!1,screenReader:!1,keyboardNavigation:!1,focusVisible:!1,colorBlindness:"none"};e.screenReader=!!(window.navigator.userAgent.match(/NVDA|JAWS|VoiceOver|ORCA|Dragon/i)||window.speechSynthesis||window.speechSynthesis);try{const t=JSON.parse(localStorage.getItem("accessibility_preferences")||"{}");Object.assign(e,t)}catch(t){}return e}const q=()=>{const e=s.useRef(null);s.useEffect(()=>{if(!e.current){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.style.cssText="\n        position: absolute !important;\n        width: 1px !important;\n        height: 1px !important;\n        padding: 0 !important;\n        margin: -1px !important;\n        overflow: hidden !important;\n        clip: rect(0, 0, 0, 0) !important;\n        white-space: nowrap !important;\n        border: 0 !important;\n      ",document.body.appendChild(t),e.current=t}return()=>{e.current&&document.body.contains(e.current)&&document.body.removeChild(e.current)}},[]);return{announce:s.useCallback((t,s="polite")=>{e.current&&(e.current.setAttribute("aria-live",s),e.current.textContent="",setTimeout(()=>{e.current&&(e.current.textContent=t)},100))},[])}},W={checkAltText:(e=document.body)=>{const t=e.querySelectorAll("img");return Array.from(t).filter(e=>!e.alt&&!e.getAttribute("aria-label")&&!e.getAttribute("aria-labelledby")&&"presentation"!==e.getAttribute("role"))},checkFormLabels:(e=document.body)=>{const t=e.querySelectorAll("input, select, textarea");return Array.from(t).filter(e=>{var t;const s=e;return!(null==(t=s.labels)?void 0:t.length)&&!s.getAttribute("aria-label")&&!s.getAttribute("aria-labelledby")&&"hidden"!==s.type})},checkHeadingHierarchy:(e=document.body)=>{const t=Array.from(e.querySelectorAll("h1, h2, h3, h4, h5, h6")),s=[];let a=0;return t.forEach(e=>{const t=parseInt(e.tagName.charAt(1));t>a+1&&s.push({element:e,issue:`Heading level ${t} follows level ${a}, skipping levels`}),a=t}),s},generateReport:(e=document.body)=>({missingAltText:W.checkAltText(e),missingFormLabels:W.checkFormLabels(e),headingIssues:W.checkHeadingHierarchy(e),timestamp:(new Date).toISOString()})},V={xs:320,sm:640,md:768,lg:1024,xl:1280,"2xl":1536,"3xl":1920,"4xl":2560},B={xs:"100%",sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px","3xl":"1920px","4xl":"2560px"},Q={xs:4,sm:8,md:12,lg:12,xl:12,"2xl":12,"3xl":16,"4xl":20},F={xs:{base:4,scale:1},sm:{base:4,scale:1.2},md:{base:6,scale:1.4},lg:{base:8,scale:1.6},xl:{base:10,scale:1.8},"2xl":{base:12,scale:2},"3xl":{base:16,scale:2.2},"4xl":{base:20,scale:2.4}},G={xs:{base:14,scale:1},sm:{base:14,scale:1.1},md:{base:16,scale:1.2},lg:{base:16,scale:1.3},xl:{base:18,scale:1.4},"2xl":{base:18,scale:1.5},"3xl":{base:20,scale:1.6},"4xl":{base:22,scale:1.7}},_=()=>{const[e,t]=s.useState(()=>"undefined"==typeof window?{width:1024,height:768,breakpoint:"lg",deviceType:"desktop",orientation:"landscape",pixelRatio:1,isTouch:!1,isPWA:!1,isRetina:!1,aspectRatio:1.33,safeAreaInsets:{top:0,right:0,bottom:0,left:0}}:J()),a=s.useCallback(()=>{t(J())},[]);s.useEffect(()=>{a();const e=function(e,t){let s;return(...a)=>{clearTimeout(s),s=setTimeout(()=>e.apply(null,a),t)}}(a,150);window.addEventListener("resize",e);const t=()=>{setTimeout(a,100)};window.addEventListener("orientationchange",t);const s=()=>{a()};return window.addEventListener("beforeinstallprompt",s),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",t),window.removeEventListener("beforeinstallprompt",s)}},[a]);const r=s.useCallback(t=>e.breakpoint===t,[e.breakpoint]),i=s.useCallback(t=>e.width>=V[t],[e.width]),n=s.useCallback(t=>e.width<V[t],[e.width]),o=s.useCallback(t=>{const s=Object.keys(V).sort((e,t)=>V[e]-V[t]);for(let a=s.length-1;a>=0;a--){const r=s[a];if(e.width>=V[r]&&void 0!==t[r])return t[r]}for(const e of s)if(void 0!==t[e])return t[e]},[e.width]),c=s.useCallback(()=>B[e.breakpoint],[e.breakpoint]),l=s.useCallback(()=>Q[e.breakpoint],[e.breakpoint]),d=s.useCallback((t=1)=>{const s=F[e.breakpoint];return s.base*s.scale*t},[e.breakpoint]),u=s.useCallback((t=1)=>{const s=G[e.breakpoint];return s.base*s.scale*t},[e.breakpoint]);return{...e,isBreakpoint:r,isBreakpointUp:i,isBreakpointDown:n,getResponsiveValue:o,getContainerSize:c,getGridColumns:l,getSpacing:d,getTypographySize:u,isMobile:"mobile"===e.deviceType,isTablet:"tablet"===e.deviceType,isDesktop:"desktop"===e.deviceType,isPortrait:"portrait"===e.orientation,isLandscape:"landscape"===e.orientation}};function J(){const e=window.innerWidth,t=window.innerHeight,s=window.devicePixelRatio||1,a=e/t;let r="xs";const i=Object.entries(V);for(const[o,c]of i.reverse())if(e>=c){r=o;break}let n="desktop";e<V.md?n="mobile":e<V.lg?n="tablet":e>=V["3xl"]&&(n="tv");return{width:e,height:t,breakpoint:r,deviceType:n,orientation:e>t?"landscape":"portrait",pixelRatio:s,isTouch:"ontouchstart"in window||navigator.maxTouchPoints>0,isPWA:window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches||!0===window.navigator.standalone,isRetina:s>1,aspectRatio:a,safeAreaInsets:{top:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-top")||"0"),right:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-right")||"0"),bottom:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-bottom")||"0"),left:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-left")||"0")}}}const Y=e=>{const{getGridColumns:t,getResponsiveValue:a}=_(),r=s.useMemo(()=>e&&a(e)||t(),[e,a,t]),i=s.useCallback(e=>"number"==typeof e?Math.min(e,r):Math.min(a(e)||1,r),[r,a]),n=s.useCallback(e=>i(e)/r*100+"%",[i,r]);return{gridColumns:r,getColumnSpan:i,getColumnWidth:n}};export{z as S,q as a,_ as b,W as c,D as d,I as e,d as f,Y as g,l as h,P as i,y as j,f as k,g as l,w as m,b as n,k as o,h as p,L as q,R as r,N as s,$ as u,O as v};
//# sourceMappingURL=utils-DOabGuGE.js.map
